# üìä Adaptive Score Threshold & Signal Strength ‚Äî –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–í–µ—Ä—Å–∏—è: BinanceBot v1.6.2-dev  
–¶–µ–ª—å: –£–≥–ª—É–±–ª—ë–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ª–æ–≥–∏–∫–∏ `min_required` –∏ `score` –≤ REAL_RUN + —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

---

## ‚úÖ –¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ `min_required`

–§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑:

```python
def get_adaptive_min_score(trade_count, winrate):
    base = 3.0
    if trade_count < 20:
        return base + 0.5
    return base - (winrate - 0.5) * 0.5
```

- üîπ –ï—Å–ª–∏ –º–∞–ª–æ —Å–¥–µ–ª–æ–∫ (trade_count < 20): –ø–æ—Ä–æ–≥ = 3.5
- üîπ –ò–Ω–∞—á–µ: –∞–¥–∞–ø—Ç–∞—Ü–∏—è –æ—Ç winrate:
    - winrate = 60% ‚Üí min_required = 2.95
    - winrate = 30% ‚Üí min_required = 3.1
    - –î–∏–∞–ø–∞–∑–æ–Ω: ~2.75 ‚Äì 3.25

---

## ‚úÖ –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Ä–æ–≥ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ `tp_performance.csv`:

```python
def get_trade_stats():
    df = pd.read_csv(EXPORT_PATH)
    total = len(df[df["Result"].isin(["TP1", "TP2", "SL"])])
    win = len(df[df["Result"].isin(["TP1", "TP2"])])
    return total, win / total
```

---

## ‚úÖ –¢–µ–∫—É—â–∏–π —Ä–∞—Å—á—ë—Ç `score`

–†–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ `calculate_score(df, symbol)` ‚Äî –º–æ–¥–µ–ª—å:

- üîπ RSI: +1 –µ—Å–ª–∏ –≤ –∑–æ–Ω–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, <30 –∏–ª–∏ >70)
- üîπ MACD –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç RSI
- üîπ MACD –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç EMA
- üîπ HTF —Ç—Ä–µ–Ω–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω
- üîπ ADX > 25 ‚Üí +1

–ú–∞–∫—Å–∏–º—É–º: `score = 5.0`  
–í –ª–æ–≥–∞—Ö —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è `1.2 ‚Äì 1.5`

---

## üìå –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏

- üëç –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å
- üëç –ù–∞–¥—ë–∂–Ω–∞—è –∑–∞—â–∏—Ç–∞ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ: min_required = 3.5
- üëç –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ—Ä–æ–≥–∞ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º winrate

---

## ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è

### 1. üîß –°–ª–∞–±–æ–µ –≤–ª–∏—è–Ω–∏–µ winrate

- –¢–µ–∫—É—â–∞—è —Ñ–æ—Ä–º—É–ª–∞ –∏–∑–º–µ–Ω—è–µ—Ç –ø–æ—Ä–æ–≥ –ª–∏—à—å –Ω–∞ ¬±0.25
- üîÑ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø–æ–≤—ã—Å–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–ª–∏—è–Ω–∏—è winrate:

```python
return base - (winrate - 0.5) * 1.0  # –≤–º–µ—Å—Ç–æ * 0.5
```

---

### 2. üîß –ñ—ë—Å—Ç–∫–∏–π —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π base = 3.0

- –ú–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–º –ø—Ä–∏ —Å–ø–æ–∫–æ–π–Ω–æ–º —Ä—ã–Ω–∫–µ
- üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –≤—ã–Ω–µ—Å—Ç–∏ `BASE_SCORE_THRESHOLD` –≤ `config.py`:

```python
BASE_SCORE_THRESHOLD = 3.0  # –∏–ª–∏ 2.8
```

---

### 3. üîß –ù–µ—Ç —É—á—ë—Ç–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

- –†—ã–Ω–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—è–ª—ã–º, –Ω–æ –ª–æ–≥–∏–∫–∞ –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è
- üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å `atr_factor` –∫–∞–∫ –º–Ω–æ–∂–∏—Ç–µ–ª—å:

```python
atr_factor = df["atr"].iloc[-1] / df["close"].iloc[-1]
min_required = get_adaptive_min_score(trade_count, winrate, atr_factor)
```

```python
def get_adaptive_min_score(trade_count, winrate, atr_factor=1.0):
    base = BASE_SCORE_THRESHOLD * atr_factor
    ...
```

---

### 4. üîç –ü–æ—á–µ–º—É score –Ω–∏–∑–∫–∏–π?

- –ù–µ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:
    - RSI –Ω–µ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ
    - MACD –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç EMA
    - HTF –æ—Ç–∫–ª—é—á—ë–Ω
    - ADX —Å–ª–∞–±—ã–π
- üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
    - –û—Å–ª–∞–±–∏—Ç—å RSI –∑–æ–Ω—ã –¥–æ 35/65
    - –í–≤–µ—Å—Ç–∏ Volume –∫–∞–∫ —Ñ–∞–∫—Ç–æ—Ä
    - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ—Ä–º–∏—Ä–æ–≤–∫—É –≤–µ—Å–æ–≤ –∏ –∏—Ö –≤–∫–ª–∞–¥

---

## üß† –ò—Ç–æ–≥

| –ê—Å–ø–µ–∫—Ç                   | –°—Ç–∞—Ç—É—Å    | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------------------------|-----------|-------------|
| trade_count/winrate      | ‚úÖ        | –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω—É–∂–Ω–æ —É—Å–∏–ª–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ |
| DRY_RUN –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è      | ‚úÖ        | –ú—è–≥–∫–∏–π –ø–æ—Ä–æ–≥ —á–µ—Ä–µ–∑ `* 0.3` |
| Base Threshold           | ‚ö†Ô∏è        | –°–¥–µ–ª–∞—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º |
| Volatility –∞–¥–∞–ø—Ç–∞—Ü–∏—è     | ‚ùå        | –ü–æ–∫–∞ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è |
| –ü–æ–≤–µ–¥–µ–Ω–∏–µ score          | ‚ö†Ô∏è        | –ß–∞—Å—Ç–æ –Ω–∏–∑–∫–∏–π, –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Å–ª–æ–≤–∏—è |

---

## ‚úÖ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –í—ã–Ω–µ—Å—Ç–∏ `BASE_SCORE_THRESHOLD` –≤ `config.py`
2. –î–æ–±–∞–≤–∏—Ç—å `atr_factor` –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç –≤ get_adaptive_min_score
3. –ü–æ–≤—ã—Å–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ winrate
4. –û—Å–ª–∞–±–∏—Ç—å —É—Å–ª–æ–≤–∏—è –≤ calculate_score (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
---

## üß© –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞ –ø–æ –¥–µ–ø–æ–∑–∏—Ç—É

### üîÑ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞

```python
from utils_core import get_cached_balance

def get_adaptive_min_score(trade_count, winrate):
    balance = get_cached_balance()
    
    if balance < 50:
        base = 3.0
    elif 50 <= balance < 100:
        base = 2.75
    elif balance < 1000:
        base = 2.5
    else:
        base = 2.0

    if trade_count < 20:
        return base + 0.5

    adjusted_threshold = base - (winrate - 0.5) * 1.0
    return max(adjusted_threshold, base - 0.5)
```

### üìä –ü–æ–≤–µ–¥–µ–Ω–∏–µ

| –ë–∞–ª–∞–Ω—Å   | –ü–æ—Ä–æ–≥ (–µ—Å–ª–∏ < 20 —Å–¥–µ–ª–æ–∫) | –ü–æ—Ä–æ–≥ (trade_count ‚â• 20, winrate = 60%) |
|----------|---------------------------|------------------------------------------|
| < $50    | 3.5                       | 2.5 ‚Äì 3.0                                |
| $50‚Äì100  | 3.25                      | 2.25 ‚Äì 2.75                              |
| $100‚Äì1000| 3.0                       | 2.0 ‚Äì 2.5                                |
| ‚â• $1000  | 2.5                       | 1.5 ‚Äì 2.0                                |

---

## üß† –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ

- üí° –ü–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∏—Å–∫–∞–º–∏
- üí° –ü–æ–≤—ã—à–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –∫—Ä—É–ø–Ω–æ–º –¥–µ–ø–æ–∑–∏—Ç–µ
- üí° –ó–∞—â–∏—â–∞–µ—Ç –º–µ–ª–∫–∏–π –¥–µ–ø–æ–∑–∏—Ç –æ—Ç —Å–ª–∞–±—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- üí° –î–æ–±–∞–≤–ª—è–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±–µ–∑ –∏–∑–±—ã—Ç–æ—á–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

---

## üõ† Roadmap –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### ü•á –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ

- [x] –í—Å—Ç–∞–≤–∏—Ç—å —É–ª—É—á—à–µ–Ω–Ω—ã–π `get_adaptive_min_score(...)` –≤ `score_evaluator.py`
- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ `strategy.py` –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ –≤—ã–∑–æ–≤)

### ü•à –≠—Ç–∞–ø 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] DRY_RUN:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–æ–≥–∞ –ø—Ä–∏ –±–∞–ª–∞–Ω—Å–µ 40, 80, 500, 1500 USDC
  - –õ–æ–≥ `Final Score: {score}/5 (Required: {min_required})`

- [ ] REAL_RUN:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–¥–µ–ª–æ–∫ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –±–∞–ª–∞–Ω—Å–∞—Ö
  - –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ `tp_performance.csv`

### ü•â –≠—Ç–∞–ø 3: –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞

- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
  - –û—Å–ª–∞–±–∏—Ç—å/—É—Å–∏–ª–∏—Ç—å base
  - –ò–∑–º–µ–Ω–∏—Ç—å winrate-–º–Ω–æ–∂–∏—Ç–µ–ª—å
  - –î–æ–±–∞–≤–∏—Ç—å `BASE_SCORE_THRESHOLDS` –≤ `config.py`

### üß™ –≠—Ç–∞–ø 4 (–ø–æ–∑–∂–µ): –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (ATR)

- [ ] –î–æ–±–∞–≤–∏—Ç—å `atr_factor` –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä
- [ ] –ü—Ä–∏–º–µ–Ω—è—Ç—å –∫–∞–∫ –º–Ω–æ–∂–∏—Ç–µ–ª—å base
- [ ] –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏