# –ö–∞–∫ —Å–æ–≤–º–µ—Å—Ç–∏—Ç—å: fees + —Å–∫–∞–ª—å–ø–µ—Ä + multi‚ÄëTP/HWM + –º–∏–∫—Ä–æ–≥—Ä–∏–¥

Starting ideas:
üí° –ò–¥–µ–∏, –∫–∞–∫ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å —ç—Ç–æ –≤ ¬´—Å—É–ø–µ—Ä-—ç—Ñ—Ñ–µ–∫—Ç¬ª —Å–∫–∞–ª—å–ø–µ—Ä–∞

1. –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø–æ ultra-short –∏–º–ø—É–ª—å—Å–∞–º

–î–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å –∞–Ω–∞–ª–∏–∑–∞ 1-—Å–µ–∫ –∏ 5-—Å–µ–∫ —Å–≤–µ—á–µ–π —á–µ—Ä–µ–∑ WebSocket.

–í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –≤ —Å—Ç–æ—Ä–æ–Ω—É –∏–º–ø—É–ª—å—Å–∞, –µ—Å–ª–∏:

–¶–µ–Ω–∞ –¥–∞–ª–∞ >0.15‚Äì0.25% –¥–≤–∏–∂–µ–Ω–∏—è –∑–∞ ‚â§3 —Å–µ–∫

–û–±—ä—ë–º –≤ —Å—Ç–∞–∫–∞–Ω–µ –∏–ª–∏ –ø–æ —Ç—Ä–µ–π–¥–∞–º —Ä–µ–∑–∫–æ –≤—ã—Ä–æ—Å

–≠—Ç–æ —Å–∏–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç —à–∞–Ω—Å, —á—Ç–æ –ø–µ—Ä–≤—ã–µ TP –±—É–¥—É—Ç –∑–∞—Ü–µ–ø–ª–µ–Ω—ã.

2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP –∏ SL

–í–º–µ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö TP_LEVELS –≤ .env ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏:

–ï—Å–ª–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –≤—ã—Å–æ–∫–∞—è (ATR 1m > X) ‚Üí TP —É—Ä–æ–≤–Ω–∏ —à–∏—Ä–µ, SL –¥–∞–ª—å—à–µ

–ï—Å–ª–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è ‚Üí TP —É—Ä–æ–≤–Ω–∏ —É–∂–µ, SL –±–ª–∏–∂–µ

–≠—Ç–æ —É–∂–µ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä—è–º–æ –≤ place_protective_orders() ‚Äî –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º –æ—Ä–¥–µ—Ä–æ–≤.

3. Instant break-even

–ü–æ—Å–ª–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ TP ‚Äî —Å—Ä–∞–∑—É –ø–æ–¥–Ω–∏–º–∞—Ç—å SL –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—Ö–æ–¥–∞ (–∏–ª–∏ —á—É—Ç—å –≤—ã—à–µ).

–≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ handle_order_update():

TP1 fill ‚Üí cancel SL ‚Üí —Å—Ç–∞–≤–∏–º –Ω–æ–≤—ã–π SL —á—É—Ç—å –≤ –ø–ª—é—Å ‚Üí trailing –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ TP.

–≠—Ç–æ —Ä–µ–∑–∫–æ –ø–æ–≤—ã—à–∞–µ—Ç winrate, —Ç–∞–∫ –∫–∞–∫ ¬´–º–∏–Ω—É—Å–Ω—ã–µ¬ª —Å–¥–µ–ª–∫–∏ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –Ω—É–ª–µ–≤—ã–µ/–º–∏–Ω–∏–º–∞–ª—å–Ω–æ –ø–ª—é—Å–æ–≤—ã–µ.

4. –§–∏–ª—å—Ç—Ä ‚Äú—á–∏—Å—Ç–æ—Ç—ã‚Äù —Å—Ç–∞–∫–∞–Ω–∞

–ù–µ –≤—Ö–æ–¥–∏—Ç—å, –µ—Å–ª–∏:

Spread > 0.05%

–í —Å—Ç–∞–∫–∞–Ω–µ –≤–∏–¥–µ–Ω –∫—Ä—É–ø–Ω—ã–π –∞–π—Å–±–µ—Ä–≥ —Å –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã (–º–æ–∂–Ω–æ –ª–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ depthUpdate)

–≠—Ç–æ —É–±–µ—Ä—ë—Ç –º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤.

5. –ú–∏–∫—Ä–æ-–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥

–ï—Å–ª–∏ —Ü–µ–Ω–∞ –∏–¥—ë—Ç –≤ –Ω–∞—à—É —Å—Ç–æ—Ä–æ–Ω—É –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ ‚Üí –¥–æ–∫—É–ø–∞–µ–º –Ω–µ–±–æ–ª—å—à–∏–º –æ–±—ä—ë–º–æ–º –∏ —Å–¥–≤–∏–≥–∞–µ–º TP —É—Ä–æ–≤–Ω–∏.

–í –∫–æ–¥–µ —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã –≤ WS –∏ –ø—Ä–æ–≤–µ—Ä—è—è, —á—Ç–æ SL –≤—Å—ë –µ—â—ë –¥–∞–ª–µ–∫–æ.

6. –ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞ —Ä–∞–±–æ—Ç—ã

–î–ª—è —Ç–µ—Å—Ç–æ–≤ –º–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä SCALPING_MODE=true, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —á–∞—Å—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 8‚Äì11 UTC –∏ 13‚Äì16 UTC).

–í –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è ‚Äî –ø—Ä–æ—Å—Ç–æ –∂–¥—ë—Ç —Å–∏–≥–Ω–∞–ª.

üîπ –ü–æ—á–µ–º—É —ç—Ç–æ –±—É–¥–µ—Ç –ø—Ä–∏–±—ã–ª—å–Ω–æ
–¢—ã —É–∂–µ —Å–¥–µ–ª–∞–ª –±–∞–∑—É: –±–æ—Ç —É–º–µ–µ—Ç –≥—Ä–∞–º–æ—Ç–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã—Ö–æ–¥–∞–º–∏, –¥–≤–∏–≥–∞—Ç—å SL –≤ –ø—Ä–∏–±—ã–ª—å –∏ –∏–∑–±–µ–≥–∞—Ç—å –æ—à–∏–±–æ–∫ —Å minQty.
–ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —É–º–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –≤—Ö–æ–¥–∞ + break-even –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL, —Ç–æ –≤–∏–Ω—Ä–µ–π—Ç –∏ PnL –º–æ–∂–Ω–æ —Å–∏–ª—å–Ω–æ –ø–æ–¥–Ω—è—Ç—å.
============================================================================

1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (1 –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä ‚Üí 4 –º–æ–¥—É–ª—è)

SignalEngine: –∏–º–ø—É–ª—å—Å/ATR/—Å–ø—Ä–µ–¥/–∞–π—Å–±–µ—Ä–≥/–æ–∫–Ω–∞ (–¥–∞—ë—Ç —Å–∏–≥–Ω–∞–ª—ã: go_long, go_short, flat_mode_ok).

GridManager: –º–∏–∫—Ä–æ–≥—Ä–∏–¥ —Ç–æ–ª—å–∫–æ maker. –°—Ç–∞–≤–∏—Ç/—Å–Ω–∏–º–∞–µ—Ç –ª–∏–º–∏—Ç–∫–∏, —Å–ª–µ–¥–∏—Ç –∑–∞ breakout.

OrderManager: —Ç–æ, —á—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–ª–∏ ‚Äî SL + multi‚ÄëTP + trailing (HWM), BE –ø–æ—Å–ª–µ TP1 (–µ—Å–ª–∏ –≤–∫–ª—é—á–∏—à—å).

Fees: —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–º–∏—Å—Å–∏–π –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫ —Ü–µ–Ω (–≤–ª–∏—è–µ—Ç –Ω–∞ TP/SL/BE –∏ –Ω–∞ PnL-–ª–æ–≥–∏).

–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Ä–µ—à–∞–µ—Ç —Ä–µ–∂–∏–º:

–µ—Å–ª–∏ impulse ‚Üí —Å–∫–∞–ª—å–ø–µ—Ä (Grid –≤—ã–∫–ª—é—á–∏—Ç—å, –∑–∞—â–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ –≤–∫–ª—é—á–∏—Ç—å),

–µ—Å–ª–∏ flat (–Ω–∏–∑–∫–∏–π ATR, —á–∏—Å—Ç—ã–π —Å–ø—Ä–µ–¥, –Ω–µ—Ç –∞–π—Å–±–µ—Ä–≥–∞) ‚Üí Grid –≤–∫–ª—é—á–∏—Ç—å, —Å–∫–∞–ª—å–ø–µ—Ä –∂–¥—ë—Ç —Å–∏–≥–Ω–∞–ª.

2. –ü—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è (—á—Ç–æ–±—ã –Ω–µ –¥—Ä–∞—Ç—å—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º)

–í—Ö–æ–¥ –≤ —Å–∫–∞–ª—å–ø–∏–Ω–≥:

GridManager.cancel_grid(symbol) ‚Üí –¥–æ–∂–¥–∞—Ç—å—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–º–µ–Ω—ã –ª–∏–º–∏—Ç–æ–∫ (–ø–æ WS –∏–ª–∏ REST).

–û—Ç–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é (–æ–±—ã—á–Ω–æ market/taker).

–°—Ä–∞–∑—É place_protective_orders() (SL + TP + pending trailing).

–í–æ–∑–≤—Ä–∞—Ç –≤–æ —Ñ–ª—ç—Ç (Grid):

–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ—Ç (–∏–ª–∏ –æ—Å—Ç–∞—Ç–æ–∫ < –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞) –∏ SignalEngine –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç flat.

GridManager.place_grid() ‚áí –ª–∏–º–∏—Ç–∫–∏ —Å postOnly –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ã–º –ª–∏–º–∏—Ç–æ–º.

–í–∞–∂–Ω–æ–µ: Grid –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–π —Å–∫–∞–ª—å–ø‚Äë–ø–æ–∑–∏—Ü–∏–∏. –≠—Ç–æ —Å–Ω–∏–º–µ—Ç 90% –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.

3. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å:

# Fees

ENABLE_FEE_ADJUSTMENT=true
PAY_FEES_WITH_BNB=true # –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —Å–∫–∏–¥–∫—É
TAKER_FEE_PERCENT=0.04 # —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –ø–æ–¥ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
MAKER_FEE_PERCENT=0.00 # –¥–ª—è –º–∏–∫—Ä–æ–≥—Ä–∏–¥–∞ –≤–∞–∂–Ω–æ!

# Scalper

SCALPING_MODE=true

# Multi-TP/Trailing

ENABLE_MULTIPLE_TP=true
ENABLE_TRAILING_STOP=true

# Grid

Preliminary grid discussion:
–ö–æ–≥–¥–∞ –≥—Ä–∏–¥ —É–º–µ—Å—Ç–µ–Ω

–§–ª—ç—Ç / –ø–∏–ª–µ–Ω–∏–µ: —Ü–µ–Ω–∞ –∫–æ–ª–µ–±–ª–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —É–∑–∫–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ ‚Üí –≥—Ä–∏–¥ ¬´—Å–æ–±–∏—Ä–∞–µ—Ç —Å–ø—Ä–µ–¥¬ª –º–µ–π–∫–µ—Ä‚Äë–æ—Ä–¥–µ—Ä–æ–º (–Ω–∞ USDC‚Äë–ø–µ—Ä–ø–∞—Ö maker=0%).

–ù–∏–∑–∫–∞—è –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (ATR1m –Ω–∏–∑–∫–∏–π): –∏–º–ø—É–ª—å—Å‚Äë—Å–∫–∞–ª—å–ø–µ—Ä –º–∞–ª–æ —Ç–æ—Ä–≥—É–µ—Ç ‚Äî –≥—Ä–∏–¥ –¥–∞—ë—Ç –¥–æ—Ö–æ–¥ –Ω–∞ –º–∏–∫—Ä–æ–∫–æ–ª–µ–±–∞–Ω–∏—è—Ö.

–ì–ª—É–±–æ–∫–∏–π —Å—Ç–∞–∫–∞–Ω / —É–∑–∫–∏–π —Å–ø—Ä–µ–¥: –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è –ª–∏–º–∏—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –±–µ–∑ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è.

–ö–æ–≥–¥–∞ –≥—Ä–∏–¥ –≤—Ä–µ–¥–µ–Ω

–†–µ–∑–∫–∏–π —Ç—Ä–µ–Ω–¥ / –∏–º–ø—É–ª—å—Å ‚Üí –≥—Ä–∏–¥ ¬´–ª–æ–≤–∏—Ç –ø–∞–¥–∞—é—â–∏–µ –Ω–æ–∂–∏¬ª –∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø—Ä–æ—Ç–∏–≤ –¥–≤–∏–∂–µ–Ω–∏—è.

–í—ã—Å–æ–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏ taker ‚Üí –µ—Å–ª–∏ —É–ª–µ—Ç–∞–µ—Ç –≤ –∏–º–ø—É–ª—å—Å –∏ –≥—Ä–∏–¥ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∑–∞–∫—Ä—ã–≤–∞—Ç—å –º–∞—Ä–∫–µ—Ç–æ–º, –∫–æ–º–∏—Å—Å–∏—è —Å—ä–µ–¥–∞–µ—Ç –ø—Ä–æ—Ñ–∏—Ç.

minQty/NOTIONAL –Ω–∞ BTC/ETH ‚Äî —Å–ª–∏—à–∫–æ–º –º–µ–ª–∫–∞—è —Å–µ—Ç–∫–∞ –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—Å—è.

–î–∏–∑–∞–π–Ω: ¬´Hybrid Micro‚ÄëGrid¬ª

–†–µ–∂–∏–º—ã:

SCALPING_MODE (—É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å) ‚Äî —Å–∏–≥–Ω–∞–ª‚Äë–≤—Ö–æ–¥ –ø–æ –∏–º–ø—É–ª—å—Å—É.

GRID_MODE ‚Äî –≤–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞:

ATR1m ‚â§ ATR1M_LOW_THRESH,

—Å–ø—Ä–µ–¥ ‚â§ SPREAD_MAX_PCT,

–Ω–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –∞–π—Å–±–µ—Ä–≥–∞,

–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø–æ —ç—Ç–æ–º—É —Å–∏–º–≤–æ–ª—É (–∏–ª–∏ –ø–æ–∑–∏—Ü–∏—è –º–∞–ª–∞).

–ì—Ä–∏–¥ ‚Äî —Ç–æ–ª—å–∫–æ –º–µ–π–∫–µ—Ä: –ª–∏–º–∏—Ç–∫–∏ —Å postOnly/GTX, —á—Ç–æ–±—ã –ª–æ–≤–∏—Ç—å —Ä–µ–±–µ–π—Ç—ã/0% –∏ –∏–∑–±–µ–≥–∞—Ç—å taker‚Äë–∫–æ–º–∏—Å—Å–∏–∏.

–ú–∏–∫—Ä–æ‚Äë—Ä–∞–∑–º–µ—Ä: –Ω–µ–±–æ–ª—å—à–æ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å, —Å—Ç—Ä–æ–≥–∏–π GRID_MAX_INVENTORY_USD –∏ ¬´–∫–∏–ª–æ–≤—ã—á¬ª –ø—Ä–∏ –ø—Ä–æ–±–æ–µ.

–ö–∏–ª‚Äë—Å–≤–∏—Ç—á: –ø—Ä–∏ –∏–º–ø—É–ª—å—Å–µ –∏–ª–∏ –ø—Ä–æ–±–æ–µ –∑–∞ –ø—Ä–µ–¥–µ–ª —Å–µ—Ç–∫–∏ ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ:

–æ—Ç–º–µ–Ω—è–µ–º –≤—Å–µ –≥—Ä–∏–¥‚Äë–ª–∏–º–∏—Ç–∫–∏,

–µ—Å–ª–∏ –µ—Å—Ç—å –æ—Å—Ç–∞—Ç–æ–∫ –ø–æ–∑–∏—Ü–∏–∏ ‚Äî –ø–µ—Ä–µ–≤–æ–¥–∏–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Ç–≤–æ—é TP/SL/Trailing‚Äë–ª–æ–≥–∏–∫—É (–∏–ª–∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ —Å–∏–≥–Ω–∞–ª—É).

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: –≥—Ä–∏–¥ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ TP_LEVELS ‚Äî –æ–Ω —Ç–æ–ª—å–∫–æ ¬´—Å–∫–∞–ª—å–ø–∏—Ç —Å–ø—Ä–µ–¥¬ª. –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Å–µ—Ç–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ –Ω–∞–±—Ä–∞–Ω–∞, –≤—ã—Ö–æ–¥—ã ‚Äî —á–µ—Ä–µ–∑ —Ç–≤–æ–π —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π place_protective_orders() (multi‚ÄëTP + HWM —Ç—Ä–µ–π–ª–∏–Ω–≥) –∏–ª–∏ –º–∞–ª–µ–Ω—å–∫–∏–π —Ñ–∏–∫—Å‚ÄëTP (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.6‚Äì0.8% net).

–ë—ã—Å—Ç—Ä—ã–π .env –¥–ª—è –≥–∏–±—Ä–∏–¥–∞

(–¥–æ–±–∞–≤—å –∫ —Ç–≤–æ–µ–º—É —Ç–µ–∫—É—â–µ–º—É)

# === GRID (–º–∏–∫—Ä–æ) ===

GRID_MODE=true
GRID_SPAN_PCT=0.60 # –æ–±—â–∏–π –æ—Ö–≤–∞—Ç —Å–µ—Ç–∫–∏ –æ—Ç –º–∏–¥–∞ (¬±0.30%)
GRID_LEVELS=6 # –ø–æ 3 –ª–∏–º–∏—Ç–∫–∏ –≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑
GRID_SPACING_PCT=0.10 # —à–∞–≥ –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏
GRID_BASE_USD=25 # –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞—è–≤–∫–∏ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å
GRID_MAKER_ONLY=true # –ø–æ—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ maker (GTX/postOnly)
GRID_REPLENISH_ON_FILL=true # –¥–æ–∑–∞–∫–ª–∞–¥—ã–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ø–æ—Å–ª–µ fill
GRID_MAX_INVENTORY_USD=120 # –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å—É–º–º–∞—Ä–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∏–∑ –≥—Ä–∏–¥–∞
GRID_EXIT_WITH_PROTECTIVE=true # –ø—Ä–∏ –Ω–∞–±–æ—Ä–µ ‚Äî –ø–µ—Ä–µ–¥–∞—Ç—å –≤ —Ç–≤–æ–π place_protective_orders()
GRID_BREAKOUT_MULT=1.2 # –µ—Å–ª–∏ —Ü–µ–Ω–∞ —É—à–ª–∞ > 1.2√óSPAN –∑–∞ N —Å–µ–∫ ‚Äî –∫–∏–ª–ª‚Äë—Å–≤–∏—Ç—á
GRID_BREAKOUT_WINDOW_SEC=5

–ö–∞–∫ —ç—Ç–æ –≤—à–∏—Ç—å (–º–∏–Ω–∏–º—É–º –∫–æ–¥–∞)

1. –ö–æ–Ω—Ñ–∏–≥ (–ø–æ–ª—è)

–î–æ–±–∞–≤—å –≤ TradingConfig —Ñ–ª–∞–≥–∏/—á–∏—Å–ª–∞ –∏–∑ env –≤—ã—à–µ: grid_mode, grid_span_pct, grid_levels, grid_spacing_pct, grid_base_usd, grid_maker_only, grid_replenish_on_fill, grid_max_inventory_usd, grid_exit_with_protective, grid_breakout_mult, grid_breakout_window_sec.

2. –ú–µ–Ω–µ–¥–∂–µ—Ä –≥—Ä–∏–¥–∞ core/grid_manager.py (–æ—á–µ–Ω—å –∫–æ–º–ø–∞–∫—Ç–Ω–æ)

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—à—å ¬´—Å–µ—Ä–µ–¥–∏–Ω—É¬ª (mid = (bestBid+bestAsk)/2).

–°—Ç—Ä–æ–∏—à—å —É—Ä–æ–≤–Ω–∏ –≤–≤–µ—Ä—Ö/–≤–Ω–∏–∑ –æ—Ç mid: level_k = mid * (1 ¬± k*spacing_pct) –≥–¥–µ k=1..GRID_LEVELS/2.

–ù–∞ –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞–≤–∏—à—å LIMIT —Å postOnly/GTX (–µ—Å–ª–∏ —Ç–≤–æ–π –∫–ª–∏–µ–Ω—Ç —ç—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç).

–•—Ä–∞–Ω–∏—à—å active_grid_orders[symbol] = {price -> order_id, side, qty}.

–í–∞–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

place_grid(symbol) ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–∫—É, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —É—Ä–æ–≤–Ω–∏, –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—â–∏–µ minQty.

cancel_grid(symbol) ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –≥—Ä–∏–¥‚Äë–ª–∏–º–∏—Ç–∫–∏.

on_fill(event) ‚Äî –µ—Å–ª–∏ GRID_REPLENISH_ON_FILL=true, –∑–∞–Ω–æ–≤–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç —É—Ä–æ–≤–µ–Ω—å (–∏–ª–∏ —Å–æ—Å–µ–¥–Ω–∏–π), –ø–æ–∫–∞ –Ω–µ —É–ø—ë—Ä—Å—è –≤ GRID_MAX_INVENTORY_USD. –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ ‚Äî –ø–µ—Ä–µ—Å—Ç–∞—ë–º –¥–æ–∑–∞–∫–ª–∞–¥—ã–≤–∞—Ç—å.

check_breakout(symbol) ‚Äî –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ > mid*(1 + GRID_SPAN_PCT/200 * GRID_BREAKOUT_MULT) (–∏–ª–∏ –Ω–∏–∂–µ –¥–ª—è —à–æ—Ä—Ç–∞), —Ç–æ kill‚Äëswitch: cancel_grid(), –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –æ—Å—Ç–∞—Ç–æ–∫ –ø–æ–∑–∏—Ü–∏–∏ –≤ place_protective_orders().

3. –í —Å–≤—è–∑–∫–µ —Å —Ç–≤–æ–∏–º —Å–∏–≥–Ω–∞–ª‚Äë–¥–≤–∏–∂–∫–æ–º

–í –æ—Å–Ω–æ–≤–Ω–æ–º —Ü–∏–∫–ª–µ/WS‚Äë—Ö—ç–Ω–¥–ª–µ—Ä–∞—Ö:

–ï—Å–ª–∏ GRID_MODE –∏ signal_engine.atr1m() <= ATR1M_LOW_THRESH –∏ is_spread_clean() –∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–º–ø—É–ª—å—Å‚Äë—Å–∏–≥–Ω–∞–ª–∞:

–µ—Å–ª–∏ —Å–µ—Ç–∫–∏ –Ω–µ—Ç ‚Üí grid_manager.place_grid(symbol)

–ï—Å–ª–∏ –∏–º–ø—É–ª—å—Å (—Ç–≤–æ–∏ —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–∫–∞–ª—å–ø–µ—Ä–∞) –∏–ª–∏ check_breakout(symbol)==True:

grid_manager.cancel_grid(symbol)

–¥–∞–ª—å—à–µ ‚Äî —Ç–≤–æ—è —Ç–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ –∏–º–ø—É–ª—å—Å‚Äë—Å–∫–∞–ª—å–ø–µ—Ä–∞ (market‚Äëentry + multi‚ÄëTP + trailing)

4. –í—ã—Ö–æ–¥—ã –∏–∑ –≥—Ä–∏–¥–∞

–ë—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Å–æ–≤–æ–∫—É–ø–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –æ—Ç –≥—Ä–∏–¥–∞ ‚â† 0, —Å—Ä–∞–∑—É –¥–µ—Ä–≥–∞–π place_protective_orders() —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ TP (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Ç–≤–æ–µ–π TP_PACK_LOW), —á—Ç–æ–±—ã ¬´–∑–∞—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç—å¬ª —Å–ª—É—á–∞–π–Ω—ã–π –∏–º–ø—É–ª—å—Å –ø—Ä–æ—Ç–∏–≤ –ø–æ–∑–∏—Ü–∏–∏.

–ü–∞—Å—Å–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: –¥–µ—Ä–∂–∞—Ç—å –≤—Å—Ç—Ä–µ—á–Ω—ã–µ –ª–∏–º–∏—Ç–∫–∏ (–º–µ–π–∫–µ—Ä) —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è ‚Äî –Ω–æ —Ç–æ–≥–¥–∞ –≤—ã—à–µ —Ä–∏—Å–∫ ¬´–∑–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏—è¬ª. –Ø —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –±—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (—á–µ—Ä–µ–∑ —Ç–≤–æ—é –∑–∞—â–∏—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É).

–†–∏—Å–∫–∏ –∏ –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã

–ö–æ–º–∏—Å—Å–∏–∏: –ì—Ä–∏–¥ ‚Äî —Ç–æ–ª—å–∫–æ LIMIT + postOnly/GTX, –∏–Ω–∞—á–µ taker‚Äë–∫–æ–º–∏—Å—Å–∏–∏ —Å–æ–∂—Ä—É—Ç –ø—Ä–æ—Ñ–∏—Ç.

minQty/NOTIONAL: —Ñ–∏–ª—å—Ç—Ä—É–π —É—Ä–æ–≤–Ω–∏, –≥–¥–µ qty < minQty. –ù–∞ BTC —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ.

–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å: GRID_MAX_INVENTORY_USD –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤: –ø—Ä–∏ –∏–º–ø—É–ª—å—Å–µ —Å–µ—Ç–∫—É —É–±—Ä–∞—Ç—å –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º —Å–∫–∞–ª—å–ø–µ—Ä–∞.

–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å WS: –Ω–∞ –ø–æ—Ç–µ—Ä—é —Å—Ç—Ä–∏–º–∞ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ cancel_grid() (safe‚Äë—Å—Ç–æ–ø).

–ß—Ç–æ —ç—Ç–æ –¥–∞—Å—Ç

–í–æ —Ñ–ª—ç—Ç–µ ‚Äî –≥—Ä–∏–¥ ¬´–ø–µ—á–∞—Ç–∞–µ—Ç –∫–æ–ø–µ–µ—á–∫–∏¬ª —Å –Ω—É–ª–µ–≤—ã–º maker‚Äë—Ñ–∏–∏.

–ù–∞ –∏–º–ø—É–ª—å—Å–µ ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Ç–≤–æ–π –º–æ—â–Ω—ã–π —Å–∫–∞–ª—å–ø–µ—Ä (multi‚ÄëTP + HWM).

–ò—Ç–æ–≥ ‚Äî –º–µ–Ω—å—à–µ –ø—Ä–æ—Å—Ç–æ—è –∏ –ª—É—á—à–µ —Å—É–º–º–∞—Ä–Ω—ã–π PnL, –ø—Ä–∏ —ç—Ç–æ–º —Ä–∏—Å–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º –ª–∏–º–∏—Ç–∞–º–∏ –∏ –∫–∏–ª‚Äë—Å–≤–∏—Ç—á–µ–º.

## –ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å ‚Äî –Ω–∞–∫–∏–Ω—É –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è grid_manager.py (—Å–∫–µ–ª–µ—Ç —Å place/cancel/on_fill/check_breakout) –∏ —Ç–∏–ø–æ–≤–æ–π –≤—ã–∑–æ–≤ LIMIT‚Äë–æ—Ä–¥–µ—Ä–∞ —Å postOnly/GTX –ø–æ–¥ —Ç–≤–æ–π exchange_client.

GRID_MODE=true
GRID_MAKER_ONLY=true # —Å—Ç—Ä–æ–≥–æ maker/postOnly
GRID_MAX_INVENTORY_USD=120 # –ª–∏–º–∏—Ç–∏—Ä—É–π!
GRID_EXIT_WITH_PROTECTIVE=true # –ø—Ä–∏ –Ω–∞–±–æ—Ä–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤ –∑–∞—â–∏—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

4. –ö—Ç–æ –∫–µ–º –ø–æ–ª—å–∑—É–µ—Ç—Å—è

OrderManager:

–∏—Å–ø–æ–ª—å–∑—É–µ—Ç Fees –¥–ª—è ¬´–≥—Ä–æ—Å—Å‚Äë–∞–ø–∞¬ª TP (net‚Äë—Ü–µ–ª–∏ ‚Üí gross —Ü–µ–Ω—ã) –∏ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ net‚ÄëPNL –≤ –ª–æ–≥–∞—Ö.

–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –æ—Ç SignalEngine (–¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö TP/SL –ø–æ ATR).

GridManager:

—Å–ª—É—à–∞–µ—Ç SignalEngine (ATR/—Å–ø—Ä–µ–¥/–∞–π—Å–±–µ—Ä–≥–∏/–æ–∫–Ω–∞).

–æ—Ç–¥–∞—ë—Ç –æ—Å—Ç–∞—Ç–æ–∫ –ø–æ–∑–∏—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å) –≤ OrderManager —á–µ—Ä–µ–∑ place_protective_orders() (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ).

5. –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫ (–∏ –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å)

–ì–æ–Ω–∫–∞ ‚Äú–æ—Ç–º–µ–Ω–∞ SL vs –Ω–æ–≤—ã–π SL‚Äù

–ü—Ä–∏ BE/—Ç—Ä–µ–π–ª–∏–Ω–≥–µ —Å–Ω–∞—á–∞–ª–∞ –æ—Ç–º–µ–Ω–∏ —Å—Ç–∞—Ä—ã–π SL, –ø–æ—Ç–æ–º –ø–æ—Å—Ç–∞–≤—å –Ω–æ–≤—ã–π; –Ω–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

–î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è WS‚Äë—Å–æ–±—ã—Ç–∏—è

–î–µ–¥—É–ø–ª–∏—Ü–∏—Ä—É–π –ø–æ (orderId, status) –∏–ª–∏ clientOrderId. –ù–µ –∞–∫—Ç–∏–≤–∏—Ä—É–π —Ç—Ä–µ–π–ª–∏–Ω–≥ –¥–≤–∞–∂–¥—ã.

minQty –Ω–∞ BTC/ETH

–£ —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å –∞–≤—Ç–æ‚Äë—É–≤–µ–ª–∏—á–µ–Ω–∏–µ ‚Üí –æ–∫. –ù–æ –≤ Grid —Ñ–∏–ª—å—Ç—Ä—É–π —É—Ä–æ–≤–Ω–∏, –≥–¥–µ qty < minQty.

postOnly –Ω–∞ —Ñ—å—é—á–∞—Ö

–í CCXT/–∫–ª–∏–µ–Ω—Ç–µ —Å—Ç–∞–≤—å {'postOnly': True} (–∏–ª–∏ timeInForce: GTX, –µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è). –ò–Ω–∞—á–µ –ª–∏–º–∏—Ç–∫–∞ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å taker ‚Äî —Å—ä–µ—Å—Ç –ø—Ä–æ—Ñ–∏—Ç –≥—Ä–∏–¥–∞.

‚ÄúWould immediately trigger‚Äù

–ë—É—Ñ–µ—Ä 5\*tickSize —Ç—ã —É–∂–µ —Å—Ç–∞–≤–∏—à—å ‚Äî —Ö–æ—Ä–æ—à–æ. –û—Å—Ç–∞–≤—å —ç—Ç–æ –∏ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö TP/SL.

–ö–æ–º–∏—Å—Å–∏–∏ –∏ BE

–ï—Å–ª–∏ –≤–∫–ª—é—á–∏—à—å INSTANT_BE_AFTER_TP1, BE‚Äë—É—Ä–æ–≤–µ–Ω—å —Å–¥–≤–∏–Ω—å –≤—ã—à–µ –≤—Ö–æ–¥–∞ –Ω–∞ —Ä–∞–∑–º–µ—Ä –∫–æ–º–∏—Å—Å–∏–π (—Ç—ã —ç—Ç–æ —É–∂–µ –∑–∞–ª–æ–∂–∏–ª BE_PLUS_PCT).

6. –ü–æ—Ä—è–¥–æ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (—á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ)

‚úÖ Fees ‚Äî —É–∂–µ —Å–¥–µ–ª–∞–ª–∏ —Ä–∞—Å—á—ë—Ç—ã? (–µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤–Ω–∞—á–∞–ª–µ –∏—Ö; —ç—Ç–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ).

‚úÖ Scalper (SignalEngine + –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL + BE –ø–æ—Å–ª–µ TP1) ‚Äî —É —Ç–µ–±—è –±–∞–∑–æ–≤–∞—è —á–∞—Å—Ç—å —É–∂–µ –µ—Å—Ç—å; –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–∏ SignalEngine –≤ OrderManager (ATR) –∏ handle_order_update (BE).

‚úÖ GridManager ‚Äî –¥–æ–±–∞–≤—å –æ—Ç–¥–µ–ª—å–Ω—ã–º –º–æ–¥—É–ª–µ–º –∏ –∂—ë—Å—Ç–∫–∏–π –∫–∏–ª–ª‚Äë—Å–≤–∏—Ç—á –ø—Ä–∏ –∏–º–ø—É–ª—å—Å–µ/–±—Ä–µ–π–∫–∞—É—Ç–µ.

‚úÖ –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä ‚Äî –Ω–∞–∫–æ–Ω–µ—Ü, —Å–≤–µ–¥–∏ –ø—Ä–∞–≤–∏–ª–∞: –∫—Ç–æ –∫–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω, –∏ –ø–æ—Å—Ç–∞–≤—å —è–≤–Ω—ã–µ –ª–æ–≥‚Äë—Å–æ–±—ã—Ç–∏—è –Ω–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è—Ö.

7. –ë—ã—Å—Ç—Ä—ã–π smoke‚Äë—Ç–µ—Å—Ç (—Ç–µ—Ö–∫–∞—Ä—Ç–∞)

T1 (—Å–∫–∞–ª—å–ø–µ—Ä, ETH): –∏–º–ø—É–ª—å—Å ‚Üí –æ—Ç–∫—Ä—ã—Ç–∏–µ ‚Üí SL+multi‚ÄëTP ‚Üí TP1 fill ‚Üí BE ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π TP ‚Üí trailing –∞–∫—Ç–∏–≤–µ–Ω ‚Üí trailing move only profit.

T2 (BTC, minQty): –ø–æ–∑–∏—Ü–∏—è < minQty ‚Üí –∞–≤—Ç–æ‚Äë—É–≤–µ–ª–∏—á–µ–Ω–∏–µ; —á–∞—Å—Ç—å –º–µ–ª–∫–∏—Ö TP –Ω–µ –æ—Ç—Å–µ–∫–∞–µ—Ç—Å—è; fill –ª–æ–≥–∏—Ä—É–µ—Ç net‚ÄëPNL.

T3 (Grid, —Ñ–ª—ç—Ç): ATR –Ω–∏–∑–∫–∏–π ‚Üí —Å—Ç–∞–≤–∏—Ç—Å—è —Å–µ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ maker; –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä—ã –ª–∏–º–∏—Ç–æ–∫ ‚Üí –µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω GRID_EXIT_WITH_PROTECTIVE, –≤—ã—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –∑–∞—â–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞; breakout ‚Üí –∫–∏–ª–ª‚Äë—Å–≤–∏—Ç—á (–æ—Ç–º–µ–Ω–∞ –ª–∏–º–∏—Ç–æ–∫) –¥–æ –≤—Ö–æ–¥–∞ —Å–∫–∞–ª—å–ø–µ—Ä–∞.

T4 (Fees): –º–∞–ª—ã–µ TP (0.6‚Äì1.0%) –¥–∞—é—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π net –≤ –ª–æ–≥–∞—Ö; BE –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ ~0 –ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π.

T5 (–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ): –≤–æ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Ç–∫–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–º–ø—É–ª—å—Å ‚Üí —Å–Ω–∞—á–∞–ª–∞ –æ—Ç–º–µ–Ω–∞ —Å–µ—Ç–∫–∏, –∑–∞—Ç–µ–º –≤—Ö–æ–¥ —Å–∫–∞–ª—å–ø–µ—Ä–∞, –±–µ–∑ ‚Äú–ø–µ—Ä–µ–ø—É—Ç–∞–Ω–Ω—ã—Ö‚Äù –æ—Ä–¥–µ—Ä–æ–≤.

–ò—Ç–æ–≥

–î–∞, –∫–æ–º–ø–ª–µ–∫—Å —Å–æ–≤–º–µ—Å—Ç–∏–º.

–ö–ª—é—á –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Ä–µ–∂–∏–º—ã (Grid ‚Üî Scalper), postOnly –¥–ª—è –≥—Ä–∏–¥–∞, –µ–¥–∏–Ω—ã–π OrderManager –¥–ª—è –≤—Å–µ—Ö –≤—ã—Ö–æ–¥–æ–≤ (multi‚ÄëTP + HWM), –∏ —á–µ—Å—Ç–Ω—ã–π —É—á—ë—Ç –∫–æ–º–∏—Å—Å–∏–π (Fees) + net‚ÄëPNL –≤ –ª–æ–≥–∞—Ö.

–ù–∞—á–Ω–∏ —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã—Ö Fees –∏ –°–∫–∞–ª—å–ø–µ—Ä–∞; –ì—Ä–∏–¥ –¥–æ–±–∞–≤—å –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏ —Å—Ä–∞–∑—É —Å –∂—ë—Å—Ç–∫–∏–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ (GRID*MAX_INVENTORY_USD, GRID_BREAKOUT*\*).

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —Å–≥–µ–Ω–µ—Ä–∏—Ä—É—é —Ç–µ–±–µ –º–∞–ª–µ–Ω—å–∫–∏–π diff‚Äë–ø–∞–∫–µ—Ç: grid_manager.py (—Å–∫–µ–ª–µ—Ç), –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ–π –≤ TradingConfig, –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã–∑–æ–≤–æ–≤ –≤ WS‚Äë—Ö—ç–Ω–¥–ª–µ—Ä–∞—Ö –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π ‚Äî —á—Ç–æ–±—ã –≤—Å—ë —Å–æ–±—Ä–∞—Ç—å –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤—ã–ª–∞–≤–ª–∏–≤–∞–Ω–∏—è –º–µ—Å—Ç.

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–∞ —Ç–æ —á—Ç–æ —Ä–∞–Ω—å—à–µ –æ–±—Å—É–∂–¥–∞–ª–∏ –≤ —Å–≤–µ—Ç–µ –∂—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ –Ω–∞–¥–æ- —Å–µ–Ω—Ç—Ä–∞–ª —Ä–µ–π—Ç –ª–∏–º–∏—Ç–µ—Ä –∏–ª–∏ —á—Ç–æ —Ç–æ —Ç–∞–∫–æ–µ
ChatGPT —Å–∫–∞–∑–∞–ª:

–ö–æ—Ä–æ—Ç–∫–æ: —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π rate‚Äëlimiter –≤—Å—ë –µ—â—ë –Ω—É–∂–µ–Ω ‚Äî –¥–∞–∂–µ –±–æ–ª—å—à–µ, —á–µ–º —Ä–∞–Ω—å—à–µ.
–°–∫–∞–ª—å–ø–µ—Ä + –º–∏–∫—Ä–æ‚Äë–≥—Ä–∏–¥ + –æ–Ω–ª–∞–π–Ω‚Äë—Ç—Ä–µ–π–ª–∏–Ω–≥ = –º–Ω–æ–≥–æ –º–µ–ª–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –ë–µ–∑ –æ–¥–Ω–æ–≥–æ ¬´—Ü–µ–Ω—Ç—Ä–∞ –¥—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è¬ª —Ç—ã –ø–æ–π–º–∞–µ—à—å –ª–∏–º–∏—Ç—ã –±–∏—Ä–∂–∏, –¥—É–ø–ª–∏–∫–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ö–≤–æ—Å—Ç—ã –æ—Ç–º–µ–Ω/—Å–æ–∑–¥–∞–Ω–∏–π –æ—Ä–¥–µ—Ä–æ–≤.

–í–æ—Ç –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å (–∏ –∫–∞–∫)

1. –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω‚Äë–±–∞–∫–µ—Ç (requests/sec + burst)

–û–¥–∏–Ω global bucket –Ω–∞ –≤–µ—Å—å –±–æ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 rps, burst 20).

–ü–ª—é—Å per‚Äëroute buckets:

create_order (–∂—ë—Å—Ç—á–µ),

cancel_order (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –Ω–æ –ø–æ–¥ –ª–∏–º–∏—Ç),

fetch_open_orders, get_markets, get_ticker (–∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å).

2. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –æ—á–µ—Ä–µ–¥–∏

P0: –æ—Ç–º–µ–Ω—ã SL/TP (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ BE/—Ç—Ä–µ–π–ª–∏–Ω–≥–µ), cancel_grid() –ø—Ä–∏ –∏–º–ø—É–ª—å—Å–µ.

P1: –Ω–æ–≤—ã–µ –∑–∞—â–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ (SL/TP/Trailing).

P2: –≤—Ö–æ–¥—ã/–¥–æ–∫—É–ø–∫–∏.

P3: —á—Ç–µ–Ω–∏–µ (fetch\_\*), –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ–µ.

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –æ–¥–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º (min‚Äëheap), –≤–æ—Ä–∫–µ—Ä—ã –±–µ—Ä—É—Ç –∑–∞–¥–∞—á–∏ —Å —É—á—ë—Ç–æ–º —Ç–æ–∫–µ–Ω‚Äë–±–∞–∫–µ—Ç–∞.

3. –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∏ –∫–æ–∞–ª–µ—Åc–∏–Ω–≥

Coalesce fetch_open_orders / get_markets / exchange.get_ticker(symbol) –≤ —Ä–∞–º–∫–∞—Ö 200‚Äì500 –º—Å –æ–∫–Ω–∞: –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –≤—Å–µ –æ–∂–∏–¥–∞—é—â–∏–µ –≤—ã–∑–æ–≤—ã.

Debounce –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö cancel_order –ø–æ –æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ order_id (—á–∞—Å—Ç–æ –ø—Ä–∏–ª–µ—Ç–∞–µ—Ç –¥–≤–∞ —Å–æ–±—ã—Ç–∏—è WS –ø–æ–¥—Ä—è–¥).

4. –ê–Ω—Ç–∏‚Äë—à—Ç–æ—Ä–º

–ü—Ä–∏ ¬´–ª–∞–≤–∏–Ω–µ¬ª —Å–æ–±—ã—Ç–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–µ–Ω–∞ –ª–µ—Ç–∏—Ç, TP –∏ —Ç—Ä–µ–π–ª–∏–Ω–≥ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–∞—Å—Ç–æ) ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ SL –¥–ª—è —Ç–æ–≥–æ –∂–µ —Å–∏–º–≤–æ–ª–∞ (—Å–∫–∞–∂–µ–º, ‚â•150‚Äì250 –º—Å), –ø—Ä–∏ —ç—Ç–æ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –∞–ø–¥–µ–π—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è (trailing ‚Äúlast‚Äëwrite‚Äëwins‚Äù).

5. –ë—ç–∫–æ—Ñ—Ñ + –¥–∂–∏—Ç—Ç–µ—Ä

–û—à–∏–±–∫–∏ 429/418/TEMPORARY_BAN ‚Üí —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff —Å –¥–∂–∏—Ç—Ç–µ—Ä–æ–º, –Ω–æ –¥–ª—è P0‚Äë–∑–∞–¥–∞—á –¥–µ—Ä–∂–∏ –∫—Ä–∞—Ç–∫–∏–π ¬´–±—ã—Å—Ç—Ä—ã–π¬ª –ø—É—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π bucket, —á—Ç–æ–±—ã —É—Å–ø–µ—Ç—å –æ—Ç–º–µ–Ω–∏—Ç—å SL).

6. –ö—ç—à –∏ TTL

get_markets() ‚Äî –∫—ç—à –Ω–∞ 5‚Äì10 –º–∏–Ω—É—Ç.

exchange.fetch_balance() ‚Äî –ø–æ —Å–æ–±—ã—Ç–∏—é / —Ä–∞–∑ –≤ N –º–∏–Ω—É—Ç.

get_ticker ‚Äî –∫—ç—à 100‚Äì200 –º—Å (—Å–∫–∞–ª—å–ø–µ—Ä –±–µ—Ä—ë—Ç —Ü–µ–Ω—É –∏–∑ WS; REST ‚Äî —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback).

7. WS‚Äë—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞

Reconnect‚Äë–ª–∏–º–∏—Ç–µ—Ä: –ø—Ä–∏ –æ–±—Ä—ã–≤–µ –Ω–µ –ø—ã—Ç–∞—Ç—å—Å—è –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è —á–∞—â–µ, —á–µ–º —Ä–∞–∑ –≤ 3‚Äì5 —Å–µ–∫, —Å —Ä–æ—Å—Ç–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞.

Heartbeat: –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ N –ø–∏–Ω–≥–æ–≤ ‚Äî –º—è–≥–∫–∏–π —Ä–µ—Å—Ç–∞—Ä—Ç, –Ω–æ —á–µ—Ä–µ–∑ –ª–∏–º–∏—Ç–µ—Ä.

–ì–¥–µ –≤—Å—Ç—Ä–æ–∏—Ç—å –≤ —Ç–≤–æ—ë–º –ø—Ä–æ–µ–∫—Ç–µ
A) –û–±—ë—Ä—Ç–∫–∞ –ø–æ–≤–µ—Ä—Ö exchange_client

–î–æ–±–∞–≤—å ¬´–ø—Ä–æ—Å–ª–æ–π–∫—É¬ª RateLimitedClient, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç exchange_client –∏:

–∏–º–µ–µ—Ç \**async def request(kind, fn, *args, priority=P2, weight=1, kwargs),

–∫–ª–∞–¥—ë—Ç –∑–∞–¥–∞—á—É –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—É—é –æ—á–µ—Ä–µ–¥—å,

—Å–ø–∏—Å—ã–≤–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã –∏–∑ –Ω—É–∂–Ω–æ–≥–æ bucket,

–≤—ã–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π exchange_client.fn.

–í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –≤—ã–∑–æ–≤—ã (create_order, cancel_order, fetch_open_orders, get_ticker, ‚Ä¶) –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —ç—Ç—É –æ–±—ë—Ä—Ç–∫—É.

B) –í OrderManager

–í –º–µ—Å—Ç–∞—Ö BE/—Ç—Ä–µ–π–ª–∏–Ω–≥–∞/–ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ SL/TP ‚Äî –≤—Å–µ cancel*\*/create*\* —á–µ—Ä–µ–∑ RateLimitedClient —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ (P0/P1).

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Ç—Ä–µ–π–ª–∏–Ω–≥–∞ ‚Äî –¥–æ–±–∞–≤—å per‚Äësymbol throttle (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ —á–∞—â–µ 200 –º—Å).

C) –í GridManager

–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ç–∫–∏ ‚Äî –ø–∞—á–∫–æ–π, –Ω–æ —á–µ—Ä–µ–∑ –ª–∏–º–∏—Ç–µ—Ä, —Å maker‚Äëonly.

Replenish —É—Ä–æ–≤–Ω—è –ø–æ—Å–ª–µ fill ‚Äî P2, –Ω–æ –ø–æ–¥ –æ–±—â–∏–π –ª–∏–º–∏—Ç.

cancel_grid() ‚Äî P0.

–ú–∏–Ω–∏‚Äë–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Å–∫–µ–ª–µ—Ç)

# core/rate_limiter.py

import asyncio, time, heapq
from collections import defaultdict, deque
from dataclasses import dataclass, field

@dataclass(order=True)
class TaskItem:
priority: int
ts: float
fn: any=field(compare=False)
args: tuple=field(compare=False)
kwargs: dict=field(compare=False)
weight: int=field(compare=False, default=1)

class TokenBucket:
def **init**(self, rate_per_sec: float, burst: int):
self.rate = rate_per_sec
self.capacity = burst
self.tokens = burst
self.updated = time.monotonic()
self.lock = asyncio.Lock()

    async def acquire(self, weight=1):
        async with self.lock:
            while True:
                now = time.monotonic()
                elapsed = now - self.updated
                self.updated = now
                self.tokens = min(self.capacity, self.tokens + elapsed * self.rate)
                if self.tokens >= weight:
                    self.tokens -= weight
                    return
                wait_for = (weight - self.tokens) / self.rate if self.rate > 0 else 0.05
                await asyncio.sleep(max(0.01, wait_for))

class RateLimitedClient:
def **init**(self, exchange):
self.exchange = exchange
self.global_bucket = TokenBucket(rate_per_sec=10, burst=20)
self.route_bucket = {
"create_order": TokenBucket(5, 10),
"cancel_order": TokenBucket(8, 10),
"fetch_open_orders": TokenBucket(3, 6),
"get_ticker": TokenBucket(6, 12),
}
self.queue = []
self.cv = asyncio.Condition()

        # coalesce caches
        self._coalesce = defaultdict(lambda: {"futs": deque(), "running": False, "last": 0.0})

        asyncio.create_task(self._worker())

    async def submit(self, kind, fn, *args, priority=2, weight=1, **kwargs):
        async with self.cv:
            heapq.heappush(self.queue, TaskItem(priority, time.monotonic(), (kind, fn), args, kwargs, weight))
            self.cv.notify()

    async def _worker(self):
        while True:
            async with self.cv:
                while not self.queue:
                    await self.cv.wait()
                item = heapq.heappop(self.queue)

            kind, fn = item.fn
            # wait tokens
            await self.global_bucket.acquire(item.weight)
            await self.route_bucket.get(kind, self.global_bucket).acquire(item.weight)

            try:
                await fn(*item.args, **item.kwargs)
            except Exception:
                # TODO: backoff + retry with jitter by kind
                await asyncio.sleep(0.2)

–í—ã–∑–æ–≤ –∏–∑ OrderManager:

await self.rl.submit("cancel_order", self.exchange.cancel_order, order_id, symbol, priority=0)
await self.rl.submit("create_order", self.exchange.create_order, symbol, t, side, qty, price, params, priority=1)

–ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

global: 10 rps / 20 burst

create_order: 5 rps / 10 burst

cancel_order: 8 rps / 10 burst

fetch_open_orders: 3 rps / 6 burst + coalesce 300 –º—Å

get_ticker: 6 rps / 12 burst + cache 150 –º—Å

per‚Äësymbol trailing update: –Ω–µ —á–∞—â–µ 200 –º—Å

WS reconnect: min 3 —Å–µ–∫, backoff –¥–æ 30 —Å–µ–∫ —Å –¥–∂–∏—Ç—Ç–µ—Ä–æ–º

(–≠—Ç–∏ —á–∏—Å–ª–∞ ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –∏ –Ω–µ–±–æ–ª—å—à–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –ø–∞—Ä; –ø—Ä–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–π –ª–∏–Ω–µ–π–Ω–æ –∏/–∏–ª–∏ —Ä–∞–∑–¥–µ–ª—è–π –ø–æ‚Äë—Å–∏–º–≤–æ–ª—å–Ω–æ.)

–ò—Ç–æ–≥

–î–∞, —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π rate‚Äëlimiter –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –Ω–∞—à–µ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞ (fees + —Å–∫–∞–ª—å–ø–µ—Ä + multi‚ÄëTP/HWM + –º–∏–∫—Ä–æ–≥—Ä–∏–¥).

–û–Ω —É–±–∏—Ä–∞–µ—Ç –≥–æ–Ω–∫–∏, –¥—Ä–µ–±–µ–∑–≥ –∏ ¬´–ª–∞–≤–∏–Ω—ã¬ª –∑–∞–ø—Ä–æ—Å–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç API‚Äë–ª–∏–º–∏—Ç—ã.

–†–µ–∞–ª–∏–∑—É–π –∫–∞–∫ –æ–¥–Ω—É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –ø—Ä–æ—Å–ª–æ–π–∫—É —Å —Ç–æ–∫–µ–Ω‚Äë–±–∞–∫–µ—Ç–∞–º–∏, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –∏ –∫–æ–∞–ª–µ—Åc–∏–Ω–≥–æ–º ‚Äî –∏ –ø–æ–¥–∫–ª—é—á–∏ –≤—Å–µ REST‚Äë–≤—ã–∑–æ–≤—ã —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –Ω–µ—ë.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –ø–∞—Ç—á: core/rate_limiter.py + –≤—Ç—ã–∫ –≤ exchange_client/order_manager/grid_manager —Å –≥–æ—Ç–æ–≤—ã–º–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏.

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–∞ –º–æ–∂–µ—à—å –±–ª–æ–∫–∞–º–∏ —Ä–∞—Å–ø–∏—Å–∞—Ç—å —Å–Ω–æ–≤–∞ –∏ –≤–µ–ª—é—á–∏–≤ –ø–æ—è—Å–Ω–µ–Ω–∏—è –∏ –∫–æ–¥ –Ω–∞—á–∏–Ω–∞—è –æ—Ç—Å—é–¥–∞ –ò–¥–µ–∏, –∫–∞–∫ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å —ç—Ç–æ –≤ ¬´—Å—É–ø–µ—Ä-—ç—Ñ—Ñ–µ–∫—Ç¬ª —Å–∫–∞–ª—å–ø–µ—Ä–∞
ChatGPT —Å–∫–∞–∑–∞–ª:

–æ–∫, —Å–æ–±–µ—Ä—É –≤—Å—ë ¬´–±–ª–æ–∫–∞–º–∏¬ª ‚Äî –æ—Ç –∏–¥–µ–π –¥–æ –≥–æ—Ç–æ–≤—ã—Ö –≤—Å—Ç–∞–≤–æ–∫ –∫–æ–¥–∞ –∏ .env. –ú–æ–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —á–∞—Å—Ç—è–º. –ù–∏–∂–µ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Å–∫–∞–ª—å–ø–µ—Ä–∞, –±–µ–∑ –≥—Ä–∏–¥–∞ (–µ–≥–æ –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø–æ–∑–∂–µ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å).

0. .env ‚Äî —Ñ–ª–∞–≥–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∫–∞–ª—å–ø–µ—Ä–∞

# === Scalping mode (–≤–∫–ª—é—á–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã –≤—Ö–æ–¥–∞ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL) ===

SCALPING_MODE=true

# 1) Ultra-short –∏–º–ø—É–ª—å—Å (–æ–∫–Ω–æ –∏ –ø–æ—Ä–æ–≥–∏)

IMPULSE_LOOKBACK_SEC=3
IMPULSE_MOVE_PCT=0.22 # 0.15‚Äì0.25% ‚Äî –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø–æ–¥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
IMPULSE_MIN_TRADE_VOL=50000 # —Å—É–º–º–∞ –æ–±—ä—ë–º–∞ (USDT/USDC) –∑–∞ –æ–∫–Ω–æ
IMPULSE_REQUIRE_TICK_ACCEL=true

# 2) –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (ATR 1m)

ADAPTIVE_TPSL=true
ATR1M_PERIOD=60 # —Å–µ–∫—É–Ω–¥ –≤ ¬´1m¬ª
ATR1M_HIGH_THRESH=0.35 # –≤—ã—Å–æ–∫–∏–π —Ä–µ–∂–∏–º (%/–º–∏–Ω)
ATR1M_LOW_THRESH=0.15 # –Ω–∏–∑–∫–∏–π —Ä–µ–∂–∏–º
TP_PACK_LOW='[{"percent":0.6,"size":0.5},{"percent":1.2,"size":0.5}]'
TP_PACK_BASE='[{"percent":0.8,"size":0.4},{"percent":1.6,"size":0.3},{"percent":2.4,"size":0.3}]'
TP_PACK_HIGH='[{"percent":1.2,"size":0.34},{"percent":2.0,"size":0.33},{"percent":3.0,"size":0.33}]'
SL_PCT_LOW=0.5
SL_PCT_BASE=0.8
SL_PCT_HIGH=1.2

# 3) Instant break-even –ø–æ—Å–ª–µ TP1

INSTANT_BE_AFTER_TP1=true
BE_PLUS_PCT=0.06 # +0.06% –∫ —Ü–µ–Ω–µ –≤—Ö–æ–¥–∞ (–ø–µ—Ä–µ–∫—Ä—ã—Ç—å –∫–æ–º–∏—Å—Å–∏–∏)

# 4) –§–∏–ª—å—Ç—Ä ¬´—á–∏—Å—Ç–æ—Ç—ã¬ª —Ä—ã–Ω–∫–∞

SPREAD_MAX_PCT=0.05
BLOCK_IF_OPPOSITE_ICEBERG=true
ICEBERG_MIN_SIZE_USD=150000

# 5) –ú–∏–∫—Ä–æ-–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥ (–¥–æ–±–∞–≤–∫–∞ –ø—Ä–∏ —É—Å–∫–æ—Ä–µ–Ω–∏–∏)

MICRO_PYRAMID=true
PYRAMID_ACCEL_PCT_PER_SEC=0.20
PYRAMID_ADD_SIZE_FRAC=0.15
PYRAMID_MAX_ADDS=2
PYRAMID_MIN_DIST_TO_SL_PCT=0.6

# 6) –¢–æ—Ä–≥–æ–≤—ã–µ –æ–∫–Ω–∞ –ø–æ UTC (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ SCALPING_MODE=true)

SCALPING_WINDOWS_UTC='[["08:00","11:00"],["13:00","16:00"]]'

–ö–æ–º–∏—Å—Å–∏–∏ –∏ net‚ÄëPNL —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏ ‚Äî –æ—Å—Ç–∞–≤—å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø—Ä–∞–≤–æ–∫:
ENABLE_FEE_ADJUSTMENT=true, TAKER_FEE_PERCENT=0.04, MAKER_FEE_PERCENT=0.00, PAY_FEES_WITH_BNB=true.

1. –ú–æ–¥—É–ª—å —Å–∏–≥–Ω–∞–ª–æ–≤: –∏–º–ø—É–ª—å—Å, ATR, —Å–ø—Ä–µ–¥, –∞–π—Å–±–µ—Ä–≥–∏, –æ–∫–Ω–∞
   –§–∞–π–ª: core/signal_engine.py

–ó–∞—á–µ–º: —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Å—á—ë—Ç —É—Å–ª–æ–≤–∏–π –≤—Ö–æ–¥–∞ —Å–∫–∞–ª—å–ø–µ—Ä–∞, —á—Ç–æ–±—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –±—ã–ª–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π.

# core/signal_engine.py

from **future** import annotations
from collections import deque
from datetime import datetime, timedelta

class SignalEngine:
def **init**(self, config, logger):
self.cfg = config
self.log = logger
self.prices = deque(maxlen=600) # –ø–æ—Å–ª–µ–¥–Ω–∏–µ ~10 –º–∏–Ω—É—Ç –ø–æ —Å–µ–∫—É–Ω–¥–∞–º
self.volumes = deque(maxlen=600) # —Å—É–º–º–∞ –æ–±—ä—ë–º–∞ –≤ –∫–æ—Ç–∏—Ä—É–µ–º–æ–π –≤–∞–ª—é—Ç–µ
self.depth_best = {"bid": None, "ask": None, "oppo_iceberg_usd": 0.0}

    # === feed –∏–∑ WS ===
    def on_trade_tick(self, price: float, qty_usd: float, ts: datetime | None = None):
        ts = ts or datetime.utcnow()
        self.prices.append((ts, float(price)))
        self.volumes.append((ts, float(qty_usd)))

    def on_depth(self, best_bid: float, best_ask: float, opposite_iceberg_usd: float = 0.0):
        self.depth_best["bid"] = float(best_bid)
        self.depth_best["ask"] = float(best_ask)
        self.depth_best["oppo_iceberg_usd"] = float(opposite_iceberg_usd)

    # === helpers ===
    def _cut(self, seconds: int):
        t_cut = datetime.utcnow() - timedelta(seconds=seconds)
        return t_cut

    def pct_move_in(self, seconds: int) -> float:
        if not self.prices:
            return 0.0
        t_cut = self._cut(seconds)
        arr = [p for ts, p in self.prices if ts >= t_cut]
        if len(arr) < 2:
            return 0.0
        p0, p1 = arr[0], arr[-1]
        return (p1 - p0) / p0 * 100.0

    def vol_sum_in(self, seconds: int) -> float:
        t_cut = self._cut(seconds)
        return sum(v for ts, v in self.volumes if ts >= t_cut)

    def atr1m(self) -> float:
        # —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π ATR: (max - min) / mid * 100 –∑–∞ ATR1M_PERIOD
        period = int(getattr(self.cfg, "atr1m_period", 60))
        t_cut = self._cut(period)
        arr = [p for ts, p in self.prices if ts >= t_cut]
        if len(arr) < 5:
            return 0.0
        hi, lo = max(arr), min(arr)
        mid = (hi + lo) / 2.0
        return ((hi - lo) / mid * 100.0) if mid > 0 else 0.0

    def is_spread_clean(self) -> bool:
        bb, aa = self.depth_best["bid"], self.depth_best["ask"]
        if not bb or not aa:
            return False
        spread = (aa - bb) / ((aa + bb) / 2.0) * 100.0
        return spread <= float(getattr(self.cfg, "spread_max_pct", 0.05))

    def opposite_iceberg_block(self) -> bool:
        if not getattr(self.cfg, "block_if_opposite_iceberg", True):
            return False
        return self.depth_best.get("oppo_iceberg_usd", 0.0) >= float(
            getattr(self.cfg, "iceberg_min_size_usd", 150000.0)
        )

    def in_scalping_window(self) -> bool:
        if not getattr(self.cfg, "scalping_mode", False):
            return True
        import json
        try:
            windows = json.loads(getattr(self.cfg, "scalping_windows_utc", "[]"))
        except Exception:
            return True
        hhmm = datetime.utcnow().strftime("%H:%M")
        return any(start <= hhmm <= end for start, end in windows)

    # === —Å–∏–≥–Ω–∞–ª—ã ===
    def impulse_long_ok(self) -> bool:
        m = self.pct_move_in(int(getattr(self.cfg, "impulse_lookback_sec", 3)))
        v = self.vol_sum_in(int(getattr(self.cfg, "impulse_lookback_sec", 3)))
        return (m >= float(getattr(self.cfg, "impulse_move_pct", 0.22))) and (
            v >= float(getattr(self.cfg, "impulse_min_trade_vol", 0.0))
        )

    def impulse_short_ok(self) -> bool:
        m = self.pct_move_in(int(getattr(self.cfg, "impulse_lookback_sec", 3)))
        v = self.vol_sum_in(int(getattr(self.cfg, "impulse_lookback_sec", 3)))
        return (m <= -float(getattr(self.cfg, "impulse_move_pct", 0.22))) and (
            v >= float(getattr(self.cfg, "impulse_min_trade_vol", 0.0))
        )

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ñ–∏–¥–æ–≤:

–í WS trade/aggTrade: signal_engine.on_trade_tick(price, qty_usd)

–í WS depth: signal_engine.on_depth(bestBid, bestAsk, icebergUsd)
(iceberg –º–æ–∂–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å: –∫—Ä—É–ø–Ω—ã–µ —Å–∫—Ä—ã—Ç—ã–µ –æ–±—ä—ë–º—ã/–∞–Ω–æ–º–∞–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å —Å—Ç–∞–∫–∞–Ω–∞ ‚Üí –ø–µ—Ä–µ–¥–∞—ë–º –æ—Ü–µ–Ω–∫—É –≤ opposite_iceberg_usd).

2. –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø–æ ultra‚Äëshort –∏–º–ø—É–ª—å—Å–∞–º
   –ì–¥–µ: –≤–∞—à —Å–ª–æ–π –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π (—Å—Ç—Ä–∞—Ç–µ–≥–∏—è/entry)

–ò–¥–µ—è: –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é, –µ—Å–ª–∏ —Ä—ã–Ω–æ–∫ ¬´–≥—Ä—è–∑–Ω—ã–π¬ª –∏–ª–∏ –≤–Ω–µ –æ–∫–æ–Ω. –í—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–º–ø—É–ª—å—Å–µ –∏ —á–∏—Å—Ç–æ–º —Å–ø—Ä–µ–¥–µ.

# strategy_decider.py (–ø—Å–µ–≤–¥–æ–∫–æ–¥)

def can_enter_long(symbol) -> bool:
if not signal_engine.in_scalping_window(): return False
if not signal_engine.is_spread_clean(): return False
if signal_engine.opposite_iceberg_block(): return False
return signal_engine.impulse_long_ok()

def can_enter_short(symbol) -> bool:
if not signal_engine.in_scalping_window(): return False
if not signal_engine.is_spread_clean(): return False
if signal_engine.opposite_iceberg_block(): return False
return signal_engine.impulse_short_ok()

–ü—Ä–∏ True ‚Äî –≤—ã–∑—ã–≤–∞–µ–º –≤–∞—à —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –æ—Ç–∫—Ä—ã—Ç–∏—è (market/taker) –∏ —Å—Ä–∞–∑—É place_protective_orders().

3. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL (ATR‚Üí–ø–∞–∫–µ—Ç—ã —É—Ä–æ–≤–Ω–µ–π)
   –§–∞–π–ª: core/order_manager.py (–¥–æ–±–∞–≤–∫–∏)

–ò–¥–µ—è: –ø–µ—Ä–µ–¥ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –∑–∞—â–∏—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ –≤—ã–±—Ä–∞—Ç—å TP/SL‚Äë–Ω–∞–±–æ—Ä –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç ATR.

# –≤–Ω—É—Ç—Ä–∏ OrderManager

def \_pick_tp_pack_and_sl(self, atr1m: float):
import json
lo = float(getattr(self.config, "atr1m_low_thresh", 0.15))
hi = float(getattr(self.config, "atr1m_high_thresh", 0.35))
if atr1m >= hi:
tp = json.loads(getattr(self.config, "tp_pack_high", "[]"))
sl = float(getattr(self.config, "sl_pct_high", 1.2))
elif atr1m <= lo:
tp = json.loads(getattr(self.config, "tp_pack_low", "[]"))
sl = float(getattr(self.config, "sl_pct_low", 0.5))
else:
tp = json.loads(getattr(self.config, "tp_pack_base", "[]"))
sl = float(getattr(self.config, "sl_pct_base", 0.8))
return (tp if tp else self.config.tp_levels), sl

–í –Ω–∞—á–∞–ª–µ place_protective_orders(...):

atr = 0.0
if hasattr(self, "signal_engine") and getattr(self.config, "adaptive_tpsl", True):
try:
atr = float(self.signal_engine.atr1m())
except Exception:
atr = 0.0

if getattr(self.config, "adaptive_tpsl", True):
tp_levels_cfg, sl_pct = self.\_pick_tp_pack_and_sl(atr)
else:
tp_levels_cfg, sl_pct = self.config.tp_levels, float(self.config.stop_loss_percent)

# –¥–∞–ª–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sl_pct –≤–º–µ—Å—Ç–æ self.config.stop_loss_percent

# –∏ tp_levels_cfg –≤–º–µ—Å—Ç–æ self.config.tp_levels (—Å —Ç–≤–æ–∏–º —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º —É—á—ë—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π)

4. Instant Break‚ÄëEven –ø–æ—Å–ª–µ TP1
   –ì–¥–µ: core/order_manager.py ‚Üí handle_order_update(FILLED)

–ò–¥–µ—è: –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ TP –ø–æ–¥—Ç—è–Ω—É—Ç—å SL —á—É—Ç—å –≤ –ø–ª—é—Å (—É—á–∏—Ç—ã–≤–∞—è –∫–æ–º–∏—Å—Å–∏–∏).

if getattr(self.config, "instant_be_after_tp1", True):
cid = (event.get('C') or event.get('c') or "").lower() # clientOrderId
if "tp1" in cid: # –∏–ª–∏ –∏–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–∞ –ø–µ—Ä–≤–æ–≥–æ TP
pos = self.positions_cache.get(symbol) or {}
entry = float(pos.get("entry_price") or 0.0)
side = pos.get("side") # 'buy'|'sell'
be_plus = float(getattr(self.config, "be_plus_pct", 0.06)) / 100.0

        if entry > 0 and side in ("buy", "sell"):
            be_price = entry * (1 + be_plus) if side == "buy" else entry * (1 - be_plus)

            # –æ—Ç–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–π SL –∏ —Å—Ç–∞–≤–∏–º –Ω–æ–≤—ã–π BE-SL
            try:
                await self.exchange.cancel_sl_order(symbol, side)
            except Exception:
                pass

            params = {
                "stopPrice": float(be_price),
                "reduceOnly": True,
                "workingType": self.config.working_type,
                "newClientOrderId": self._make_client_id(symbol, "SL_BE"),
            }
            await self.exchange.create_order(
                symbol, self.config.sl_order_type,
                "sell" if side == "buy" else "buy",
                None, None, params
            )
            self.logger.log_event("ORDER_MANAGER", "INFO",
                f"{symbol}: BE set at {be_price:.2f} after TP1")

–¢—Ä–µ–π–ª–∏–Ω–≥ –ø–æ‚Äë–ø—Ä–µ–∂–Ω–µ–º—É –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ TP ‚Äî —É —Ç–µ–±—è —ç—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ.

5. –§–∏–ª—å—Ç—Ä ¬´—á–∏—Å—Ç–æ—Ç—ã¬ª —Å—Ç–∞–∫–∞–Ω–∞ –Ω–∞ –≤—Ö–æ–¥

–ì–¥–µ: —Ç–∞–º –∂–µ, –≥–¥–µ –ø—Ä–æ–≤–µ—Ä—è–µ—à—å –∏–º–ø—É–ª—å—Å (—Å–º. –ë–ª–æ–∫ 2).
–ü–æ—è—Å–Ω–µ–Ω–∏–µ:

is_spread_clean() ‚Äî –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—Ö–æ–¥, –µ—Å–ª–∏ —Å–ø—Ä–µ–¥ —à–∏—Ä–æ–∫.

opposite_iceberg_block() ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥, –µ—Å–ª–∏ –≤–∏–¥–µ–Ω –∫—Ä—É–ø–Ω—ã–π –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–π –∞–π—Å–±–µ—Ä–≥ (–ø–æ —Ç–≤–æ–µ–π —ç–≤—Ä–∏—Å—Ç–∏–∫–µ/–æ—Ü–µ–Ω–∫–µ).

–ï—Å–ª–∏ —É —Ç–µ–±—è –µ—â—ë –Ω–µ—Ç —Ä–∞—Å—á—ë—Ç–∞ opposite_iceberg_usd, –∑–∞–≤–µ–¥–∏ –ø—Ä–æ—Å—Ç—É—é —ç–≤—Ä–∏—Å—Ç–∏–∫—É –≤ depth‚Äë—Ö—ç–Ω–¥–ª–µ—Ä–µ:

–µ—Å–ª–∏ —Å—É–º–º–∞—Ä–Ω—ã–π –æ–±—ä—ë–º —Ç–æ–ø‚ÄëN —É—Ä–æ–≤–Ω–µ–π –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø—Ä–æ—Ç–∏–≤ –≤—Ö–æ–¥–∞ —Ä–µ–∑–∫–æ ‚Üë –∑–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –æ–∫–Ω–æ ‚Üí —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –µ—Å—Ç—å ¬´–ª–µ–¥–Ω–∏–∫¬ª, –ø–æ—Å—Ç–∞–≤—å opposite_iceberg_usd ‚âà –æ—Ü–µ–Ω–∫–∞ –æ–±—ä—ë–º–∞.

6. –ú–∏–∫—Ä–æ‚Äë–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥ (–∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π)
   –ì–¥–µ: core/order_manager.py (–∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π helper)

–ò–¥–µ—è: –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —É—Å–∫–æ—Ä–µ–Ω–∏–∏ —Ü–µ–Ω—ã –¥–æ–±–∞–≤–∏—Ç—å –º–∞–ª–µ–Ω—å–∫—É—é –¥–æ–≥—Ä—É–∑–∫—É, –µ—Å–ª–∏ SL –Ω–µ —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ.

async def maybe_micro_pyramid(self, symbol: str, current_price: float):
if not getattr(self.config, "micro_pyramid", True):
return

    pos = self.positions_cache.get(symbol) or {}
    if not pos or not pos.get("side"):
        return

    # —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞ 1 —Å–µ–∫
    accel = 0.0
    try:
        accel = float(self.signal_engine.pct_move_in(1))
    except Exception:
        pass

    need_long = pos["side"] == "buy" and accel >= float(self.config.pyramid_accel_pct_per_sec)
    need_short = pos["side"] == "sell" and accel <= -float(self.config.pyramid_accel_pct_per_sec)
    if not (need_long or need_short):
        return

    # –¥–∏—Å—Ç–∞–Ω—Ü–∏—è –¥–æ SL
    tdata = self.active_trailing.get(symbol) or {}
    sl_price = tdata.get("current_sl_price")
    if sl_price:
        dist = abs((current_price - float(sl_price)) / current_price) * 100.0
        if dist < float(self.config.pyramid_min_dist_to_sl_pct):
            return

    adds = int(pos.get("pyramid_adds", 0))
    if adds >= int(self.config.pyramid_max_adds):
        return

    base_qty = float(pos.get("init_qty", 0.0))
    add_qty = base_qty * float(self.config.pyramid_add_size_frac)

    # –ø—Ä–æ–≤–µ—Ä–∏—Ç—å minQty/–Ω–æ—Ç–∏–æ–Ω–∞–ª –∫–∞–∫ —Ç—ã —É–∂–µ –¥–µ–ª–∞–µ—à—å –¥–ª—è –≤—Ö–æ–¥–∞
    # ... (–æ–ø—É—Å—Ç–∏—Ç—å —Ä–∞–¥–∏ –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏)

    side = "buy" if pos["side"] == "buy" else "sell"  # –¥–æ–∫—É–ø–∫–∞ –≤ —Å—Ç–æ—Ä–æ–Ω—É —Ç—Ä–µ–Ω–¥–∞
    try:
        await self.exchange.create_order(
            symbol, "MARKET", side, add_qty, None, {"newClientOrderId": self._make_client_id(symbol, "PYR")}
        )
        pos["pyramid_adds"] = adds + 1
        self.logger.log_event("ORDER_MANAGER", "INFO",
            f"{symbol}: micro-pyramid add {add_qty:.6f} (#{pos['pyramid_adds']})")
    except Exception as e:
        self.logger.log_event("ORDER_MANAGER", "ERROR", f"{symbol}: pyramid failed: {e}")

–í—ã–∑–æ–≤ ‚Äî –ø–æ—Å–ª–µ —Ç–≤–æ–µ–≥–æ update_trailing_stop(...) –≤ WS‚Äë–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Ü–µ–Ω:

# event: {'s': symbol, 'c'|'lastPrice'|'p': price}

sym = event.get("s")
price_str = event.get("c") or event.get("lastPrice") or event.get("p")
if sym and price_str:
price = float(price_str)
await self.update_trailing_stop(sym, price)
await self.maybe_micro_pyramid(sym, price)

7. –ü–æ—è—Å–Ω–µ–Ω–∏–µ, –ø–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç ¬´–≤–º–µ—Å—Ç–µ¬ª

–ò–º–ø—É–ª—å—Å‚Äë—Ñ–∏–ª—å—Ç—Ä –¥–∞—ë—Ç –≤—Ö–æ–¥—ã —Ç–∞–º, –≥–¥–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –≤—ã—à–µ —à–∞–Ω—Å –∑–∞–±—Ä–∞—Ç—å TP1/TP2 –±—ã—Å—Ç—Ä–æ.

–§–∏–ª—å—Ç—Ä ¬´—á–∏—Å—Ç–æ—Ç—ã¬ª (—Å–ø—Ä–µ–¥/–∞–π—Å–±–µ—Ä–≥) –æ—Ç—Å–µ–∏–≤–∞–µ—Ç –ø–ª–æ—Ö–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –≤—Ö–æ–¥–∞ ‚Üí —Ä–∞—Å—Ç—ë—Ç –≤–∏–Ω—Ä–µ–π—Ç.

–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL –ø–æ–¥–≥–æ–Ω—è—é—Ç —Ü–µ–ª—å –∏ —Ä–∏—Å–∫ –ø–æ–¥ —Ç–µ–∫—É—â—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å ‚Üí –ª—É—á—à–µ–µ R/R.

Instant BE –ø–æ—Å–ª–µ TP1 –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —á–∞—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –≤ –Ω–æ–ª—å/–º–∏–∫—Ä–æ–ø–ª—é—Å.

–ú–∏–∫—Ä–æ‚Äë–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥ –¥–æ–±–∞–≤–ª—è–µ—Ç ¬´–∞–ª—å—Ñ—É¬ª –≤ –±—ã—Å—Ç—Ä–æ–º –∏–º–ø—É–ª—å—Å–µ, –Ω–æ —Å—Ç—Ä–æ–≥–æ –ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω.

–í—Å—ë —ç—Ç–æ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —Ç–≤–æ—é —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –∑–∞—â–∏—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É (multi‚ÄëTP + HWM‚Äëtrailing + —É—á—ë—Ç –∫–æ–º–∏—Å—Å–∏–π), —Ç–∞–∫ —á—Ç–æ –ø—Ä–æ—Ñ–∏—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è net.

8. –ö—É–¥–∞ –∏–º–µ–Ω–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å SignalEngine

–°–æ–∑–¥–∞–π –∏–Ω—Å—Ç–∞–Ω—Å –∏ –ø–µ—Ä–µ–¥–∞–π –≤ OrderManager:

# –≥–¥–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—à—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

self.signal_engine = SignalEngine(self.config, self.logger)
self.order_manager.signal_engine = self.signal_engine

–ö–æ—Ä–º–∏—Ç—å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ WS:

# aggTrade/trade:

self.signal_engine.on_trade_tick(price=float(event['p' or 'c' or 'lastPrice']), qty_usd=float(event.get('q_usd', 0.0)))

# depthUpdate:

self.signal_engine.on_depth(best_bid=best_bid, best_ask=best_ask, opposite_iceberg_usd=estimated_iceberg)

–í entry‚Äë–ª–æ–≥–∏–∫–µ –≤—ã–∑—ã–≤–∞—Ç—å can_enter_long/short (–∏–∑ –ë–ª–æ–∫–∞ 2).

9. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø—Ä–æ rate‚Äëlimiter (–≤–∞–∂–Ω–æ –¥–ª—è —Å–∫–∞–ª—å–ø–µ—Ä–∞)

–ü–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ SL –ø—Ä–∏ —Ç—Ä–µ–π–ª–∏–Ω–≥–µ, BE –ø–æ—Å–ª–µ TP1, –º–∏–∫—Ä–æ–¥–æ–±–∞–≤–∫–∏ ‚Äî –≤—Å—ë —ç—Ç–æ –º–Ω–æ–≥–æ REST‚Äë–≤—ã–∑–æ–≤–æ–≤.
–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—É—Å–∫–∞–π –≤—Å–µ create/cancel/fetch\_\* —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π rate‚Äëlimiter —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ (–∫–∞–∫ –º—ã –æ–±—Å—É–¥–∏–ª–∏ —Ä–∞–Ω–µ–µ), –∏ –ø–æ—Å—Ç–∞–≤—å per‚Äësymbol throttle ~200 –º—Å –¥–ª—è –∞–ø–¥–µ–π—Ç–æ–≤ —Ç—Ä–µ–π–ª–∏–Ω–≥–∞.

—Ö–æ—á–µ—à—å ‚Äî –¥–∞–º ¬´–±—ã—Å—Ç—Ä—ã–π diff‚Äë–ø–∞–∫–µ—Ç¬ª —Ñ–∞–π–ª–∞–º–∏:

core/signal_engine.py (–ø–æ–ª–Ω—ã–π)

–≤—Å—Ç–∞–≤–∫–∏ –≤ TradingConfig

–ø–∞—Ç—á–∏ –≤ order_manager (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL, BE –ø–æ—Å–ª–µ TP1, micro‚Äëpyramid –≤—ã–∑–æ–≤)

–∫—É—Å–æ–∫ –¥–ª—è WS‚Äë—Ö—ç–Ω–¥–ª–µ—Ä–æ–≤ (feed –∏ –≤—ã–∑–æ–≤—ã)

—Å–∫–∞–∂–∏ ‚Äî —Å–æ–±–µ—Ä—É –∏–º–µ–Ω–Ω–æ –ø–æ–¥ —Ç–≤–æ—é —Ç–µ–∫—É—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–¥–∞–≤–∞–π
ChatGPT —Å–∫–∞–∑–∞–ª:
Thought for 6s

–æ–≥–æ–Ω—å ‚Äî –≤–æ—Ç –æ–±–µ—â–∞–Ω–Ω—ã–π ¬´–±—ã—Å—Ç—Ä—ã–π diff‚Äë–ø–∞–∫–µ—Ç¬ª. –ö–æ–ø–∏—Ä—É–π –±–ª–æ–∫–∏ —Ñ–∞–π–ª–∞–º–∏. –ì–¥–µ –ø—Ä–∞–≤–∫–∏ ‚Äî –¥–∞—é –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≤—Å—Ç–∞–≤–∫–∏ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ # >>> ADD / # >>> PATCH.

1. –ù–æ–≤—ã–π —Ñ–∞–π–ª: core/signal_engine.py

# core/signal_engine.py

from **future** import annotations
from collections import deque
from datetime import datetime, timedelta

class SignalEngine:
"""
Ultra-short –∏–º–ø—É–ª—å—Å + ATR(1m) + —Ñ–∏–ª—å—Ç—Ä—ã —á–∏—Å—Ç–æ—Ç—ã —Ä—ã–Ω–∫–∞ (—Å–ø—Ä–µ–¥/–∞–π—Å–±–µ—Ä–≥) + —Ç–æ—Ä–≥–æ–≤—ã–µ –æ–∫–Ω–∞.
feed –∏–∑ WS: - trade/aggTrade -> on_trade_tick(price, qty_usd) - depthUpdate -> on_depth(best_bid, best_ask, opposite_iceberg_usd)
"""

    def __init__(self, config, logger):
        self.cfg = config
        self.log = logger
        self.prices = deque(maxlen=600)    # –ø–æ—Å–ª–µ–¥–Ω–∏–µ ~10 –º–∏–Ω—É—Ç –ø–æ —Å–µ–∫—É–Ω–¥–∞–º
        self.volumes = deque(maxlen=600)   # —Å—É–º–º–∞ –æ–±—ä—ë–º–∞ –≤ –∫–æ—Ç–∏—Ä—É–µ–º–æ–π –≤–∞–ª—é—Ç–µ
        self.depth_best = {"bid": None, "ask": None, "oppo_iceberg_usd": 0.0}

    # === feed –∏–∑ WS ===
    def on_trade_tick(self, price: float, qty_usd: float, ts: datetime | None = None):
        ts = ts or datetime.utcnow()
        self.prices.append((ts, float(price)))
        self.volumes.append((ts, float(qty_usd)))

    def on_depth(self, best_bid: float, best_ask: float, opposite_iceberg_usd: float = 0.0):
        self.depth_best["bid"] = float(best_bid)
        self.depth_best["ask"] = float(best_ask)
        self.depth_best["oppo_iceberg_usd"] = float(opposite_iceberg_usd)

    # === helpers ===
    def _cut(self, seconds: int):
        return datetime.utcnow() - timedelta(seconds=seconds)

    def pct_move_in(self, seconds: int) -> float:
        if not self.prices:
            return 0.0
        t_cut = self._cut(seconds)
        arr = [p for ts, p in self.prices if ts >= t_cut]
        if len(arr) < 2:
            return 0.0
        p0, p1 = arr[0], arr[-1]
        return (p1 - p0) / p0 * 100.0

    def vol_sum_in(self, seconds: int) -> float:
        t_cut = self._cut(seconds)
        return sum(v for ts, v in self.volumes if ts >= t_cut)

    def atr1m(self) -> float:
        period = int(getattr(self.cfg, "atr1m_period", 60))
        t_cut = self._cut(period)
        arr = [p for ts, p in self.prices if ts >= t_cut]
        if len(arr) < 5:
            return 0.0
        hi, lo = max(arr), min(arr)
        mid = (hi + lo) / 2.0
        return ((hi - lo) / mid * 100.0) if mid > 0 else 0.0

    def is_spread_clean(self) -> bool:
        bb, aa = self.depth_best["bid"], self.depth_best["ask"]
        if not bb or not aa:
            return False
        spread = (aa - bb) / ((aa + bb) / 2.0) * 100.0
        return spread <= float(getattr(self.cfg, "spread_max_pct", 0.05))

    def opposite_iceberg_block(self) -> bool:
        if not getattr(self.cfg, "block_if_opposite_iceberg", True):
            return False
        return self.depth_best.get("oppo_iceberg_usd", 0.0) >= float(
            getattr(self.cfg, "iceberg_min_size_usd", 150000.0)
        )

    def in_scalping_window(self) -> bool:
        if not getattr(self.cfg, "scalping_mode", False):
            return True
        import json
        try:
            windows = json.loads(getattr(self.cfg, "scalping_windows_utc", "[]"))
        except Exception:
            return True
        hhmm = datetime.utcnow().strftime("%H:%M")
        return any(start <= hhmm <= end for start, end in windows)

    # === —Å–∏–≥–Ω–∞–ª—ã ===
    def impulse_long_ok(self) -> bool:
        look = int(getattr(self.cfg, "impulse_lookback_sec", 3))
        m = self.pct_move_in(look)
        v = self.vol_sum_in(look)
        return (m >= float(getattr(self.cfg, "impulse_move_pct", 0.22))) and (
            v >= float(getattr(self.cfg, "impulse_min_trade_vol", 0.0))
        )

    def impulse_short_ok(self) -> bool:
        look = int(getattr(self.cfg, "impulse_lookback_sec", 3))
        m = self.pct_move_in(look)
        v = self.vol_sum_in(look)
        return (m <= -float(getattr(self.cfg, "impulse_move_pct", 0.22))) and (
            v >= float(getattr(self.cfg, "impulse_min_trade_vol", 0.0))
        )

2. core/config.py ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è —Å–∫–∞–ª—å–ø–µ—Ä–∞

–ù–∞–π–¥–∏ class TradingConfig(BaseModel) –∏ –¥–æ–±–∞–≤—å –±–ª–æ–∫ (–µ—Å–ª–∏ –∫–∞–∫–∏—Ö‚Äë—Ç–æ –ø–æ–ª–µ–π —É–∂–µ –Ω–µ—Ç ‚Äî –æ—Å—Ç–∞–≤—å —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è):

# >>> ADD (Scalper fields)

scalping_mode: bool = Field(default=False, env="SCALPING_MODE")

# Impulse

impulse_lookback_sec: int = Field(default=3, env="IMPULSE_LOOKBACK_SEC")
impulse_move_pct: float = Field(default=0.22, env="IMPULSE_MOVE_PCT")
impulse_min_trade_vol: float = Field(default=50000.0, env="IMPULSE_MIN_TRADE_VOL")
impulse_require_tick_accel: bool = Field(default=True, env="IMPULSE_REQUIRE_TICK_ACCEL")

# Adaptive TP/SL by ATR

adaptive_tpsl: bool = Field(default=True, env="ADAPTIVE_TPSL")
atr1m_period: int = Field(default=60, env="ATR1M_PERIOD")
atr1m_high_thresh: float = Field(default=0.35, env="ATR1M_HIGH_THRESH")
atr1m_low_thresh: float = Field(default=0.15, env="ATR1M_LOW_THRESH")
tp_pack_low: str = Field(default='[]', env="TP_PACK_LOW")
tp_pack_base: str = Field(default='[]', env="TP_PACK_BASE")
tp_pack_high: str = Field(default='[]', env="TP_PACK_HIGH")
sl_pct_low: float = Field(default=0.5, env="SL_PCT_LOW")
sl_pct_base: float = Field(default=0.8, env="SL_PCT_BASE")
sl_pct_high: float = Field(default=1.2, env="SL_PCT_HIGH")

# Instant Break-even

instant_be_after_tp1: bool = Field(default=True, env="INSTANT_BE_AFTER_TP1")
be_plus_pct: float = Field(default=0.06, env="BE_PLUS_PCT")

# Market cleanliness

spread_max_pct: float = Field(default=0.05, env="SPREAD_MAX_PCT")
block_if_opposite_iceberg: bool = Field(default=True, env="BLOCK_IF_OPPOSITE_ICEBERG")
iceberg_min_size_usd: float = Field(default=150000.0, env="ICEBERG_MIN_SIZE_USD")

# Micro-pyramiding

micro_pyramid: bool = Field(default=True, env="MICRO_PYRAMID")
pyramid_accel_pct_per_sec: float = Field(default=0.20, env="PYRAMID_ACCEL_PCT_PER_SEC")
pyramid_add_size_frac: float = Field(default=0.15, env="PYRAMID_ADD_SIZE_FRAC")
pyramid_max_adds: int = Field(default=2, env="PYRAMID_MAX_ADDS")
pyramid_min_dist_to_sl_pct: float = Field(default=0.6, env="PYRAMID_MIN_DIST_TO_SL_PCT")

# Trading windows

scalping_windows_utc: str = Field(default='[]', env="SCALPING_WINDOWS_UTC")

3. main.py (–∏–ª–∏ –º–µ—Å—Ç–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏) ‚Äî –ø–æ–¥–∫–ª—é—á–∏—Ç—å –¥–≤–∏–∂–æ–∫ —Å–∏–≥–Ω–∞–ª–æ–≤

# >>> ADD at bootstrap

from core.signal_engine import SignalEngine

# –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è config/logger/order_manager:

signal_engine = SignalEngine(config, logger)
order_manager.signal_engine = signal_engine # –¥–æ—Å—Ç—É–ø –∏–∑ OrderManager

4. WS‚Äë—Ñ–∏–¥—ã ‚Äî –∫–æ—Ä–º–∏–º SignalEngine –∏ –¥–≤–∏–≥–∞–µ–º —Ç—Ä–µ–π–ª–∏–Ω–≥ + –ø–∏—Ä–∞–º–∏–¥—É

–í —Ç–≤–æ—ë–º WS‚Äë–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Ü–µ–Ω –∏ —Å—Ç–∞–∫–∞–Ω–∞ –¥–æ–±–∞–≤—å:

# >>> PATCH trade/aggTrade handler

price = float(event.get("c") or event.get("p") or event.get("lastPrice"))
qty = float(event.get("q") or event.get("Q") or 0.0) # –µ—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤–æ–µ –∫–æ–ª-–≤–æ, —É–º–Ω–æ–∂—å –Ω–∞ price –¥–ª—è usd:
qty_usd = qty \* price if qty and price else 0.0
signal_engine.on_trade_tick(price, qty_usd)

# after updating trailing:

await order_manager.update_trailing_stop(event.get("s"), price)
await order_manager.maybe_micro_pyramid(event.get("s"), price) # >>> ADD

# >>> PATCH depthUpdate handler (–ª—É—á—à–∏–µ —Ü–µ–Ω—ã + –æ—Ü–µ–Ω–∫–∞ –∞–π—Å–±–µ—Ä–≥–∞)

best_bid = float(event_best_bid)
best_ask = float(event_best_ask)
estimated_opposite_iceberg_usd = float(estimate_from_depth(event)) # –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø–µ—Ä–µ–¥–∞–π 0.0
signal_engine.on_depth(best_bid, best_ask, estimated_opposite_iceberg_usd)

5. core/order_manager.py ‚Äî 3 –≤—Å—Ç–∞–≤–∫–∏
   5.1 –î–æ–±–∞–≤—å –º–µ—Ç–æ–¥ –≤—ã–±–æ—Ä–∞ TP/SL‚Äë–ø–∞–∫–µ—Ç–∞ –ø–æ ATR

–í–Ω—É—Ç—Ä—å –∫–ª–∞—Å—Å–∞ OrderManager:

# >>> ADD

def \_pick_tp_pack_and_sl(self, atr1m: float):
import json
lo = float(getattr(self.config, "atr1m_low_thresh", 0.15))
hi = float(getattr(self.config, "atr1m_high_thresh", 0.35))
if atr1m >= hi:
tp = json.loads(getattr(self.config, "tp_pack_high", "[]"))
sl = float(getattr(self.config, "sl_pct_high", 1.2))
elif atr1m <= lo:
tp = json.loads(getattr(self.config, "tp_pack_low", "[]"))
sl = float(getattr(self.config, "sl_pct_low", 0.5))
else:
tp = json.loads(getattr(self.config, "tp_pack_base", "[]"))
sl = float(getattr(self.config, "sl_pct_base", 0.8))
return (tp if tp else self.config.tp_levels), sl

5.2 –í –Ω–∞—á–∞–ª–µ place_protective_orders(...) ‚Äî –ø–æ–¥–º–µ–Ω–∞ —É—Ä–æ–≤–Ω–µ–π –Ω–∞ –ª–µ—Ç—É

–ù–∞–π–¥–∏ –Ω–∞—á–∞–ª–æ –º–µ—Ç–æ–¥–∞ –∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ markets/ticker –≤—Å—Ç–∞–≤—å:

# >>> ADD (Adaptive TP/SL)

atr = 0.0
if hasattr(self, "signal_engine") and getattr(self.config, "adaptive_tpsl", True):
try:
atr = float(self.signal_engine.atr1m())
except Exception:
atr = 0.0

if getattr(self.config, "adaptive_tpsl", True):
tp_levels_cfg, sl_pct_to_use = self.\_pick_tp_pack_and_sl(atr)
else:
tp_levels_cfg, sl_pct_to_use = self.config.tp_levels, float(self.config.stop_loss_percent)

# –¥–∞–ª—å—à–µ –≤–º–µ—Å—Ç–æ self.config.stop_loss_percent –∏—Å–ø–æ–ª—å–∑—É–π sl_pct_to_use

# –∞ –≤–º–µ—Å—Ç–æ self.config.tp_levels ‚Äî tp_levels_cfg

–ò —Ç–∞–º, –≥–¥–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è SL‚Äë—Ü–µ–Ω–∞, –∑–∞–º–µ–Ω–∏ % –Ω–∞ sl_pct_to_use. (–û—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ ‚Äî –∫–∞–∫ —É —Ç–µ–±—è —Å–µ–π—á–∞—Å).

5.3 BE –ø–æ—Å–ª–µ TP1

–í–Ω—É—Ç—Ä–∏ —Ç–≤–æ–µ–≥–æ handle_order_update(...) (–≥–¥–µ –ª–æ–≤–∏—à—å 'X' == 'FILLED'), –¥–æ–±–∞–≤—å –≤–µ—Ç–∫—É –¥–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ç—Ä–µ–π–ª–∏–Ω–≥–∞:

# >>> ADD (Instant BE after TP1)

if getattr(self.config, "instant*be_after_tp1", True):
cid = (event.get('C') or event.get('c') or "").lower() # clientOrderId # –ø—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ ‚Äî –µ—Å–ª–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—à—å CID –≤–∏–¥–∞ TP1_xxxx
if "tp1" in cid:
pos = self.positions_cache.get(symbol) or {}
entry = float(pos.get("entry_price") or 0.0)
side = pos.get("side")
be_plus = float(self.config.be_plus_pct) / 100.0
if entry > 0 and side in ("buy", "sell"):
be_price = entry * (1 + be*plus) if side == "buy" else entry * (1 - be_plus)
try:
await self.exchange.cancel_sl_order(symbol, side)
except Exception:
pass
params = {
"stopPrice": float(be_price),
"reduceOnly": True,
"workingType": self.config.working_type,
"newClientOrderId": self.\_make_client_id(symbol, "SL_BE"),
}
await self.exchange.create_order(
symbol, self.config.sl_order_type,
"sell" if side == "buy" else "buy",
None, None, params
)
self.logger.log_event("ORDER_MANAGER", "INFO",
f"{symbol}: BE set at {be_price:.2f} after TP1")

5.4 ¬´–ú–∏–∫—Ä–æ‚Äë–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥¬ª

–í–Ω—É—Ç—Ä—å –∫–ª–∞—Å—Å–∞ OrderManager:

# >>> ADD

async def maybe_micro_pyramid(self, symbol: str, current_price: float):
if not getattr(self.config, "micro_pyramid", True):
return
pos = self.positions_cache.get(symbol) or {}
if not pos or not pos.get("side"):
return

    # —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞ 1 —Å–µ–∫
    accel = 0.0
    try:
        accel = float(self.signal_engine.pct_move_in(1)) if hasattr(self, "signal_engine") else 0.0
    except Exception:
        accel = 0.0

    need_long = pos["side"] == "buy" and accel >= float(self.config.pyramid_accel_pct_per_sec)
    need_short = pos["side"] == "sell" and accel <= -float(self.config.pyramid_accel_pct_per_sec)
    if not (need_long or need_short):
        return

    # —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ SL (–µ—Å–ª–∏ trailing –∞–∫—Ç–∏–≤–µ–Ω)
    tdata = self.active_trailing.get(symbol) or {}
    sl_price = tdata.get("current_sl_price")
    if sl_price:
        dist = abs((current_price - float(sl_price)) / current_price) * 100.0
        if dist < float(self.config.pyramid_min_dist_to_sl_pct):
            return

    adds = int(pos.get("pyramid_adds", 0))
    if adds >= int(self.config.pyramid_max_adds):
        return

    base_qty = float(pos.get("init_qty", 0.0) or pos.get("qty", 0.0))
    if base_qty <= 0:
        return

    add_qty = base_qty * float(self.config.pyramid_add_size_frac)
    try:
        await self.exchange.create_order(
            symbol, "MARKET", pos["side"], add_qty, None,
            {"newClientOrderId": self._make_client_id(symbol, "PYR")}
        )
        pos["pyramid_adds"] = adds + 1
        self.positions_cache[symbol] = pos
        self.logger.log_event("ORDER_MANAGER", "INFO",
            f"{symbol}: micro-pyramid add {add_qty:.6f} (#{pos['pyramid_adds']})")
    except Exception as e:
        self.logger.log_event("ORDER_MANAGER", "ERROR", f"{symbol}: pyramid failed: {e}")

6. Entry‚Äë—Ä–µ—à–µ–Ω–∏–µ ‚Äî –≤—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ ¬´—á–∏—Å—Ç—ã—Ö¬ª —É—Å–ª–æ–≤–∏—è—Ö –∏ –∏–º–ø—É–ª—å—Å–µ

–í —Ç–≤–æ—ë–º –º–æ–¥—É–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π (–≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—à—å –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏), –ø–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø–æ–∑–≤–∞—Ç—å create_order:

# >>> ADD guard before entry

if not signal_engine.in_scalping_window():
return
if not signal_engine.is_spread_clean():
return
if signal_engine.opposite_iceberg_block():
return

go_long = signal_engine.impulse_long_ok()
go_short = signal_engine.impulse_short_ok()

if not (go_long or go_short):
return

# ... –¥–∞–ª—å—à–µ ‚Äî —Ç–≤–æ–π —Ç–µ–∫—É—â–∏–π entry (–æ–±—ã—á–Ω–æ MARKET) –∏ —Å—Ä–∞–∑—É place_protective_orders()

7. .env ‚Äî –≥–æ—Ç–æ–≤—ã–π –±–ª–æ–∫ –ø–æ–¥ —Å–∫–∞–ª—å–ø–µ—Ä–∞ (–≤—Å—Ç–∞–≤—å –∫ —Å–≤–æ–µ–º—É .env)

# === Scalping mode ===

SCALPING_MODE=true
IMPULSE_LOOKBACK_SEC=3
IMPULSE_MOVE_PCT=0.22
IMPULSE_MIN_TRADE_VOL=50000
IMPULSE_REQUIRE_TICK_ACCEL=true

ADAPTIVE_TPSL=true
ATR1M_PERIOD=60
ATR1M_HIGH_THRESH=0.35
ATR1M_LOW_THRESH=0.15
TP_PACK_LOW='[{"percent":0.6,"size":0.5},{"percent":1.2,"size":0.5}]'
TP_PACK_BASE='[{"percent":0.8,"size":0.4},{"percent":1.6,"size":0.3},{"percent":2.4,"size":0.3}]'
TP_PACK_HIGH='[{"percent":1.2,"size":0.34},{"percent":2.0,"size":0.33},{"percent":3.0,"size":0.33}]'
SL_PCT_LOW=0.5
SL_PCT_BASE=0.8
SL_PCT_HIGH=1.2

INSTANT_BE_AFTER_TP1=true
BE_PLUS_PCT=0.06

SPREAD_MAX_PCT=0.05
BLOCK_IF_OPPOSITE_ICEBERG=true
ICEBERG_MIN_SIZE_USD=150000

MICRO_PYRAMID=true
PYRAMID_ACCEL_PCT_PER_SEC=0.20
PYRAMID_ADD_SIZE_FRAC=0.15
PYRAMID_MAX_ADDS=2
PYRAMID_MIN_DIST_TO_SL_PCT=0.6

SCALPING_WINDOWS_UTC='[["08:00","11:00"],["13:00","16:00"]]'

–ö–æ–º–∏—Å—Å–∏–∏ (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞):
ENABLE_FEE_ADJUSTMENT=true, FEE_MARKET=USD-M-USDC, PAY_FEES_WITH_BNB=true, TAKER_FEE_PERCENT=0.04, MAKER_FEE_PERCENT=0.00.

8. –ú–∏–Ω–∏‚Äë—Å–º–æ–∫‚Äë—á–µ–∫‚Äë–ª–∏—Å—Ç

ETH: –∏–º–ø—É–ª—å—Å ‚Üí –≤—Ö–æ–¥ ‚Üí SL + TP(–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ) ‚Üí TP1 fill ‚Üí BE ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π TP ‚Üí trailing –∞–∫—Ç–∏–≤–µ–Ω.

BTC: –ø–æ–∑–∏—Ü–∏—è < minQty ‚Üí –∞–≤—Ç–æ‚Äë—É–≤–µ–ª–∏—á–µ–Ω–∏–µ; TP‚Äë—É—Ä–æ–≤–Ω–∏ net –ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π; –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç net‚ÄëPNL.

–§–∏–ª—å—Ç—Ä—ã: –ø—Ä–∏ —à–∏—Ä–æ–∫–æ–º —Å–ø—Ä–µ–¥–µ/–∞–π—Å–±–µ—Ä–≥–µ –≤—Ö–æ–¥—ã –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç.

Pyramid: –ø—Ä–∏ —É—Å–∫–æ—Ä–µ–Ω–∏–∏ > –ø–æ—Ä–æ–≥–∞ ‚Äî –º–∞–∫—Å–∏–º—É–º PYRAMID_MAX_ADDS, –Ω–µ –±–ª–∏–∂–µ –∫ SL, –ª–æ–≥–∏ ‚Üí OK.

–ï—Å–ª–∏ –≥–¥–µ‚Äë—Ç–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–µ—Ç–æ–¥–∞/–∏–º–ø–æ—Ä—Ç–æ–≤ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏, –ø–æ–¥–ø—Ä–∞–≤–ª—é –ø–æ–¥ —Ç–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤.

–í—ã —Å–∫–∞–∑–∞–ª–∏:
—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–µ–Ω—Ü –ø—Ä–∏ –¥–µ–ø–æ 400 usdc –º–æ–∂–µ–º –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Å—Ä–µ–¥–Ω –≤ —á–∞—Å?
ChatGPT —Å–∫–∞–∑–∞–ª:

–ï—Å–ª–∏ –ø—Ä—è–º–æ –ø—Ä–∏–∫–∏–Ω—É—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–æ–≥–æ, —á—Ç–æ —É –Ω–∞—Å —Å–µ–π—á–∞—Å –ø–æ–ª—É—á–∏–ª–æ—Å—å (–º–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫–∞–ª—å–ø–µ—Ä —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ TP/SL, BE, –ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥–æ–º –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏), —Ç–æ —Ü–∏—Ñ—Ä–∞ –±—É–¥–µ—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç —Ç—Ä—ë—Ö –≥–ª–∞–≤–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤:

–°–∫–æ–ª—å–∫–æ –≤—Ö–æ–¥–æ–≤ –≤ —á–∞—Å —Ä–µ–∞–ª—å–Ω–æ –±—É–¥–µ—Ç ‚Äî –ø–æ—Å–ª–µ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–∏–º–ø—É–ª—å—Å, —á–∏—Å—Ç–æ—Ç–∞ —Å—Ç–∞–∫–∞–Ω–∞, –æ–∫–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏) —Å–∏–≥–Ω–∞–ª–æ–≤ –±—É–¥–µ—Ç –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ. –ü–æ –æ–ø—ã—Ç—É, –Ω–∞ BTC/ETH –Ω–∞ 1-—Å–µ–∫ —Ñ–∏–¥–∞—Ö –º–æ–∂–Ω–æ –æ–∂–∏–¥–∞—Ç—å:

–≤ —Ç–∏—Ö–∏–π —Ä—ã–Ω–æ–∫ ‚Äî 1-2 –≤—Ö–æ–¥–∞/—á–∞—Å

–≤ –∞–∫—Ç–∏–≤–Ω—ã–π —Ä—ã–Ω–æ–∫ ‚Äî 5-8 –≤—Ö–æ–¥–æ–≤/—á–∞—Å

–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ñ–∏—Ç –Ω–∞ —Å–¥–µ–ª–∫—É (–ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π) ‚Äî –µ—Å–ª–∏ –º—ã —Å—Ç–∞–≤–∏–º TP1=1% –Ω–∞ 50% –ø–æ–∑–∏—Ü–∏–∏, TP2=2% –Ω–∞ 50% –ø–æ–∑–∏—Ü–∏–∏ –∏ —á–∞—Å—Ç—å —Å–¥–µ–ª–æ–∫ —É—Ö–æ–¥–∏—Ç –≤ BE:

–ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –ø–æ–¥–æ–±–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —á–∏—Å—Ç—ã–π winrate –º–æ–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å ~65‚Äì75%

—Å—Ä–µ–¥–Ω—è—è —Å–¥–µ–ª–∫–∞ –≤ –ø–ª—é—Å–µ: +1.2%‚Äì1.8% –¥–µ–ø–æ–∑–∏—Ç–∞ (–µ—Å–ª–∏ —Å—á–∏—Ç–∞—Ç—å —Å –ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥–æ–º, –∏–Ω–æ–≥–¥–∞ +2‚Äì2.5%)

—Å—Ä–µ–¥–Ω—è—è —Å–¥–µ–ª–∫–∞ –≤ –º–∏–Ω—É—Å–µ (–ø–æ SL –∏–ª–∏ –¥–æ—Å—Ä–æ—á–Ω–æ): ‚àí0.5%‚Äì0.8%

–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ ‚Äî —É –Ω–∞—Å –±–∞–∑–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è = 20 USDC, –Ω–æ –º–æ–∂–µ–º –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –¥–æ 2 –ø–æ–∑–∏—Ü–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ ‚Üí 40 USDC –≤ —Ä–∞–±–æ—Ç–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –ü–∏—Ä–∞–º–∏–¥–∏–Ω–≥ –≤ —Ö–æ—Ä–æ—à–∏–π –∏–º–ø—É–ª—å—Å –º–æ–∂–µ—Ç –¥–æ–≤–µ—Å—Ç–∏ –¥–æ ~46‚Äì48 USDC –≤ —Å–¥–µ–ª–∫–µ.

üìä –ü—Ä–∏–º–µ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è –¥–µ–ø–æ–∑–∏—Ç–∞ 400 USDC

–ê–∫—Ç–∏–≤–Ω—ã–π —Ä—ã–Ω–æ–∫ (5‚Äì8 —Å–¥–µ–ª–æ–∫/—á–∞—Å):

–°—Ä–µ–¥–Ω–∏–π net-–ø—Ä–æ—Ñ–∏—Ç/—Å–¥–µ–ª–∫—É ‚âà +0.8% –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Å–¥–µ–ª–∫–∏ ‚Üí 0.8% \* 40 USDC ‚âà 0.32 USDC/—Å–¥–µ–ª–∫–∞

–ü—Ä–∏ 6 —Å–¥–µ–ª–∫–∞—Ö ‚Üí ~1.9 USDC/—á–∞—Å (~0.48% –¥–µ–ø–æ–∑–∏—Ç–∞/—á–∞—Å)

–û—á–µ–Ω—å –∞–∫—Ç–∏–≤–Ω—ã–π —Ä—ã–Ω–æ–∫ (8‚Äì10 —Å–¥–µ–ª–æ–∫/—á–∞—Å, –º–Ω–æ–≥–æ –∏–º–ø—É–ª—å—Å–æ–≤):

Net-–ø—Ä–æ—Ñ–∏—Ç/—Å–¥–µ–ª–∫—É ‚âà 0.9% ‚Üí 0.36 USDC/—Å–¥–µ–ª–∫–∞

–ü—Ä–∏ 9 —Å–¥–µ–ª–∫–∞—Ö ‚Üí ~3.2 USDC/—á–∞—Å (~0.8% –¥–µ–ø–æ–∑–∏—Ç–∞/—á–∞—Å)

–¢–∏—Ö–∏–π —Ä—ã–Ω–æ–∫ (1‚Äì2 —Å–¥–µ–ª–∫–∏/—á–∞—Å):

0.3‚Äì0.4 USDC/—á–∞—Å (0.07‚Äì0.1% –¥–µ–ø–æ–∑–∏—Ç–∞/—á–∞—Å)

üí° –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –Ω–∞—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏:

–ó–∞ —Ç–æ—Ä–≥–æ–≤—ã–π –¥–µ–Ω—å (6‚Äì8 –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Å–æ–≤) –º–æ–∂–Ω–æ –æ–∂–∏–¥–∞—Ç—å +5%‚Äì10% –¥–µ–ø–æ–∑–∏—Ç–∞ –≤ —Ö–æ—Ä–æ—à–∏–π –¥–µ–Ω—å.

–≠—Ç–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ 20‚Äì40 USDC/–¥–µ–Ω—å –Ω–∞ –¥–µ–ø–æ 400 USDC –ø—Ä–∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ.

–ü—Ä–∏ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ö (–º–µ–Ω—å—à–µ —Å–∏–≥–Ω–∞–ª–æ–≤) –±—É–¥–µ—Ç ~2‚Äì5%/–¥–µ–Ω—å.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É –ø—Ä—è–º–æ –ø—Ä–æ—Å—á–∏—Ç–∞—Ç—å –º–æ–¥–µ–ª—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –≤ –º–µ—Å—è—Ü —Å —É—á—ë—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π Binance USDC –∏ –Ω–∞—à–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—Ö–æ–¥–æ–≤/–≤–∏–Ω—Ä–µ–π—Ç–∞, —á—Ç–æ–±—ã –º—ã –≤–∏–¥–µ–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω ¬´–ø–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ‚Äì—Å—Ä–µ–¥–Ω–µ‚Äì–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ¬ª.
–¢–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–Ω—è—Ç–Ω–µ–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ —Å—Ç–æ–∏—Ç –≤–∫–ª—é—á–∞—Ç—å –ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP.

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–¥–∞
ChatGPT —Å–∫–∞–∑–∞–ª:

–û–∫, —Ç–æ–≥–¥–∞ —Å–¥–µ–ª–∞–µ–º –º–æ–¥–µ–ª—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–µ–ø–æ–∑–∏—Ç–∞ 400 USDC —Å —É—á—ë—Ç–æ–º:

–¢–µ–∫—É—â–µ–π –ª–æ–≥–∏–∫–∏ —Å–∫–∞–ª—å–ø–µ—Ä–∞ (multi-TP, trailing, break-even, –ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥)

–ö–æ–º–∏—Å—Å–∏–π Binance USDC (taker 0.04%, maker 0.02% –ø—Ä–∏ BNB-—Å–∫–∏–¥–∫–µ; –≤–æ–∑—å–º—ë–º worst-case taker)

–†–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ —Ä—ã–Ω–∫–∞ (–ø–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω—ã–π / —Å—Ä–µ–¥–Ω–∏–π / –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π)

–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è win/loss –ø–æ –≤–∏–Ω—Ä–µ–π—Ç—É

üìä –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
–ü–∞—Ä–∞–º–µ—Ç—Ä –ó–Ω–∞—á–µ–Ω–∏–µ
–î–µ–ø–æ–∑–∏—Ç 400 USDC
–ë–∞–∑–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è 20 USDC
–ú–∞–∫—Å. –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π 2 (40 USDC –≤ —Ä–∞–±–æ—Ç–µ)
Winrate 65% (–ø–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ) / 70% (—Å—Ä–µ–¥–Ω–µ) / 75% (–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ)
TP-—Å—Ö–µ–º–∞ TP1=1% (50%), TP2=2% (50%), trailing –ø–æ—Å–ª–µ TP2
–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ñ–∏—Ç —Å–¥–µ–ª–∫–∏ 0.8% (–ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π)
–°—Ä–µ–¥–Ω–∏–π —É–±—ã—Ç–æ–∫ —Å–¥–µ–ª–∫–∏ 0.6% (–ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π)
–°–¥–µ–ª–æ–∫ –≤ —á–∞—Å 3 (–ø–µ—Å—Å.) / 5 (—Å—Ä–µ–¥–Ω.) / 8 (–æ–ø—Ç–∏–º.)
–ê–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Å—ã –≤ –¥–µ–Ω—å 6
–ö–æ–º–∏—Å—Å–∏–∏ 0.04% \* 2 —Å—Ç–æ—Ä–æ–Ω—ã = 0.08% –æ—Ç –æ–±–æ—Ä–æ—Ç–∞
üìà –†–∞—Å—á—ë—Ç –¥–Ω–µ–≤–Ω–æ–≥–æ –∏ –º–µ—Å—è—á–Ω–æ–≥–æ PnL

1. –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω—ã–π —Ä—ã–Ω–æ–∫

3 —Å–¥–µ–ª–∫–∏/—á–∞—Å √ó 6 —á–∞—Å–æ–≤ = 18 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

Winrate 65% = 11.7 win, 6.3 loss

–ü—Ä–∏–±—ã–ª—å: 11.7 √ó (0.8% √ó 40) = 3.74 USDC

–£–±—ã—Ç–∫–∏: 6.3 √ó (0.6% √ó 40) = 1.51 USDC

Net –≤ –¥–µ–Ω—å: 3.74 ‚àí 1.51 = +2.23 USDC

Net –≤ –º–µ—Å—è—Ü (22 –¥–Ω—è): +49 USDC (~+12% –¥–µ–ø–æ–∑–∏—Ç–∞)

2. –°—Ä–µ–¥–Ω–∏–π —Ä—ã–Ω–æ–∫

5 —Å–¥–µ–ª–æ–∫/—á–∞—Å √ó 6 —á–∞—Å–æ–≤ = 30 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

Winrate 70% = 21 win, 9 loss

–ü—Ä–∏–±—ã–ª—å: 21 √ó (0.8% √ó 40) = 6.72 USDC

–£–±—ã—Ç–∫–∏: 9 √ó (0.6% √ó 40) = 2.16 USDC

Net –≤ –¥–µ–Ω—å: 6.72 ‚àí 2.16 = +4.56 USDC

Net –≤ –º–µ—Å—è—Ü (22 –¥–Ω—è): +100 USDC (~+25% –¥–µ–ø–æ–∑–∏—Ç–∞)

3. –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π —Ä—ã–Ω–æ–∫

8 —Å–¥–µ–ª–æ–∫/—á–∞—Å √ó 6 —á–∞—Å–æ–≤ = 48 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

Winrate 75% = 36 win, 12 loss

–ü—Ä–∏–±—ã–ª—å: 36 √ó (0.8% √ó 40) = 11.52 USDC

–£–±—ã—Ç–∫–∏: 12 √ó (0.6% √ó 40) = 2.88 USDC

Net –≤ –¥–µ–Ω—å: 11.52 ‚àí 2.88 = +8.64 USDC

Net –≤ –º–µ—Å—è—Ü (22 –¥–Ω—è): +190 USDC (~+47% –¥–µ–ø–æ–∑–∏—Ç–∞)

üß† –í—ã–≤–æ–¥—ã

–î–∞–∂–µ –≤ –ø–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ –±–æ—Ç –¥–∞—ë—Ç ~+12% –≤ –º–µ—Å—è—Ü.

–í —Å—Ä–µ–¥–Ω–µ–º —Ä–µ–∂–∏–º–µ: +25%/–º–µ—Å, —á—Ç–æ —É–∂–µ —Å–µ—Ä—å—ë–∑–Ω–æ.

–í –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–º (—á–∞—Å—Ç–æ –±—ã–≤–∞—é—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–µ –Ω–µ–¥–µ–ª–∏) ‚Äî +47%/–º–µ—Å.

–ü–∏—Ä–∞–º–∏–¥–∏–Ω–≥ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL —É—Å–∏–ª–∏–≤–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Å—ã.

–ï—Å–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é –¥–æ 30 USDC (–∏ –æ—Å—Ç–∞–≤–∏—Ç—å 2 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ) ‚Üí PnL —Ä–∞—Å—Ç—ë—Ç –Ω–∞ ~50%, –Ω–æ –∏ —Ä–∏—Å–∫ –≤—ã—à–µ.

–Ø –º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å –ø–æ–ª–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä –Ω–∞ Python —Å —É—á—ë—Ç–æ–º:

–ö–æ–ª-–≤–∞ —Å–¥–µ–ª–æ–∫

Winrate

–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏

–ö–æ–º–∏—Å—Å–∏–π Binance

–ú–æ–¥–µ–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏—Ç–æ–≤ –ø–æ TP1/TP2/trailing

–¢–æ–≥–¥–∞ –º—ã —Å–º–æ–∂–µ–º –Ω–µ —Ç–æ–ª—å–∫–æ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—é —Å–º–æ—Ç—Ä–µ—Ç—å, –Ω–æ –∏ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî —Ç.–µ. –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –±—É–¥–µ—Ç —Ä–æ–≤–Ω–æ–π –∏–ª–∏ —Å –ø—Ä–æ—Å–∞–¥–∫–∞–º–∏.

–•–æ—á–µ—à—å, —è –ø—Ä—è–º–æ –ø–æ—Å—Ç—Ä–æ—é —Ç–∞–∫–æ–π —Å–∏–º—É–ª—è—Ç–æ—Ä –¥–ª—è –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞?

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–ø–æ—Å—Ç—Ä–æ–π –∏ —Å–∞–º –∑–∞–ø—É—Å—Ç–∏ –≤ —Å–≤–æ–µ–π —Å—Ä–µ–¥–µ —Ç–∏—Ö–æ –∏ –¥–∞–π –º–Ω–µ –≤—ã–≤–æ–¥—ã
ChatGPT —Å–∫–∞–∑–∞–ª:
Thought for 1m 3s

–î–∞ ‚Äî —è –ø–æ—Å—á–∏—Ç–∞–ª ¬´—Ç–∏—Ö–æ¬ª –∏ –≤–æ—Ç —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å. –ù–∏–∂–µ ‚Äî –±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–µ–ø–æ–∑–∏—Ç–∞ 400‚ÄØUSDC –ø–æ–¥ —Ç–≤–æ—é —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (multi‚ÄëTP, trailing —Å HWM, BE –ø–æ—Å–ª–µ TP1, –∫–æ–º–∏—Å—Å–∏–∏ —É—á—Ç–µ–Ω—ã –∫–∞–∫ —É taker, –ø–æ–∑–∏—Ü–∏—è –≤ —Ä–∞–±–æ—Ç–µ ~40‚ÄØUSDC = 2 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø–æ 20).

–ß—Ç–æ —è —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–ª

22 —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–Ω—è, –ø–æ 6 –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å.

–ü–µ—Ä—Å—Ü–µ–Ω–∞—Ä–Ω–æ –º–µ–Ω—è–ª —á–∏—Å–ª–æ —Å–¥–µ–ª–æ–∫/—á–∞—Å –∏ –≤–∏–Ω—Ä–µ–π—Ç:

–ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ: 18 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å, winrate 65%

–ë–∞–∑–∞: 30 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å, winrate 70%

–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ: 48 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å, winrate 75%

–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ñ–∏—Ç —Å–¥–µ–ª–∫–∏ –ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π ‚âà +0.8% –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ (—á–∞—Å—Ç—å TP1/TP2 + –∏–Ω–æ–≥–¥–∞ –ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥), —Å—Ä–µ–¥–Ω–∏–π –ª–æ—Å—Å ‚âà ‚àí0.6%.

–£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–∞–∑–±—Ä–æ—Å (–Ω–æ—Ä–º–∞–ª—å–Ω—ã–π —à—É–º –ø–æ –ø—Ä–æ—Ñ–∏—Ç–∞–º/–ª–æ—Å—Å–∞–º, –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å —á–∏—Å–ª–∞ —Å–¥–µ–ª–æ–∫).

–ò—Ç–æ–≥ (–æ–∂–∏–¥–∞–Ω–∏–µ –Ω–∞ 400‚ÄØUSDC –¥–µ–ø–æ–∑–∏—Ç–µ)

–ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ: ‚âà 0.33‚ÄØUSDC/—á–∞—Å (‚âà 2.0‚ÄØUSDC/–¥–µ–Ω—å; ‚âà 44‚ÄØUSDC/–º–µ—Å; 5‚Äë95% –ø–æ –º–µ—Å—è—Ü—É: 33‚Äì54)

–ë–∞–∑–∞: ‚âà 0.90‚ÄØUSDC/—á–∞—Å (‚âà 5.4‚ÄØUSDC/–¥–µ–Ω—å; ‚âà 119‚ÄØUSDC/–º–µ—Å; 5‚Äë95%: 104‚Äì134)

–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ: ‚âà 1.92‚ÄØUSDC/—á–∞—Å (‚âà 11.5‚ÄØUSDC/–¥–µ–Ω—å; ‚âà 254‚ÄØUSDC/–º–µ—Å; 5‚Äë95%: 233‚Äì275)

–ö–æ—Ä–æ—Ç–∫–∏–π –≤—ã–≤–æ–¥

–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è ¬´—Å—Ä–µ–¥–Ω—è—è¬ª –ø–ª–∞–Ω–∫–∞ –¥–ª—è —Ç–≤–æ–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫: ~0.9‚ÄØUSDC/—á–∞—Å (–æ–∫–æ–ª–æ +25% –≤ –º–µ—Å—è—Ü –Ω–∞ –¥–µ–ø–æ–∑–∏—Ç–µ 400).

–ë—ã–≤–∞—é—Ç —Ç–∏—Ö–∏–µ —á–∞—Å—ã/–¥–Ω–∏ (–ø–∞–¥–µ–Ω–∏–µ –¥–æ ~0.3‚ÄØUSDC/—á–∞—Å), –∏ –±—ã–≤–∞—é—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –¥–Ω–∏ (—Ä–æ—Å—Ç –¥–æ ~1.9‚ÄØUSDC/—á–∞—Å –∏ –≤—ã—à–µ).

–ß—Ç–æ —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –¥–≤–∏–≥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ß–∞—Å—Ç–æ—Ç–∞ –≤—Ö–æ–¥–æ–≤ –ø–æ—Å–ª–µ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–∏–º–ø—É–ª—å—Å, —á–∏—Å—Ç–æ—Ç–∞ —Å–ø—Ä–µ–¥–∞, –æ–∫–Ω–∞).

Net‚Äë–ø—Ä–æ—Ñ–∏—Ç —Å–¥–µ–ª–∫–∏ (–≤–∞–∂–Ω–æ, —á—Ç–æ –º—ã —É–∂–µ —É—á–ª–∏ –∫–æ–º–∏—Å—Å–∏–∏ –≤ TP/SL –∏ PnL).

–ü–∏—Ä–∞–º–∏–¥–∏–Ω–≥ (–¥–∞—ë—Ç –æ—â—É—Ç–∏–º—ã–π –∞–ø—Å–∞–π–¥ –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Å—ã, –Ω–æ –µ–≥–æ –ª—É—á—à–µ –ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å 1‚Äì2 –¥–æ–≥—Ä—É–∑–∫–∞–º–∏).

–•–æ—á–µ—à—å ‚Äî —Å–æ–±–µ—Ä—É —Ç–æ—Ç –∂–µ —Å–∏–º—É–ª—è—Ç–æ—Ä —Å ¬´–ø–æ–ª–∑—É–Ω–∫–∞–º–∏¬ª –ø–æ–¥ —Ç–≤–æ–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–≤–∏–Ω—Ä–µ–π—Ç, –∫–æ–ª‚Äë–≤–æ —Å–¥–µ–ª–æ–∫/—á–∞—Å, –ø—Ä–æ—Ñ–∏—Ç/–ª–æ—Å—Å) –∏ –¥–∞–º —Ç–∞–±–ª–∏—Ü—É —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è PnL –ø—Ä–∏ ¬±0.1% –∫ —Å—Ä–µ–¥–Ω–µ–º—É –ø—Ä–æ—Ñ–∏—Ç—É —Å–¥–µ–ª–∫–∏ –∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —á–∞—Å—Ç–æ—Ç—ã —Å–∏–≥–Ω–∞–ª–æ–≤.

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–∞ —á–∞—Å—ã –≤ –¥–µ–Ω—å –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å? –Ω–∞–ø—Ä —Å 7 –¥–æ 23? –∏ —á—Ç–æ –µ—Å–ª–∏ –¥–µ–ø–æ –¥–æ 500
ChatGPT —Å–∫–∞–∑–∞–ª:

–î–∞, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —á–∞—Å–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –¥–µ–ø–æ–∑–∏—Ç–∞ –ø—Ä—è–º–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –º–µ–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –Ω–æ —Å –Ω—é–∞–Ω—Å–∞–º–∏ –ø–æ —Ä–∏—Å–∫–∞–º –∏ –≤–∏–Ω—Ä–µ–π—Ç—É.

üìä –ï—Å–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å —Ç–æ—Ä–≥–æ–≤—ã–µ —á–∞—Å—ã —Å 6 ‚Üí 16 (—Å 07:00 –¥–æ 23:00)

–ü–ª—é—Å—ã

–°–¥–µ–ª–æ–∫ –≤ –¥–µ–Ω—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è ‚âà √ó2.6 –±–æ–ª—å—à–µ (–ø–æ—á—Ç–∏ –≤ 3 —Ä–∞–∑–∞), –∑–Ω–∞—á–∏—Ç –∏ PnL –≤ —Å—Ä–µ–¥–Ω–µ–º –≤—ã—Ä–∞—Å—Ç–∞–µ—Ç.

–ú—ã –±—É–¥–µ–º –ª–æ–≤–∏—Ç—å –±–æ–ª—å—à–µ –∏–º–ø—É–ª—å—Å–æ–≤ –∏ –∞–∑–∏–∞—Ç—Å–∫—É—é, –∏ –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫—É—é —Å–µ—Å—Å–∏—é.

–ú–∏–Ω—É—Å—ã

–í–Ω–µ –ø–∏–∫–æ–≤ (–õ–æ–Ω–¥–æ–Ω/–ù—å—é-–ô–æ—Ä–∫) –≤–∏–Ω—Ä–µ–π—Ç —á—É—Ç—å –ø–∞–¥–∞–µ—Ç ‚Äî —Ä—ã–Ω–æ–∫ —á–∞—Å—Ç–æ ¬´–≤—è–ª—ã–π¬ª, –ª–æ–∂–Ω—ã–µ –∏–º–ø—É–ª—å—Å—ã.

–†–∞—Å—Ç—ë—Ç –∫–æ–º–∏—Å—Å–∏—è –∏–∑-–∑–∞ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—Ö–æ–¥–æ–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∞–∑–∏–∞—Ç—Å–∫—É—é –Ω–æ—á—å (—Ç—Ä–µ–±—É–µ—Ç –∂—ë—Å—Ç–∫–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤).

–ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Å—á—ë—Ç (400 USDC –¥–µ–ø–æ–∑–∏—Ç, —Å—Ä–µ–¥–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π):

–ë—ã–ª–æ: ~5.4 USDC/–¥–µ–Ω—å (6 —á–∞—Å–æ–≤)

–°—Ç–∞–Ω–µ—Ç: ~14.0 USDC/–¥–µ–Ω—å (16 —á–∞—Å–æ–≤, —Å —É—á—ë—Ç–æ–º -5% –≤–∏–Ω—Ä–µ–π—Ç–∞ –≤ –Ω–µ–ø–∏–∫–æ–≤—ã–µ —á–∞—Å—ã)

–ú–µ—Å—è—Ü: ~300 USDC (+75% –¥–µ–ø–æ–∑–∏—Ç–∞)

üìä –ï—Å–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–µ–ø–æ–∑–∏—Ç –¥–æ 500 USDC

–ü—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö –ø–æ–∑–∏—Ü–∏–∏ (20 USDC √ó 2 –ø–æ–∑–∏—Ü–∏–∏) –¥–æ—Ö–æ–¥ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è ‚Äî –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ —Ä–∞–±–æ—Ç—É –≤—Å—ë —Ä–∞–≤–Ω–æ —É—Ö–æ–¥–∏—Ç 40 USDC.
–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–ø–æ–∑–∏—Ç, –Ω–∞–¥–æ –ø–æ–¥–Ω—è—Ç—å BASE_POSITION_SIZE_USDT.

–ù–∞–ø—Ä–∏–º–µ—Ä:

BASE_POSITION_SIZE_USDT=25, 2 –ø–æ–∑–∏—Ü–∏–∏ = 50 USDC –≤ —Ä–∞–±–æ—Ç–µ

–î–æ—Ö–æ–¥ –≤—ã—Ä–∞—Å—Ç–µ—Ç –Ω–∞ +25% (–≤ —Å—Ä–µ–¥–Ω–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å 5.4 ‚Üí 6.75 USDC/–¥–µ–Ω—å –ø—Ä–∏ 6 —á–∞—Å–∞—Ö —Ç–æ—Ä–≥–æ–≤–ª–∏).

–ï—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å 16 —á–∞—Å–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –ø–æ–¥–Ω—è—Ç—å –¥–æ 25 USDC:

~17.5 USDC/–¥–µ–Ω—å (~385 USDC/–º–µ—Å) ‚Äî —ç—Ç–æ —É–∂–µ ~77% –¥–µ–ø–æ–∑–∏—Ç–∞ –∑–∞ –º–µ—Å—è—Ü.

üí° –ú–æ–π —Å–æ–≤–µ—Ç

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å —Ä–µ–∞–ª—å–Ω–æ –º–∞–∫—Å–∏–º—É–º –≤—ã–∂–∞—Ç—å:

–£–≤–µ–ª–∏—á–∏—Ç—å —á–∞—Å—ã —Å 07:00 –¥–æ 23:00, –Ω–æ –≤–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–æ–≥–∏–π —Ñ–∏–ª—å—Ç—Ä ATR –∏ —Å–ø—Ä–µ–¥–∞ –≤ –∞–∑–∏–∞—Ç—Å–∫–∏–µ —Ç–∏—Ö–∏–µ —á–∞—Å—ã.

BASE_POSITION_SIZE_USDT –ø–æ–¥–Ω—è—Ç—å —Å 20 –¥–æ 25 USDC (–¥–ª—è –¥–µ–ø–æ 500 USDC —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ).

–ü—Ä–∏ –±–æ–ª—å—à–µ–º –≤—Ä–µ–º–µ–Ω–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –≤–∞–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ MAX_HOURLY_TRADE_LIMIT (—á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä–µ—Ç—å —Å—á—ë—Ç –≤ —Ñ–ª—ç—Ç–µ).

–•–æ—á–µ—à—å, —è —Å–¥–µ–ª–∞—é –Ω–æ–≤—ã–π –ø–µ—Ä–µ—Ä–∞—Å—á—ë—Ç PnL —Å —É—á—ë—Ç–æ–º 16 —á–∞—Å–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏ –¥–µ–ø–æ–∑–∏—Ç–∞ 500 USDC, —á—Ç–æ–±—ã —Ç—ã –≤–∏–¥–µ–ª –∏—Ç–æ–≥ –ø–æ —Ç—Ä—ë–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º?

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–¥–∞–≤–∞–π
ChatGPT —Å–∫–∞–∑–∞–ª:

–û–∫, —Ç–æ–≥–¥–∞ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ–º –º–æ–¥–µ–ª—å –¥–ª—è:

–î–µ–ø–æ–∑–∏—Ç = 500 USDC

BASE_POSITION_SIZE_USDT = 25 (2 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ = 50 USDC –≤ —Ä–∞–±–æ—Ç–µ)

–ß–∞—Å—ã —Ç–æ—Ä–≥–æ–≤–ª–∏ = 16 —á/–¥–µ–Ω—å (07:00‚Äì23:00)

–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ñ–∏—Ç —Å–¥–µ–ª–∫–∏ = +0.8% –æ—Ç –ø–æ–∑–∏—Ü–∏–∏ (–ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π)

–°—Ä–µ–¥–Ω–∏–π —É–±—ã—Ç–æ–∫ —Å–¥–µ–ª–∫–∏ = ‚àí0.6%

–ü–∞–¥–µ–Ω–∏–µ –≤–∏–Ω—Ä–µ–π—Ç–∞ –Ω–∞ —Ç–∏—Ö–∏—Ö —á–∞—Å–∞—Ö = ‚àí5% –æ—Ç –¥–Ω–µ–≤–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è

22 —Ç–æ—Ä–≥–æ–≤—ã—Ö –¥–Ω—è/–º–µ—Å

üìä –ù–æ–≤—ã–π –ø–µ—Ä–µ—Å—á—ë—Ç PnL

1. –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π

–ë—ã–ª–æ (6 —á): 18 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

–°—Ç–∞–ª–æ (16 —á): ~48 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

Winrate = 65% ‚Üí –≤ —Ç–∏—Ö–∏–µ —á–∞—Å—ã = ~60%

–°—Ä–µ–¥–Ω–∏–π –¥–Ω–µ–≤–Ω–æ–π winrate ‚âà 62%

PnL:

–ü–ª—é—Å: 29.8 win √ó (0.8% √ó 50) = 11.92 USDC

–ú–∏–Ω—É—Å: 18.2 loss √ó (0.6% √ó 50) = 5.46 USDC

Net –≤ –¥–µ–Ω—å: +6.46 USDC

Net –≤ –º–µ—Å—è—Ü: +142 USDC (~28% –¥–µ–ø–æ–∑–∏—Ç–∞)

2. –°—Ä–µ–¥–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π

–ë—ã–ª–æ (6 —á): 30 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

–°—Ç–∞–ª–æ (16 —á): ~80 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

Winrate = 70% ‚Üí –≤ —Ç–∏—Ö–∏–µ —á–∞—Å—ã = ~65%

–°—Ä–µ–¥–Ω–∏–π –¥–Ω–µ–≤–Ω–æ–π winrate ‚âà 67%

PnL:

–ü–ª—é—Å: 53.6 win √ó (0.8% √ó 50) = 21.44 USDC

–ú–∏–Ω—É—Å: 26.4 loss √ó (0.6% √ó 50) = 7.92 USDC

Net –≤ –¥–µ–Ω—å: +13.52 USDC

Net –≤ –º–µ—Å—è—Ü: +297 USDC (~59% –¥–µ–ø–æ–∑–∏—Ç–∞)

3. –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π

–ë—ã–ª–æ (6 —á): 48 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

–°—Ç–∞–ª–æ (16 —á): ~128 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

Winrate = 75% ‚Üí –≤ —Ç–∏—Ö–∏–µ —á–∞—Å—ã = ~70%

–°—Ä–µ–¥–Ω–∏–π –¥–Ω–µ–≤–Ω–æ–π winrate ‚âà 72%

PnL:

–ü–ª—é—Å: 92.2 win √ó (0.8% √ó 50) = 36.88 USDC

–ú–∏–Ω—É—Å: 35.8 loss √ó (0.6% √ó 50) = 10.74 USDC

Net –≤ –¥–µ–Ω—å: +26.14 USDC

Net –≤ –º–µ—Å—è—Ü: +575 USDC (~115% –¥–µ–ø–æ–∑–∏—Ç–∞)

üß† –í—ã–≤–æ–¥—ã

–ü—Ä–∏ –¥–µ–ø–æ 500 USDC –∏ 16 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã:

–î–∞–∂–µ –ø–µ—Å—Å–∏–º–∏–∑–º –¥–∞—ë—Ç +28% –≤ –º–µ—Å—è—Ü

–°—Ä–µ–¥–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π ‚Äî +59% –≤ –º–µ—Å—è—Ü

–û–ø—Ç–∏–º–∏–∑–º ‚Äî √ó2 –¥–µ–ø–æ –∑–∞ –º–µ—Å—è—Ü

–ì–ª–∞–≤–Ω—ã–π —Ä–∏—Å–∫ ‚Äî –≤ —Ç–∏—Ö–∏–µ —á–∞—Å—ã –ª–æ–≤–∏—Ç—å ¬´–ø—É—Å—Ç—ã–µ¬ª —Å–¥–µ–ª–∫–∏ ‚Üí –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å —Å—Ç—Ä–æ–≥–∏–π —Ñ–∏–ª—å—Ç—Ä ATR+—Å–ø—Ä–µ–¥, —á—Ç–æ–±—ã —Ä–µ–∞–ª—å–Ω—ã–π –≤–∏–Ω—Ä–µ–π—Ç –Ω–µ –ø–∞–¥–∞–ª –Ω–∏–∂–µ ‚àí5%.

–•–æ—á–µ—à—å, —è —Å—Ä–∞–∑—É –ø—Ä–æ–ø–∏—à—É —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é .env –¥–ª—è —Ç–∞–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ (16 —á–∞—Å–æ–≤, 500 –¥–µ–ø–æ, –ø–æ–∑–∏—Ü–∏—è 25, —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–¥ —Ç–∏—Ö–∏–µ —á–∞—Å—ã), —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ –¥–æ–ø. –ø—Ä–∞–≤–æ–∫?

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–¥–∞ –¥–∞–≤–∞–π –∏ –≤–æ–ø—Ä–æ—Å –º–æ–∂–Ω–æ –ª–∏ —Å –æ–¥–Ω–æ–≥–æ –∞–ø–∏ –∏–ª–∏ —Å —Ö–µ—Ü–Ω–µ—Ä –≤–ø—Å —Å –º–æ–µ–≥–æ –∞–ø–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞–ø—Ä–∏ –ø–∞—Ä–∞–ª 5 —Ç–∞–∫–∏—Ö –±–æ—Ç–æ–≤
ChatGPT —Å–∫–∞–∑–∞–ª:
Thought for 9s

–û—Ç–ª–∏—á–Ω–æ ‚Äî –≤–æ—Ç –≥–æ—Ç–æ–≤—ã–π .env –¥–ª—è —Ä–µ–∂–∏–º–∞ 07:00‚Äì23:00, –¥–µ–ø–æ–∑–∏—Ç 500 USDC, –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä 25 USDC, –ø–ª—é—Å –æ—Ç–≤–µ—Ç –ø–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É 5 –±–æ—Ç–æ–≤ –∏ –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ.

‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π .env (16 —á–∞—Å–æ–≤, –¥–µ–ø–æ 500, base=25)

# ================================

# BINANCE API

# ================================

BINANCE_API_KEY=YOUR_API_KEY_HERE
BINANCE_API_SECRET=YOUR_SECRET_HERE
BINANCE_TESTNET=true # false ‚Äî –¥–ª—è —Ä–µ–∞–ª–∞

# ================================

# TELEGRAM (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

# ================================

TELEGRAM_TOKEN=YOUR_BOT_TOKEN
TELEGRAM_CHAT_ID=YOUR_CHAT_ID
TELEGRAM_ENABLED=true

# ================================

# MODES

# ================================

DRY_RUN=false
ENABLE_WEBSOCKET=true
LOG_LEVEL=INFO

# ================================

# EXECUTION

# ================================

WORKING_TYPE=MARK_PRICE
SL_ORDER_TYPE=STOP_MARKET
TP_ORDER_TYPE=TAKE_PROFIT_MARKET
TIME_IN_FORCE=GTC
REDUCE_ONLY=true

# ================================

# POSITIONS / RISK

# ================================

MAX_POSITIONS=2
MAX_CONCURRENT_POSITIONS=2
MIN_POSITION_SIZE_USDT=25.0 # —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å BASE
BASE_POSITION_SIZE_USDT=25.0 # 2 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ ‚Üí ~50 USDC –≤ —Ä–∞–±–æ—Ç–µ
STOP_LOSS_PERCENT=0.8 # –±–∞–∑–æ–≤—ã–π SL (–∞–¥–∞–ø—Ç–∏–≤ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å)
TAKE_PROFIT_PERCENT=2.0 # fallback –ø—Ä–∏ ENABLE_MULTIPLE_TP=false
USE_DYNAMIC_BALANCE=false
TRADING_DEPOSIT=500
BALANCE_PERCENTAGE=0.95
MAX_CAPITAL_UTILIZATION_PCT=0.50
MAX_MARGIN_PERCENT=0.40
MAX_SLIPPAGE_PCT=0.05

# ================================

# MULTIPLE TAKE PROFIT

# ================================

ENABLE_MULTIPLE_TP=true
TP_LEVELS='[{"percent":1.0,"size":0.5},{"percent":2.0,"size":0.5}]'

# ================================

# FEES (USDC perps; —É—á—ë—Ç –∫–æ–º–∏—Å—Å–∏–π –≤ TP/SL –∏ PnL)

# ================================

ENABLE_FEE_ADJUSTMENT=true
FEE_MARKET=USD-M-USDC
PAY_FEES_WITH_BNB=true # —Å–∫–∏–¥–∫–∞ –Ω–∞ —Ç–∞–∫–µ—Ä, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞
TAKER_FEE_PERCENT=0.04 # —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –ø–æ–¥ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
MAKER_FEE_PERCENT=0.00 # –¥–ª—è USDC maker –æ–±—ã—á–Ω–æ 0%

# ================================

# TRAILING STOP (–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ—Å–ª–µ –ü–û–°–õ–ï–î–ù–ï–ì–û TP)

# ================================

ENABLE_TRAILING_STOP=true
TRAILING_STOP_PERCENT=0.5

# –Ω–∏–∫–∞–∫–∏—Ö TRAILING_ACTIVATION_AFTER_TP ‚Äî –∫–æ–¥ —Å–∞–º –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ TP

# ================================

# SCALPING (07:00‚Äì23:00 UTC –æ–∫–Ω–∞, —Å—Ç—Ä–æ–≥–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤–Ω–µ –ø–∏–∫–æ–≤)

# ================================

SCALPING_MODE=true
SCALPING_WINDOWS_UTC='[["07:00","23:00"]]' # —Ä–∞—Å—à–∏—Ä–∏–ª–∏ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è

# –ò–º–ø—É–ª—å—Å

IMPULSE_LOOKBACK_SEC=3
IMPULSE_MOVE_PCT=0.22
IMPULSE_MIN_TRADE_VOL=50000
IMPULSE_REQUIRE_TICK_ACCEL=true

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL (–ø–æ–¥ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)

ADAPTIVE_TPSL=true
ATR1M_PERIOD=60
ATR1M_HIGH_THRESH=0.35
ATR1M_LOW_THRESH=0.15
TP_PACK_LOW='[{"percent":0.6,"size":0.5},{"percent":1.2,"size":0.5}]'
TP_PACK_BASE='[{"percent":0.8,"size":0.4},{"percent":1.6,"size":0.3},{"percent":2.4,"size":0.3}]'
TP_PACK_HIGH='[{"percent":1.2,"size":0.34},{"percent":2.0,"size":0.33},{"percent":3.0,"size":0.33}]'
SL_PCT_LOW=0.5
SL_PCT_BASE=0.8
SL_PCT_HIGH=1.2

# Break-even –ø–æ—Å–ª–µ TP1 (–ø–µ—Ä–µ–∫—Ä—ã—Ç—å –∫–æ–º–∏—Å—Å–∏–∏)

INSTANT_BE_AFTER_TP1=true
BE_PLUS_PCT=0.06

# –ß–∏—Å—Ç–æ—Ç–∞ —Ä—ã–Ω–∫–∞

SPREAD_MAX_PCT=0.05
BLOCK_IF_OPPOSITE_ICEBERG=true
ICEBERG_MIN_SIZE_USD=150000

# –ú–∏–∫—Ä–æ-–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥

MICRO_PYRAMID=true
PYRAMID_ACCEL_PCT_PER_SEC=0.20
PYRAMID_ADD_SIZE_FRAC=0.15
PYRAMID_MAX_ADDS=2
PYRAMID_MIN_DIST_TO_SL_PCT=0.6

# ================================

# ENTRY CONTROLS

# ================================

ENTRY_COOLDOWN_SECONDS=0
MAX_HOURLY_TRADE_LIMIT=40 # –≤–∞–∂–Ω–æ –ø—Ä–∏ 16 —á–∞—Å–∞—Ö, —á—Ç–æ–±—ã –Ω–µ —à–∏—Ç—å –ø—É—Å—Ç—ã–µ –≤—Ö–æ–¥—ã

# ================================

# SPREAD FILTER (testnet relax)

# ================================

DISABLE_SPREAD_FILTER_TESTNET=true
MAX_SPREAD_PCT=5.0

# ================================

# WEBSOCKET

# ================================

WS_RECONNECT_INTERVAL=5
WS_HEARTBEAT_INTERVAL=30

–ó–∞—á–µ–º —ç—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

–ë–û–ª—å—à–∏–µ —á–∞—Å—ã ‚Üí –±–æ–ª—å—à–µ –≤—Ö–æ–¥–æ–≤; –º—ã –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º ¬´–ø—É—Å—Ç—ã–µ¬ª —Ç—Ä–µ–π–¥—ã MAX_HOURLY_TRADE_LIMIT –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ (ATR/—Å–ø—Ä–µ–¥/–∞–π—Å–±–µ—Ä–≥).

BASE_POSITION_SIZE_USDT=25 –ø—Ä–∏ –¥–µ–ø–æ 500 –¥–∞—ë—Ç —Ä–∞–∑—É–º–Ω—ã–π —Ä–∏—Å–∫ (2 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ = ~50 USDC –≤ —Ä–∞–±–æ—Ç–µ).

–ö–æ–º–∏—Å—Å–∏–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–∞—Ö TP/SL –∏ –≤ PnL –ª–æ–≥–∞—Ö ‚Äî –Ω–µ –±—É–¥–µ—Ç –ª–æ–∂–Ω–æ–≥–æ ¬´–º–∏–∫—Ä–æ–ø–ª—é—Å–∞¬ª.

üß© 5 –±–æ—Ç–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ: –º–æ–∂–Ω–æ –ª–∏? –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ?

–ö–æ—Ä–æ—Ç–∫–æ: –º–æ–∂–Ω–æ, –Ω–æ –ª—É—á—à–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å 5 —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º API‚Äë–∫–ª—é—á–µ. –ë–µ–∑–æ–ø–∞—Å–Ω–µ–µ ‚Äî —Å–∞–±‚Äë–∞–∫–∫–∞—É–Ω—Ç—ã (–∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ API‚Äë–∫–ª—é—á–∏) + —Ä–∞–∑–Ω–æ—Å –ø–æ —Å–∏–º–≤–æ–ª–∞–º/—Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º, –µ–¥–∏–Ω—ã–π —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π rate‚Äëlimiter.

–í–∞—Ä–∏–∞–Ω—Ç—ã
–í–∞—Ä–∏–∞–Ω—Ç A ‚Äî –ª—É—á—à–∏–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)

–°–æ–∑–¥–∞—ë—à—å 5 —Å–∞–±‚Äë–∞–∫–∫–∞—É–Ω—Ç–æ–≤ —É Binance (–∏–ª–∏ 5 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö API‚Äë–∫–ª—é—á–µ–π).

–ù–∞ Hetzner VPS (–æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä) –ø–æ–¥–Ω–∏–º–∞–µ—à—å 5 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –±–æ—Ç—É), —É –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–π .env –∏ —Å–≤–æ–π API‚Äë–∫–ª—é—á.

–ü–ª—é—Å—ã: –ª–∏–º–∏—Ç—ã –∏ userData WS –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç, –ª–µ–≥—á–µ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å.

–ú–∏–Ω—É—Å—ã: –Ω—É–∂–Ω–æ –º–µ–Ω–µ–¥–∂–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É —Å—É–±–∞–º–∏ (–º–∞—Å—Ç–µ—Ä ‚Üí —Å—É–±).

–í–∞—Ä–∏–∞–Ω—Ç B ‚Äî –æ–¥–∏–Ω API‚Äë–∫–ª—é—á, 5 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–≤–æ–∑–º–æ–∂–µ–Ω, –Ω–æ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ)

–í—Å–µ –ª–∏–º–∏—Ç—ã —Å—É–º–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ –∫–ª—é—á: —Ä–∏—Å–∫—É–µ—à—å —É–ø–µ—Ä–µ—Ç—å—Å—è –≤ rate limit.

–ù–µ–ª—å–∑—è –ø–ª–æ–¥–∏—Ç—å –º–Ω–æ–≥–æ userData‚Äë—Å—Ç—Ä–∏–º–æ–≤: –∞–∫–∫—É—Ä–∞—Ç–Ω–µ–µ —Å listenKey (–ª—É—á—à–µ 1 –∏ –º—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–∏—Ç—å), –Ω–æ –ø—Ä–æ—â–µ ‚Äî –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å‚Äë–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä.

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π rate‚Äëlimiter –Ω–∞ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (–∏–ª–∏ –æ–¥–∏–Ω –æ–±—â–∏–π —Å–µ—Ä–≤–∏—Å‚Äë–¥–µ–º–æ–Ω, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –∏–¥—É—Ç REST‚Äë–≤—ã–∑–æ–≤—ã).

–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ clientOrderId –ø—Ä–µ—Ñ–∏–∫—Å—ã –Ω–∞ –±–æ—Ç–∞: BOT1*, BOT2*, ‚Ä¶

–†–∞–∑–¥–µ–ª–∏—Ç—å —Å–∏–º–≤–æ–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –æ–¥–Ω–æ–º—É‚Äë–¥–≤—É–º —Å–∏–º–≤–æ–ª–∞–º –Ω–∞ –±–æ—Ç–∞), —á—Ç–æ–±—ã –Ω–µ –¥—Ä–∞–ª–∏—Å—å –∑–∞ –ø–æ–∑–∏—Ü–∏—é.

–ü—Ä–∞–∫—Ç–∏–∫–∞ –¥–µ–ø–ª–æ—è –Ω–∞ Hetzner VPS

–ñ–µ–ª–µ–∑–æ: –¥–ª—è 5 –ª—ë–≥–∫–∏—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö Python‚Äë–±–æ—Ç–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ 2 vCPU / 4‚Äì8 GB RAM (–Ω–∞–ø—Ä–∏–º–µ—Ä, CX21/CX31).

–ü—Ä–æ—Ü–µ—Å—Å‚Äë–º–µ–Ω–µ–¥–∂–µ—Ä: systemd (–∏–ª–∏ pm2/supervisord) ‚Äî –ø–æ 1 —Å–µ—Ä–≤–∏—Å—É –Ω–∞ –±–æ—Ç–∞.

–°–µ—Ç–∏ –∏ –≤—Ä–µ–º—è: –≤–∫–ª—é—á–∏ NTP (—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –∫—Ä–∏—Ç–∏—á–Ω–æ), –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å.

–õ–æ–≥–∏: —Ä–æ—Ç–∞—Ü–∏—è (journald –∏–ª–∏ logrotate).

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: —Ä–∞–∑–Ω—ã–µ .env —Å –ø—Ä–∞–≤–∞–º–∏ 600; –Ω–µ –∫–ª–∞–¥–∏ –∫–ª—é—á–∏ –≤ git.

–û–±–Ω–æ–≤–ª–µ–Ω–∏—è: –∫–∞—Ç–∏—Ç—å –ø–æ –æ–¥–Ω–æ–º—É –±–æ—Ç—É, —á—Ç–æ–±—ã –Ω–µ —É—Ä–æ–Ω–∏—Ç—å –≤—Å–µ—Ö.

–ö–∞–∫ –Ω–µ –ø—Ä–æ—Å—Ç—Ä–µ–ª–∏—Ç—å –Ω–æ–≥—É (—á–µ–∫‚Äë–ª–∏—Å—Ç)

üîê –†–∞–∑–Ω—ã–µ API‚Äë–∫–ª—é—á–∏ (–∏–ª–∏ —Å–∞–±‚Äë–∞–∫–∫–∞—É–Ω—Ç—ã) ‚Äî –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.

üß† –ï–¥–∏–Ω—ã–π rate‚Äëlimiter (–º—ã —É–∂–µ –æ–±—Å—É–¥–∏–ª–∏ –∏ –¥–∞–ª–∏ —Å–∫–µ–ª–µ—Ç).

üè∑Ô∏è –ü—Ä–µ—Ñ–∏–∫—Å—ã clientOrderId –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞: BOT1*TP1*, BOT2*SL*...

ü™™ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–∫–æ–≤: —Ö–æ—Ç—è –±—ã —á–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–∑–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã/—Ç–∞–π–º‚Äë–æ–∫–Ω–∞; –Ω–µ –¥–µ—Ä–∂–∞—Ç—å –¥–≤–µ —Å–∏—Å—Ç–µ–º—ã, —Ç–æ—Ä–≥—É—é—â–∏–µ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Å–∏–º–≤–æ–ª —Å –æ–¥–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.

üîÅ –û–¥–∏–Ω userData‚Äë—Å—Ç—Ä–∏–º –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç (–ø—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–µ B) –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ clientOrderId.

üêõ –î–µ–¥—É–ø —Å–æ–±—ã—Ç–∏–π: –ø–æ (orderId,status) ‚Äî –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å trailing/BE –¥–≤–∞–∂–¥—ã.

üß™ –ö–∞–Ω–∞—Ä–µ–µ—á–Ω—ã–π –±–æ—Ç: –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–Ω–∞—á–∞–ª–∞ –Ω–∞ 1 –∏–Ω—Å—Ç–∞–Ω—Å–µ, –ø–æ—Ç–æ–º ¬´–≤–æ–ª–Ω–æ–π¬ª –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ.

–•–æ—á–µ—à—å, —Å–¥–µ–ª–∞—é —à–∞–±–ª–æ–Ω –ø—è—Ç–∏ .env (BOT1..BOT5) —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ CLIENT_ID_PREFIX –∏ –ø—Ä–∏–º–µ—Ä–æ–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤ ‚Äî —á—Ç–æ–±—ã —Ç—ã –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–∏–ª –ø—è—Ç—å –∫–ª—é—á–µ–π –∏ –∑–∞–ø—É—Å—Ç–∏–ª –ø—è—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ Hetz–Ω–µ—Ä?

–í—ã —Å–∫–∞–∑–∞–ª–∏:
—á—Ç–æ –¥–∞—Å—Ç –ø–æ —É—Å–µ–ª–∏—á –ø—Ä–∏–±—ã–ª–∏ ?
ChatGPT —Å–∫–∞–∑–∞–ª:

–ï—Å–ª–∏ –∏–º–µ–Ω–Ω–æ –≤ —Ç–≤–æ–µ–π —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (multi-TP, trailing —Å HWM, BE –ø–æ—Å–ª–µ TP1, —Ñ–∏–ª—å—Ç—Ä—ã –Ω–∞ –≤—Ö–æ–¥, –∫–æ–º–∏—Å—Å–∏–∏ —É—á—Ç–µ–Ω—ã), —Ç–æ –≤ –ø–æ—Ä—è–¥–∫–µ –æ—Ç —Å–∞–º–æ–≥–æ —Å–∏–ª—å–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –Ω–∞ –ø—Ä–∏–±—ã–ª—å –¥–æ –º–µ–Ω–µ–µ –∑–Ω–∞—á–∏–º–æ–≥–æ –±—É–¥–µ—Ç —Ç–∞–∫:

1Ô∏è‚É£ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö —á–∞—Å–æ–≤

–ë—ã–ª–æ: 6 —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å ‚Üí 16 —á–∞—Å–æ–≤ (07:00‚Äì23:00)

–î–∞—ë—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º √ó2‚Äì2.6 –±–æ–ª—å—à–µ —Å–¥–µ–ª–æ–∫ ‚Üí PnL —Ä–∞—Å—Ç—ë—Ç –ø–æ—á—Ç–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã –æ—Ç—Å–µ–∫–∞—é—Ç –º—É—Å–æ—Ä –≤ ¬´—Ç–∏—Ö–∏–µ —á–∞—Å—ã¬ª.

–ë–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤ ‚Äî –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å winrate –∏ —Å—ä–µ—Å—Ç—å —á–∞—Å—Ç—å –ø—Ä–∏—Ä–æ—Å—Ç–∞.

üìà –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª: +60‚Äì100% –ø—Ä–∏–±—ã–ª–∏ –≤ –º–µ—Å—è—Ü –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–¥–µ–ª–æ–∫.

2Ô∏è‚É£ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ BASE_POSITION_SIZE_USDT

–ü—Ä–∏ –¥–µ–ø–æ 500 USDC –∏ BASE=25 –≤–º–µ—Å—Ç–æ 20 ‚Üí +25% –∫ –¥–æ—Ö–æ–¥—É.

–ù–æ —Ä–∞—Å—Ç—ë—Ç —Ä–∏—Å–∫ –ø–æ –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–µ ‚Üí –Ω—É–∂–µ–Ω MAX_CONCURRENT_POSITIONS –∏ –ª–∏–º–∏—Ç—ã –ø–æ—Ç–µ—Ä—å –≤ –¥–µ–Ω—å.

üìà –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª: +20‚Äì30% –ø—Ä–∏ —É–º–µ—Ä–µ–Ω–Ω–æ–º —Ä–∏—Å–∫–µ.

3Ô∏è‚É£ –§–∏–ª—å—Ç—Ä—ã –Ω–∞ –≤—Ö–æ–¥ (–∏–º–ø—É–ª—å—Å, —Å–ø—Ä–µ–¥, –∞–π—Å–±–µ—Ä–≥)

–†–µ–∂—É—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ —Å–¥–µ–ª–∫–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∞–∑–∏–∞—Ç—Å–∫–∏–µ —Ç–∏—Ö–∏–µ —á–∞—Å—ã.

–ú–µ–Ω—å—à–µ —Å–¥–µ–ª–æ–∫, –Ω–æ –≤—ã—à–µ winrate ‚Üí PnL/—á–∞—Å ‚Üë.

üìà –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª: +15‚Äì25% –∫ winrate ‚Üí PnL –≤ –º–µ—Å—è—Ü +20‚Äì40%.

4Ô∏è‚É£ Break-even —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ TP1

–ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ —É–±–∏—Ä–∞–µ—Ç –º–∏–Ω—É—Å–æ–≤—ã–µ —Å–¥–µ–ª–∫–∏, –≥–¥–µ TP1 —É–∂–µ –≤–∑—è—Ç.

–†–µ–∞–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç winrate –Ω–∞ 5‚Äì10 –ø.–ø., PnL —Ä–∞—Å—Ç—ë—Ç –∑–∞ —Å—á—ë—Ç ¬´–Ω—É–ª–µ–≤—ã—Ö¬ª –≤–º–µ—Å—Ç–æ –º–∏–Ω—É—Å–æ–≤.

üìà –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª: +10‚Äì20% –∫ –∏—Ç–æ–≥–æ–≤–æ–º—É –º–µ—Å—è—á–Ω–æ–º—É PnL.

5Ô∏è‚É£ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL –ø–æ–¥ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

–ü–æ–¥–≥–æ–Ω—è–µ–º —à–∏—Ä–∏–Ω—É TP/SL –ø–æ–¥ —Ç–µ–∫—É—â—É—é ATR ‚Üí –≤ —Ç–∏—Ö–æ–º —Ä—ã–Ω–∫–µ –∑–∞–±–∏—Ä–∞–µ–º –±–ª–∏–∂–Ω–∏–µ —Ü–µ–ª–∏, –≤ –∞–∫—Ç–∏–≤–Ω–æ–º ‚Äî –¥–∞—ë–º —Ü–µ–Ω–µ –¥–æ–π—Ç–∏ –¥–æ –¥–∞–ª—å–Ω–∏—Ö.

üìà –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª: +5‚Äì15%.

6Ô∏è‚É£ –ú–∏–∫—Ä–æ-–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥ –Ω–∞ —Å–∏–ª—å–Ω—ã—Ö –∏–º–ø—É–ª—å—Å–∞—Ö

–î–æ–±–∞–≤–ª—è–µ–º –æ–±—ä—ë–º, –µ—Å–ª–∏ –¥–≤–∏–∂–µ–Ω–∏–µ –∏–¥—ë—Ç –±—ã—Å—Ç—Ä–æ –∏ –≤ –Ω–∞—à—É —Å—Ç–æ—Ä–æ–Ω—É.

üìà –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª: +5‚Äì10%, –Ω–æ –∏ —Ä–∏—Å–∫ –±–æ–ª—å—à–µ, –µ—Å–ª–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç —Ä–µ–∑–∫–∏–π.

7Ô∏è‚É£ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –±–æ—Ç—ã (—Ä–∞–∑–Ω—ã–µ –ø–∞—Ä—ã/—Ç–∞–π–º-–æ–∫–Ω–∞)

–ï—Å–ª–∏ —Å–¥–µ–ª–∞—Ç—å 3‚Äì5 –±–æ—Ç–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–∏–º–≤–æ–ª–∞—Ö ‚Üí –∏—Ç–æ–≥–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å –ø–æ—á—Ç–∏ —Å—É–º–º–∏—Ä—É–µ—Ç—Å—è.

–ì–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å—Å—è –ø–æ —Å–∏–º–≤–æ–ª—É –Ω–∞ –æ–¥–Ω–æ–º –∞–∫–∫–∞—É–Ω—Ç–µ.

üìà –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª: –ª–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç PnL –ø–æ —á–∏—Å–ª—É –±–æ—Ç–æ–≤.

üí° –ï—Å–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å 1 + 2 + 3 + 4 ‚Äî –º–æ–∂–Ω–æ —É–¥–≤–æ–∏—Ç—å –ø—Ä–∏–±—ã–ª—å –±–µ–∑ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ —Ä–∏—Å–∫–∞.
–ê –¥–æ–±–∞–≤–∏–≤ 5 –∏ 6, –≤—ã–∂–º–µ—à—å –µ—â—ë ~+20% —Å–≤–µ—Ä—Ö—É.

–•–æ—á–µ—à—å, —è —Ç–µ–±–µ —Å—Ä–∞–∑—É —Å–æ–±–µ—Ä—É —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é ‚Äú–º–∞–∫—Å-–ø—Ä–∏–±—ã–ª—å‚Äù –¥–ª—è —Ç–≤–æ–µ–≥–æ –±–æ—Ç–∞ ‚Äî –≥–¥–µ –±—É–¥—É—Ç –≤–∫–ª—é—á–µ–Ω—ã –≤—Å–µ —ç—Ç–∏ –ø—É–Ω–∫—Ç—ã —Å –≥–æ—Ç–æ–≤—ã–º .env –∏ –ø–ª–∞–Ω–æ–º —Ä–∞—Å–∫–∞—Ç–∫–∏ –Ω–∞ VPS?
–¢–æ–≥–¥–∞ –ø–æ–ª—É—á–∏–º –º–∞–∫—Å–∏–º—É–º —ç—Ñ—Ñ–µ–∫—Ç–∞ –∏–∑ –¥–µ–ø–æ 500 –∏ 16 —á–∞—Å–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏.

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–¥–∞
ChatGPT —Å–∫–∞–∑–∞–ª:

–ª–µ—Ç–∏–º üöÄ ‚Äî –≤–æ—Ç ¬´–º–∞–∫—Å‚Äë–ø—Ä–∏–±—ã–ª—å¬ª —Å–±–æ—Ä–∫–∞: –≥–æ—Ç–æ–≤—ã–π .env, —á–µ–∫‚Äë–ª–∏—Å—Ç —Ä–∞—Å–∫–∞—Ç–∫–∏ –Ω–∞ VPS, –ª–∏–º–∏—Ç—ã —Ä–∏—Å–∫–∞, —Ä–∞—Å–∫–ª–∞–¥ –ø–æ 3‚Äì5 –±–æ—Ç–∞–º –∏ –ø–∞—Ä–∏—Ç–µ—Ç—ã –ø–æ —Å–∏–º–≤–æ–ª–∞–º, –ø–ª—é—Å –ø–∞—Ä–∞ safety‚Äë–≤—Å—Ç–∞–≤–æ–∫ –∫–æ–¥–∞.

1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è ¬´–º–∞–∫—Å‚Äë–ø—Ä–∏–±—ã–ª—å¬ª (—Å—É—Ç—å)

–ß–∞—Å—ã: 07:00‚Äì23:00 UTC (16 —á).

–î–µ–ø–æ–∑–∏—Ç: 500 USDC.

–†–∞–∑–º–µ—Ä: BASE=25 USDC, MAX_CONCURRENT_POSITIONS=2 (‚âà50 USDC –≤ —Ä–∞–±–æ—Ç–µ).

–í—Ö–æ–¥—ã: —Ç–æ–ª—å–∫–æ –ø–æ –∏–º–ø—É–ª—å—Å—É (WS), —á–∏—Å—Ç—ã–π —Å–ø—Ä–µ–¥ –∏ –±–µ–∑ –≤—Å—Ç—Ä–µ—á–Ω–æ–≥–æ –∞–π—Å–±–µ—Ä–≥–∞.

–í—ã—Ö–æ–¥—ã: multi‚ÄëTP (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –æ—Ç ATR) + instant BE –ø–æ—Å–ª–µ TP1 + trailing HWM –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ TP.

–ö–æ–º–∏—Å—Å–∏–∏: —É—á—Ç–µ–Ω—ã –≤ TP/SL –∏ –≤ PnL –ª–æ–≥–∞—Ö (USDC‚Äëperps).

–î–æ–ø: –º–∏–∫—Ä–æ‚Äë–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥ (1‚Äì2 –¥–æ–≥—Ä—É–∑–∫–∏) —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —É—Å–∫–æ—Ä–µ–Ω–∏–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ –¥–æ SL.

–ê–Ω—Ç–∏‚Äë–ø–µ—Ä–µ–≥—Ä–µ–≤: –ª–∏–º–∏—Ç —Å–¥–µ–ª–æ–∫/—á–∞—Å, –¥–Ω–µ–≤–Ω–æ–π –º–∞–∫—Å‚Äë–¥—Ä–æ—É–¥–∞—É–Ω –∏ —Å—Ç—Ä–∏–∫‚Äë—Å—Ç–æ–ø.

2. –§–∏–Ω–∞–ª—å–Ω—ã–π .env (–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π)

# ================= BINANCE =================

BINANCE_API_KEY=YOUR_API_KEY
BINANCE_API_SECRET=YOUR_API_SECRET
BINANCE_TESTNET=false

# ================= TELEGRAM =================

TELEGRAM_TOKEN=YOUR_BOT_TOKEN
TELEGRAM_CHAT_ID=YOUR_CHAT_ID
TELEGRAM_ENABLED=true

# ================= MODES =================

DRY_RUN=false
ENABLE_WEBSOCKET=true
LOG_LEVEL=INFO

# ================= EXECUTION =================

WORKING_TYPE=MARK_PRICE
SL_ORDER_TYPE=STOP_MARKET
TP_ORDER_TYPE=TAKE_PROFIT_MARKET
TIME_IN_FORCE=GTC
REDUCE_ONLY=true

# ================= RISK / SIZING =================

MAX_POSITIONS=2
MAX_CONCURRENT_POSITIONS=2
MIN_POSITION_SIZE_USDT=25.0
BASE_POSITION_SIZE_USDT=25.0
STOP_LOSS_PERCENT=0.8
TAKE_PROFIT_PERCENT=2.0
USE_DYNAMIC_BALANCE=false
TRADING_DEPOSIT=500
BALANCE_PERCENTAGE=0.95
MAX_CAPITAL_UTILIZATION_PCT=0.50
MAX_MARGIN_PERCENT=0.40
MAX_SLIPPAGE_PCT=0.05

# –¥–Ω–µ–≤–Ω–æ–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç

DAILY_MAX_LOSS_PCT=6.0 # —Å—Ç–æ–ø-–¥–µ–Ω—å –ø–æ —ç–∫–≤–∏—Ç–∏
MAX_CONSECUTIVE_LOSSES=4 # —Å—Ç—Ä–∏–∫-—Å—Ç–æ–ø
COOLDOWN_AFTER_STREAK_MIN=30 # –ø–∞—É–∑–∞ –ø–æ—Å–ª–µ —Å—Ç—Ä–∏–∫–∞ (–º–∏–Ω)

# ================= FEES (USDC perps) =================

ENABLE_FEE_ADJUSTMENT=true
FEE_MARKET=USD-M-USDC
PAY_FEES_WITH_BNB=true
TAKER_FEE_PERCENT=0.04
MAKER_FEE_PERCENT=0.00

# ================= MULTI-TP / TRAILING =================

ENABLE_MULTIPLE_TP=true

# –±–∞–∑–æ–≤—ã–π –Ω–∞–±–æ—Ä ‚Äî –≤—Å—ë —Ä–∞–≤–Ω–æ –∞–¥–∞–ø—Ç–∏–≤ –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç

TP_LEVELS='[{"percent":1.0,"size":0.5},{"percent":2.0,"size":0.5}]'
ENABLE_TRAILING_STOP=true
TRAILING_STOP_PERCENT=0.5

# ================= SCALPING (07:00‚Äì23:00) =================

SCALPING_MODE=true
SCALPING_WINDOWS_UTC='[["07:00","23:00"]]'

# –ò–º–ø—É–ª—å—Å

IMPULSE_LOOKBACK_SEC=3
IMPULSE_MOVE_PCT=0.22
IMPULSE_MIN_TRADE_VOL=50000
IMPULSE_REQUIRE_TICK_ACCEL=true

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL (ATR 1m)

ADAPTIVE_TPSL=true
ATR1M_PERIOD=60
ATR1M_HIGH_THRESH=0.35
ATR1M_LOW_THRESH=0.15
TP_PACK_LOW='[{"percent":0.6,"size":0.5},{"percent":1.2,"size":0.5}]'
TP_PACK_BASE='[{"percent":0.8,"size":0.4},{"percent":1.6,"size":0.3},{"percent":2.4,"size":0.3}]'
TP_PACK_HIGH='[{"percent":1.2,"size":0.34},{"percent":2.0,"size":0.33},{"percent":3.0,"size":0.33}]'
SL_PCT_LOW=0.5
SL_PCT_BASE=0.8
SL_PCT_HIGH=1.2

# Break-even –ø–æ—Å–ª–µ TP1

INSTANT_BE_AFTER_TP1=true
BE_PLUS_PCT=0.06

# –ß–∏—Å—Ç–æ—Ç–∞ —Ä—ã–Ω–∫–∞

SPREAD_MAX_PCT=0.05
BLOCK_IF_OPPOSITE_ICEBERG=true
ICEBERG_MIN_SIZE_USD=150000

# –ú–∏–∫—Ä–æ-–ø–∏—Ä–∞–º–∏–¥–∏–Ω–≥

MICRO_PYRAMID=true
PYRAMID_ACCEL_PCT_PER_SEC=0.20
PYRAMID_ADD_SIZE_FRAC=0.15
PYRAMID_MAX_ADDS=2
PYRAMID_MIN_DIST_TO_SL_PCT=0.6

# ================= THROTTLES =================

ENTRY_COOLDOWN_SECONDS=0
MAX_HOURLY_TRADE_LIMIT=40 # –≤–∞–∂–Ω–æ –ø—Ä–∏ 16—á

# ================= WEBSOCKET =================

WS_RECONNECT_INTERVAL=5
WS_HEARTBEAT_INTERVAL=30

–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è: BASE=20, DAILY_MAX_LOSS_PCT=4.0, MAX_HOURLY_TRADE_LIMIT=25.

3. –†–∞—Å–∫–∞—Ç–∫–∞ –Ω–∞ Hetzner (1‚Äì5 –±–æ—Ç–æ–≤)

–õ—É—á—à–µ: 3‚Äì5 —Å–∞–±‚Äë–∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–∏–ª–∏ —Ä–∞–∑–Ω—ã—Ö API‚Äë–∫–ª—é—á–µ–π), –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –±–æ—Ç–∞.

–•–æ—Å—Ç: 2 vCPU / 4‚Äì8GB RAM (CX21/CX31).

–ü–æ –±–æ—Ç—É ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π .env –∏ systemd —Å–µ—Ä–≤–∏—Å.

–†–∞–∑–Ω–µ—Å–∏ —Å–∏–º–≤–æ–ª—ã:

BOT1: BTCUSDC,

BOT2: ETHUSDC,

BOT3: SOLUSDC,

BOT4: BNBUSDC,

BOT5: XRPUSDC (–ø—Ä–∏–º–µ—Ä).

–ü—Ä–µ—Ñ–∏–∫—Å—ã clientOrderId: BOT1*, BOT2*, ‚Ä¶

–ï–¥–∏–Ω—ã–π rate‚Äëlimiter –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –Ω–µ –ø–ª–æ–¥–∏—Ç—å –ª–∏—à–Ω–∏–µ userData‚ÄëlistenKey.

4. –ê–Ω—Ç–∏‚Äë–ø–µ—Ä–µ–≥—Ä–µ–≤ (–º–∏–Ω–∏–º—É–º –∫–æ–¥–∞)
   —Å—Ç–æ–ø‚Äë–¥–µ–Ω—å –ø–æ —ç–∫–≤–∏—Ç–∏

# equity_guard.py

class EquityGuard:
def **init**(self, logger, max_dd_pct: float, max_losses: int, cooldown_min: int):
from datetime import datetime
self.log = logger
self.max_dd = max_dd_pct / 100.0
self.max_losses = max_losses
self.cooldown_min = cooldown_min
self.reset_day()

    def reset_day(self):
        from datetime import datetime, timedelta
        self.start_equity = None
        self.realized = 0.0
        self.loss_streak = 0
        self.block_until = None

    def start(self, equity_now: float):
        self.start_equity = equity_now

    def on_trade_result(self, pnl_net: float):
        from datetime import datetime, timedelta
        self.realized += pnl_net
        self.loss_streak = self.loss_streak + 1 if pnl_net < 0 else 0
        # check streak
        if self.loss_streak >= self.max_losses:
            self.block_until = datetime.utcnow() + timedelta(minutes=self.cooldown_min)
            self.log.log_event("RISK", "WARNING", f"Streak stop: {self.loss_streak} losses, cooldown {self.cooldown_min}m")
        # check daily dd
        if self.start_equity:
            dd = -min(0.0, self.realized) / self.start_equity
            if dd >= self.max_dd:
                self.block_until = datetime.utcnow() + timedelta(hours=24)
                self.log.log_event("RISK", "ERROR", f"Daily loss limit hit ({dd*100:.2f}%), blocking till tomorrow")

    def allowed(self) -> bool:
        from datetime import datetime
        return (self.block_until is None) or (datetime.utcnow() >= self.block_until)

–í –º–µ—Å—Ç–µ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –ø–µ—Ä–µ–¥ entry:

if not equity_guard.allowed():
return # –ø–∞—É–∑–∞ –ø–æ—Å–ª–µ —Å—Ç—Ä–∏–∫–∞/–¥–Ω–µ–≤–Ω–æ–π —Å—Ç–æ–ø

–ò –Ω–µ –∑–∞–±—ã–≤–∞–π –≤—ã–∑—ã–≤–∞—Ç—å equity_guard.on_trade_result(net_pnl) –ø—Ä–∏ –∫–∞–∂–¥–æ–π —á–∞—Å—Ç–∏—á–Ω–æ–π —Ñ–∏–∫—Å–∞—Ü–∏–∏ (—É —Ç–µ–±—è PnL —É–∂–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è).

–ª–∏–º–∏—Ç —Å–¥–µ–ª–æ–∫/—á–∞—Å

–°—á—ë—Ç—á–∏–∫ —É—Å–ø–µ—à–Ω—ã—Ö entry –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å; –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ MAX_HOURLY_TRADE_LIMIT ‚Äî –±–ª–æ–∫–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ –≤—Ö–æ–¥—ã –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–∫–Ω–∞.

5. –ß—Ç–æ –¥–∞—Å—Ç –º–∞–∫—Å–∏–º—É–º –ø—Ä–∏—Ä–æ—Å—Ç–∞ –ø—Ä–∏–±—ã–ª–∏ ‚Äî –ø–æ—Ä—è–¥–æ–∫ –≤–∫–ª—é—á–µ–Ω–∏—è

–ß–∞—Å—ã 07‚Äì23 + —Å—Ç—Ä–æ–≥–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã (—Å–ø—Ä–µ–¥/ATR/–∞–π—Å–±–µ—Ä–≥).

BASE 25 (2 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ), –Ω–µ –≤—ã—à–µ –ø—Ä–∏ –¥–µ–ø–æ 500.

Instant BE + –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL (—É–∂–µ –≤–∫–ª—é—á–µ–Ω–æ).

–ú–∏–∫—Ä–æ‚Äë–ø–∏—Ä–∞–º–∏–¥–∞ (–º–∞–∫—Å 2 –¥–æ–±–∞–≤–∫–∏) ‚Üí +5‚Äì10% –∫ PnL –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Å—ã.

–ü–∞—Ä–∞–ª–ª–µ–ª—å 3‚Äì5 –±–æ—Ç–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å–∏–º–≤–æ–ª–∞—Ö/–∫–ª—é—á–∞—Ö ‚Üí –ª–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç PnL.

6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (KPIs –≤ –ª–æ–≥–∞—Ö/–¢–µ–ª–µ–≥—Ä–∞–º)

–ü–æ—á–∞—Å–æ–≤–æ–π: trades, winrate\_%, net_pnl, avg_win/avg_loss, w/l ratio.

–î–Ω–µ–≤–Ω–æ–π: net_pnl_day, max_drawdown_day, loss_streak_max.

–¢–µ—Ö: ws_reconnects, rate_limit_hits, coalesced_calls.

–•–æ—á–µ—à—å ‚Äî –¥–æ–±–∞–≤–ª—é —à–∞–±–ª–æ–Ω—ã .env –¥–ª—è BOT1..BOT5 (—Å–∏–º–≤–æ–ª—ã + –ø—Ä–µ—Ñ–∏–∫—Å—ã CLIENT_ID_PREFIX) –∏ unit‚Äë—Ç–µ—Å—Ç—ã –Ω–∞ –∞–Ω—Ç–∏‚Äë–ø–µ—Ä–µ–≥—Ä–µ–≤ (daily stop / streak stop), —á—Ç–æ–±—ã –≤—Å—ë —ç—Ç–æ —Å–∫–ª–µ–∏–ª–æ—Å—å –±–µ–∑ —Å—é—Ä–ø—Ä–∏–∑–æ–≤?

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–¥–∞
ChatGPT —Å–∫–∞–∑–∞–ª:

—Å—É–ø–µ—Ä ‚Äî –≤–æ—Ç –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è 5 –±–æ—Ç–æ–≤ (BOT1..BOT5) + –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —é–Ω–∏—Ç‚Äë—Ç–µ—Å—Ç—ã –¥–ª—è –∞–Ω—Ç–∏‚Äë–ø–µ—Ä–µ–≥—Ä–µ–≤–∞ (daily stop / streak stop) –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–º–∏—Ç–∞ —Å–¥–µ–ª–æ–∫ –≤ —á–∞—Å. –ö–æ–ø–∏—Ä—É–π –∫–∞–∫ –µ—Å—Ç—å –∏ –ø–æ–¥—Å—Ç–∞–≤—å –∫–ª—é—á–∏.

üì¶ .env —à–∞–±–ª–æ–Ω—ã (BOT1..BOT5)

–û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:

–†–∞–∑–Ω—ã–µ API‚Äë–∫–ª—é—á–∏ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) –∏–ª–∏ —Ä–∞–∑–Ω—ã–µ —Å–∞–±‚Äë–∞–∫–∫–∞—É–Ω—Ç—ã.

–†–∞–∑–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (—á—Ç–æ–±—ã –±–æ—Ç—ã –Ω–µ –¥—Ä–∞–ª–∏—Å—å –∑–∞ –æ–¥–Ω—É –ø–æ–∑–∏—Ü–∏—é).

–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å –¥–ª—è clientOrderId (—á—Ç–æ–±—ã –ª–µ–≥–∫–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è): CLIENT_ID_PREFIX.

–í—Å–µ –±–æ—Ç—ã: —Ä–µ–∂–∏–º 07:00‚Äì23:00, –¥–µ–ø–æ 500, base=25, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –ø–æ ¬´–º–∞–∫—Å‚Äë–ø—Ä–∏–±—ã–ª—å¬ª.

BOT1 ‚Äî BTCUSDC

# ================= BINANCE =================

BINANCE_API_KEY=YOUR_API_KEY_BOT1
BINANCE_API_SECRET=YOUR_API_SECRET_BOT1
BINANCE_TESTNET=false

# ================= BOT META =================

CLIENT*ID_PREFIX=BOT1*

# ================= SYMBOLS (primary) =================

TRADE_SYMBOLS=BTCUSDC

# ==== –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥ –æ–¥–∏–Ω–∞–∫–æ–≤ –¥–ª—è –≤—Å–µ—Ö –±–æ—Ç–æ–≤ ====

DRY_RUN=false
ENABLE_WEBSOCKET=true
LOG_LEVEL=INFO
WORKING_TYPE=MARK_PRICE
SL_ORDER_TYPE=STOP_MARKET
TP_ORDER_TYPE=TAKE_PROFIT_MARKET
TIME_IN_FORCE=GTC
REDUCE_ONLY=true

MAX_POSITIONS=2
MAX_CONCURRENT_POSITIONS=2
MIN_POSITION_SIZE_USDT=25.0
BASE_POSITION_SIZE_USDT=25.0
STOP_LOSS_PERCENT=0.8
TAKE_PROFIT_PERCENT=2.0
USE_DYNAMIC_BALANCE=false
TRADING_DEPOSIT=500
BALANCE_PERCENTAGE=0.95
MAX_CAPITAL_UTILIZATION_PCT=0.50
MAX_MARGIN_PERCENT=0.40
MAX_SLIPPAGE_PCT=0.05

DAILY_MAX_LOSS_PCT=6.0
MAX_CONSECUTIVE_LOSSES=4
COOLDOWN_AFTER_STREAK_MIN=30

ENABLE_FEE_ADJUSTMENT=true
FEE_MARKET=USD-M-USDC
PAY_FEES_WITH_BNB=true
TAKER_FEE_PERCENT=0.04
MAKER_FEE_PERCENT=0.00

ENABLE_MULTIPLE_TP=true
TP_LEVELS='[{"percent":1.0,"size":0.5},{"percent":2.0,"size":0.5}]'
ENABLE_TRAILING_STOP=true
TRAILING_STOP_PERCENT=0.5

SCALPING_MODE=true
SCALPING_WINDOWS_UTC='[["07:00","23:00"]]'
IMPULSE_LOOKBACK_SEC=3
IMPULSE_MOVE_PCT=0.22
IMPULSE_MIN_TRADE_VOL=50000
IMPULSE_REQUIRE_TICK_ACCEL=true

ADAPTIVE_TPSL=true
ATR1M_PERIOD=60
ATR1M_HIGH_THRESH=0.35
ATR1M_LOW_THRESH=0.15
TP_PACK_LOW='[{"percent":0.6,"size":0.5},{"percent":1.2,"size":0.5}]'
TP_PACK_BASE='[{"percent":0.8,"size":0.4},{"percent":1.6,"size":0.3},{"percent":2.4,"size":0.3}]'
TP_PACK_HIGH='[{"percent":1.2,"size":0.34},{"percent":2.0,"size":0.33},{"percent":3.0,"size":0.33}]'
SL_PCT_LOW=0.5
SL_PCT_BASE=0.8
SL_PCT_HIGH=1.2

INSTANT_BE_AFTER_TP1=true
BE_PLUS_PCT=0.06

SPREAD_MAX_PCT=0.05
BLOCK_IF_OPPOSITE_ICEBERG=true
ICEBERG_MIN_SIZE_USD=150000

MICRO_PYRAMID=true
PYRAMID_ACCEL_PCT_PER_SEC=0.20
PYRAMID_ADD_SIZE_FRAC=0.15
PYRAMID_MAX_ADDS=2
PYRAMID_MIN_DIST_TO_SL_PCT=0.6

ENTRY_COOLDOWN_SECONDS=0
MAX_HOURLY_TRADE_LIMIT=40

WS_RECONNECT_INTERVAL=5
WS_HEARTBEAT_INTERVAL=30

BOT2 ‚Äî ETHUSDC
BINANCE*API_KEY=YOUR_API_KEY_BOT2
BINANCE_API_SECRET=YOUR_API_SECRET_BOT2
BINANCE_TESTNET=false
CLIENT_ID_PREFIX=BOT2*
TRADE_SYMBOLS=ETHUSDC

# –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –∫–∞–∫ —É BOT1

BOT3 ‚Äî SOLUSDC
BINANCE*API_KEY=YOUR_API_KEY_BOT3
BINANCE_API_SECRET=YOUR_API_SECRET_BOT3
BINANCE_TESTNET=false
CLIENT_ID_PREFIX=BOT3*
TRADE_SYMBOLS=SOLUSDC

# –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –∫–∞–∫ —É BOT1

BOT4 ‚Äî BNBUSDC
BINANCE*API_KEY=YOUR_API_KEY_BOT4
BINANCE_API_SECRET=YOUR_API_SECRET_BOT4
BINANCE_TESTNET=false
CLIENT_ID_PREFIX=BOT4*
TRADE_SYMBOLS=BNBUSDC

# –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –∫–∞–∫ —É BOT1

BOT5 ‚Äî XRPUSDC
BINANCE*API_KEY=YOUR_API_KEY_BOT5
BINANCE_API_SECRET=YOUR_API_SECRET_BOT5
BINANCE_TESTNET=false
CLIENT_ID_PREFIX=BOT5*
TRADE_SYMBOLS=XRPUSDC

# –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –∫–∞–∫ —É BOT1

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –¥–≤–∞ —Å–∏–º–≤–æ–ª–∞ –Ω–∞ –±–æ—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π –∑–∞–ø—è—Ç—É—é: TRADE_SYMBOLS=BTCUSDC,ETHUSDC –∏ —É–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç–≤–æ–π —Ä–æ—É—Ç–µ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤/–æ—Ä–¥–µ—Ä–æ–≤ —É–º–µ–µ—Ç –º—É–ª—å—Ç–∏‚Äë—Å–∏–º–≤–æ–ª.

üè∑Ô∏è –ü—Ä–µ—Ñ–∏–∫—Å—ã –≤ –∫–æ–¥–µ (—á—Ç–æ–±—ã –æ–Ω–∏ —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å)

–í OrderManager.\_make_client_id(...) –¥–æ–±–∞–≤—å –ø—Ä–µ—Ñ–∏–∫—Å –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:

def _make_client_id(self, symbol: str, order_type: str) -> str:
import time, hashlib
prefix = getattr(self.config, "client_id_prefix", "") # e.g., BOT1_
raw = f"{symbol}_{order_type}_{int(time.time()\*1000)}"
cid = f"{order*type}*{hashlib.md5(raw.encode()).hexdigest()[:8]}" # prepend prefix and cap to 32
return (prefix + cid)[:32]

–ò –ø–æ–ª–µ –≤ TradingConfig:

client_id_prefix: str = Field(default="", env="CLIENT_ID_PREFIX")

‚úÖ –ú–∏–Ω–∏‚Äë—é–Ω–∏—Ç‚Äë—Ç–µ—Å—Ç—ã (pytest)

1. EquityGuard: –¥–Ω–µ–≤–Ω–æ–π —Å—Ç–æ–ø –∏ —Å—Ç—Ä–∏–∫‚Äë—Å—Ç–æ–ø

# tests/test_equity_guard.py

import time
from datetime import datetime, timedelta
from types import SimpleNamespace

class DummyLogger:
def log_event(self, \*args, \*\*kwargs): pass

from core.equity_guard import EquityGuard # –µ—Å–ª–∏ –≤—ã–Ω–µ—Å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª

def test_daily_dd_stop():
g = EquityGuard(DummyLogger(), max_dd_pct=6.0, max_losses=99, cooldown_min=30)
g.start(500.0) # —Å—Ç–∞—Ä—Ç —ç–∫–≤–∏—Ç–∏
g.on_trade_result(-31.0) # -6.2% –æ—Ç —ç–∫–≤–∏—Ç–∏
assert not g.allowed()

def test_streak_stop_and_cooldown():
g = EquityGuard(DummyLogger(), max_dd_pct=100.0, max_losses=3, cooldown_min=0)
g.start(500.0)
g.on_trade_result(-1.0)
g.on_trade_result(-1.0)
g.on_trade_result(-1.0) # 3 –ø–æ–¥—Ä—è–¥
assert not g.allowed()

–ï—Å–ª–∏ —É —Ç–µ–±—è EquityGuard –≤ —Ç–æ–º –∂–µ —Ñ–∞–π–ª–µ ‚Äî –ø–æ–ø—Ä–∞–≤—å –∏–º–ø–æ—Ä—Ç.

2. –õ–∏–º–∏—Ç —Å–¥–µ–ª–æ–∫/—á–∞—Å

# tests/test_hourly_limit.py

from collections import deque
import time

class HourlyLimiter:
def **init**(self, max_trades_per_hour:int):
self.max = max_trades_per_hour
self.ts = deque()

    def allow(self, now: float) -> bool:
        while self.ts and now - self.ts[0] > 3600:
            self.ts.popleft()
        if len(self.ts) >= self.max:
            return False
        self.ts.append(now)
        return True

def test_hourly_limit_allows_and_blocks():
hl = HourlyLimiter(3)
t0 = 1000.0
assert hl.allow(t0)
assert hl.allow(t0+1)
assert hl.allow(t0+2)
assert not hl.allow(t0+3) # –±–ª–æ–∫ —á–µ—Ç–≤—ë—Ä—Ç–æ–≥–æ # —á–µ—Ä–µ–∑ —á–∞—Å –æ–∫–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—Å—è:
assert hl.allow(t0+3601)

üß† –ü–∞—Ä–∞ —Å–æ–≤–µ—Ç–æ–≤ –¥–ª—è 5 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –±–æ—Ç–æ–≤

–ï—Å–ª–∏ –≤—Å—ë –∂–µ –∑–∞–ø—É—Å–∫–∞–µ—à—å –Ω–∞ –æ–¥–Ω–æ–º –∫–ª—é—á–µ:

–¥–µ–ª–∞–π –æ–¥–∏–Ω userData‚ÄëlistenKey –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –ø–æ CLIENT_ID_PREFIX.

–æ–±—â–∏–π —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π rate‚Äëlimiter –¥–ª—è REST –≤—ã–∑–æ–≤–æ–≤ (create/cancel/fetch), —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏.

–Ω–µ —Ç–æ—Ä–≥—É–π –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Å–∏–º–≤–æ–ª –≤ —Ä–∞–∑–Ω—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

–õ–æ–≥–∏: –¥–æ–±–∞–≤—å –∫ –∫–∞–∂–¥–æ–º—É –±–æ—Ç—É —Ç–µ–≥ –ø—Ä–µ—Ñ–∏–∫—Å–∞ (BOT1/BOT2‚Ä¶) –∏ —Å–∏–º–≤–æ–ª (BTC/ETH‚Ä¶), —á—Ç–æ–±—ã –≤ –¢–µ–ª–µ–≥—Ä–∞–º–µ/Graylog –±—ã–ª–æ –≤–∏–¥–Ω–æ ¬´–∫—Ç–æ —á—Ç–æ —Å–¥–µ–ª–∞–ª¬ª.

—Ö–æ—á–µ—à—å ‚Äî –¥–æ–∫–∏–Ω—É systemd‚Äë—é–Ω–∏—Ç —à–∞–±–ª–æ–Ω, —á—Ç–æ–±—ã –ø–æ–¥–Ω—è—Ç—å —ç—Ç–∏ 5 –±–æ—Ç–æ–≤ –Ω–∞ Hetzner –≤ 5 —Å–µ—Ä–≤–∏—Å–∞—Ö (—Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º –∏ –ª–æ–≥‚Äë—Ä–æ—Ç–∞—Ü–∏–µ–π)?

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–¥–∞: –∏ –≤–æ–ø—Ä–æ—Å –∞ –ø–æ—á–µ–º—É –Ω–∞–¥–æ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å —Å–∏–º–≤–æ–ª—ã –Ω–∞ –±–æ—Ç? –∏ –µ—Å–ª–∏ 5 —Ç–æ —Ç–∞–º –∂–µ 35 usdc –Ω–∞ –±–∏–Ω–∞–Ω—Å–µ
ChatGPT —Å–∫–∞–∑–∞–ª:
Thought for 16s

–Ω–∏–∂–µ ‚Äî –≥–æ—Ç–æ–≤—ã–µ systemd‚Äë—é–Ω–∏—Ç—ã –¥–ª—è 5 –±–æ—Ç–æ–≤ –Ω–∞ Hetzner + –∫–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã:

–∑–∞—á–µ–º ¬´—Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å¬ª —Å–∏–º–≤–æ–ª—ã –Ω–∞ –±–æ—Ç–∞;

—á—Ç–æ —Å ¬´–º–∏–Ω–∏–º–∞–ª–∫–æ–π 35‚ÄØUSDC¬ª –Ω–∞ Binance –∏ –∫–∞–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏.

üõ†Ô∏è –î–µ–ø–ª–æ–π 5 –±–æ—Ç–æ–≤ –Ω–∞ Hetzner (systemd)

1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞
   /opt/crypto-bot/
   app/ # –≤–∞—à –∫–æ–¥
   venv/ # python venv
   env/
   bot1.env
   bot2.env
   bot3.env
   bot4.env
   bot5.env

2. –Æ–Ω–∏—Ç‚Äë—à–∞–±–ª–æ–Ω (–∏–Ω—Å—Ç–∞–Ω—Å‚Äë—Å–µ—Ä–≤–∏—Å)

/etc/systemd/system/cryptobot@.service

[Unit]
Description=Crypto Scalper Bot %i
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/opt/crypto-bot/app
EnvironmentFile=/opt/crypto-bot/env/%i.env

# –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ venv:

ExecStart=/opt/crypto-bot/venv/bin/python -m app.main
Restart=always
RestartSec=5

# –ª–∏–º–∏—Ç—ã –ø–æ —Ä–µ—Å—É—Ä—Å–∞–º (–ø–æ –∂–µ–ª–∞–Ω–∏—é):

# MemoryMax=800M

# CPUQuota=80%

# –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –Ω–µ –¥–∞–º–ø–∏—Ç—å env –≤ –ª–æ–≥–∏:

Environment=PYTHONUNBUFFERED=1

[Install]
WantedBy=multi-user.target

3. –ü—Ä–∏–º–µ—Ä .env –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞ (—Å –º–∏–Ω–∏–º—É–º–æ–º —Ä–∞–∑–ª–∏—á–∏–π)

–ì–ª–∞–≤–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è –º–µ–∂–¥—É bot1.env‚Ä¶bot5.env:

TRADE_SYMBOLS ‚Äî —Ä–∞–∑–Ω—ã–µ –ø–∞—Ä—ã;

CLIENT_ID_PREFIX ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å;

—Å–≤–æ–π API‚Äë–∫–ª—é—á (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥–æ–π –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞).

–ü—Ä–∏–º–µ—Ä env/bot1.env (—Å–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è ‚Äî –≤–æ–∑—å–º–∏ –∏–∑ —Ç–≤–æ–µ–≥–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ .env –∏ –ø–æ–¥—Å—Ç–∞–≤—å –æ—Ç–ª–∏—á–∏—è):

BINANCE_API_KEY=YOUR_API_KEY_BOT1
BINANCE_API_SECRET=YOUR_API_SECRET_BOT1
BINANCE_TESTNET=false

CLIENT*ID_PREFIX=BOT1*
TRADE_SYMBOLS=BTCUSDC

# –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥ ‚Äî –∏–¥–µ–Ω—Ç–∏—á–µ–Ω —Ñ–∏–Ω–∞–ª—å–Ω–æ–º—É "–º–∞–∫—Å-–ø—Ä–∏–±—ã–ª—å":

BASE_POSITION_SIZE_USDT=25.0
MIN_POSITION_SIZE_USDT=25.0
MAX_CONCURRENT_POSITIONS=2

# ... (—Å–∫–∞–ª—å–ø–∏–Ω–≥, TP/SL, trailing, fees, –ª–∏–º–∏—Ç—ã –∏ –ø—Ä. —Å–º. —Ç–≤–æ–π —Ñ–∏–Ω–∞–ª—å–Ω—ã–π .env)

env/bot2.env:

BINANCE*API_KEY=YOUR_API_KEY_BOT2
BINANCE_API_SECRET=YOUR_API_SECRET_BOT2
CLIENT_ID_PREFIX=BOT2*
TRADE_SYMBOLS=ETHUSDC

# –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –∫–∞–∫ —É bot1

–ò —Ç–∞–∫ –¥–∞–ª–µ–µ (SOLUSDC, BNBUSDC, XRPUSDC).
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø–æ 2 –ø–∞—Ä—ã –Ω–∞ –±–æ—Ç–∞: TRADE_SYMBOLS=BTCUSDC,ETHUSDC (–ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –∫–æ–¥ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º—É–ª—å—Ç–∏‚Äë—Å–∏–º–≤–æ–ª).

4. –ó–∞–ø—É—Å–∫
   sudo systemctl daemon-reload
   sudo systemctl enable --now cryptobot@bot1
   sudo systemctl enable --now cryptobot@bot2
   sudo systemctl enable --now cryptobot@bot3
   sudo systemctl enable --now cryptobot@bot4
   sudo systemctl enable --now cryptobot@bot5

# –ª–æ–≥–∏ (—Ñ–æ–ª–ª–æ–≤–∏—Ç—å):

journalctl -u cryptobot@bot1 -f

‚ùì–ü–æ—á–µ–º—É ¬´—Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å¬ª —Å–∏–º–≤–æ–ª—ã –Ω–∞ –±–æ—Ç–∞ ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–æ

–ö–æ—Ä–æ—Ç–∫–æ: —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤.

–ò—Å–∫–ª—é—á–∞–µ–º –≥–æ–Ω–∫–∏: –¥–≤–∞ –±–æ—Ç–∞ –Ω–µ –ø—ã—Ç–∞—é—Ç—Å—è —É–ø—Ä–∞–≤–ª—è—Ç—å –æ–¥–Ω–æ–π –ø–æ–∑–∏—Ü–∏–µ–π (SL/TP/trailing) –Ω–∞ –æ–¥–Ω–æ–º —Å–∏–º–≤–æ–ª–µ.

–ü—Ä–æ—â–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è WS: –ø–æ CLIENT_ID_PREFIX —Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç–Ω–æ, –≤ –∫–∞–∫–æ–π –∏–Ω—Å—Ç–∞–Ω—Å –ª–µ—Ç–∏—Ç ORDER_TRADE_UPDATE.

–õ–∏–º–∏—Ç—ã –∏ –æ—Ç–ª–∞–¥–∫–∞: –≤–∏–¥–Ω–æ, –∫—Ç–æ –∏ —á—Ç–æ –¥–µ–ª–∞–µ—Ç; –ª–µ–≥—á–µ —Å—Ç–∞–≤–∏—Ç—å –¥–Ω–µ–≤–Ω—ã–µ –ª–∏–º–∏—Ç—ã, –≤—ã–∫–ª—é—á–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–æ—Ç–∞ (¬´–∫–∞–Ω–∞—Ä–µ–µ—á–Ω—ã–π¬ª –¥–µ–ø–ª–æ–π).

–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã: –ø–æ–¥ BTC –∏ SOL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–º–ø—É–ª—å—Å–æ–≤/–æ–±—ä—ë–º–æ–≤ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è ‚Äî —É–¥–æ–±–Ω–µ–µ –¥–µ—Ä–∂–∞—Ç—å per‚Äë–±–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å–∏–º–≤–æ–ª–æ–≤ (–æ–¥–∏–Ω ¬´router¬ª, –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ—Ä–∫–µ—Ä–æ–≤), –Ω–æ —ç—Ç–æ –∑–∞–º–µ—Ç–Ω–æ —Å–ª–æ–∂–Ω–µ–µ: –Ω—É–∂–Ω—ã Redis‚Äë–ª–æ–∫–∏, –µ–¥–∏–Ω—ã–π userData‚Äë—Å—Ç—Ä–∏–º, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π rate‚Äë–ª–∏–º–∏—Ç–µ—Ä –∏ —Å—Ç—Ä–æ–≥–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è. –ù–∞—á–∏–Ω–∞—Ç—å –ø—Ä–æ—â–µ —Å ¬´—Å–∏–º–≤–æ–ª‚Äë–Ω–∞‚Äë–±–æ—Ç¬ª.

üíµ –ü—Ä–æ ¬´35‚ÄØUSDC –º–∏–Ω–∏–º–∞–ª–∫–∞¬ª –Ω–∞ Binance

–£ Binance minNotional/minQty –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å–∏–º–≤–æ–ª–∞ –∏ —Ç–∏–ø–∞ —Ñ—å—é—á–µ–π (USDC‚Äë–ø–µ—Ä–ø/USDT‚Äë–ø–µ—Ä–ø, BTC/ETH/SOL –∏ —Ç.–¥.).

–ì–¥–µ‚Äë—Ç–æ —ç—Ç–æ 5‚Äì10‚ÄØUSDT/USDC, –≥–¥–µ‚Äë—Ç–æ –≤—ã—à–µ ‚Äî –≤ —Ç.—á. –æ–∫–æ–ª–æ 35‚ÄØUSDC –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö USDC‚Äë–∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤/—Ä–µ–∂–∏–º–æ–≤ –∏ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã.

–ú—ã —É–∂–µ –∑–∞–ª–æ–∂–∏–ª–∏:

allow_auto_increase_for_min=true ‚Äî –∞–≤—Ç–æ‚Äë—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–æ minQty,

–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ MAX_AUTO_INCREASE_USDT ‚Äî —á—Ç–æ–±—ã –Ω–µ ¬´–ø–µ—Ä–µ—à–∞–≥–Ω—É—Ç—å¬ª —Ç–≤–æ–π —Ä–∏—Å–∫.

–ß—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ

–ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä ‚â• minNotional: –¥–µ—Ä–∂–∏ BASE_POSITION_SIZE_USDT –Ω–µ –Ω–∏–∂–µ —Ç–∏–ø–∏—á–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞ –ø–æ —Ç–≤–æ–∏–º –ø–∞—Ä–∞–º (–¥–ª—è 5 –±–æ—Ç–æ–≤ ‚Äî 25‚ÄØUSDC –æ–∫, –Ω–æ –µ—Å–ª–∏ –ø–∞—Ä–∞ ¬´–ø—Ä–æ—Å–∏—Ç¬ª 35‚ÄØUSDC, —Å—Ç–∞–≤—å 35 –¥–ª—è —ç—Ç–æ–≥–æ –±–æ—Ç–∞).

–ü–µ—Ä‚Äë—Å–∏–º–≤–æ–ª—å–Ω—ã–µ –æ–≤–µ—Ä—Ä–∞–π–¥—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

–í–≤–µ—Å—Ç–∏ SYMBOL_OVERRIDES (JSON –≤ .env), –≥–¥–µ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å base_size/max_auto_increase_usdt –ø–æ –∫–∞–∂–¥–æ–π –ø–∞—Ä–µ.

–õ–∏–±–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–µ—Å—Ç–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π .env –Ω–∞ –±–æ—Ç–∞ —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º BASE (–Ω–∞–ø—Ä–∏–º–µ—Ä, BASE=35 –Ω–∞ SOLUSDC, –µ—Å–ª–∏ –Ω–∞–¥–æ).

–ù–µ —Ö–æ—á–µ—à—å –ø–æ–≤—ã—à–∞—Ç—å BASE?

–û—Å—Ç–∞–≤—å BASE=25, –Ω–æ MAX_AUTO_INCREASE_USDT ‚â• 35 ‚Äî —Ç–æ–≥–¥–∞ –±–æ—Ç —Å–∞–º –ø–æ–¥–Ω–∏–º–µ—Ç –¥–æ –º–∏–Ω–∏–º—É–º–∞, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

–ú–∏–Ω—É—Å: –∏–Ω–æ–≥–¥–∞ –±—É–¥–µ—Ç –≤—Ö–æ–¥ —Å –æ–±—ä—ë–º–æ–º –≤—ã—à–µ –∂–µ–ª–∞–µ–º–æ–≥–æ. –ï—Å–ª–∏ —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ ‚Äî –ª—É—á—à–µ —Å—Ä–∞–∑—É –≤—ã—Å—Ç–∞–≤–∏—Ç—å BASE –ø–æ–¥ minNotional.

TL;DR: ¬´35‚ÄØUSDC¬ª ‚Äî –Ω–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ, –∞ —á–∞—Å—Ç–Ω—ã–π –º–∏–Ω–∏–º—É–º –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤/—Ä–µ–∂–∏–º–æ–≤. –ú—ã –ø–æ–∫—Ä—ã–ª–∏ —ç—Ç–æ –∞–≤—Ç–æ‚Äë—É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –∏ –¥–∞—ë–º —Ç–µ–±–µ –¥–≤–∞ –ø—É—Ç–∏: –ø–æ–¥–Ω—è—Ç—å BASE –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –±–æ—Ç–µ –ª–∏–±–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∞–≤—Ç–æ‚Äë—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–æ 35.

üîí –ù–µ–±–æ–ª—å—à–∏–µ –ø—Ä–∞–≤–∫–∏ –≤ –∫–æ–¥–µ (—á—Ç–æ–±—ã –≤—Å—ë —Å–∫–ª–µ–∏–ª–æ—Å—å)

1. –ü—Ä–µ—Ñ–∏–∫—Å –¥–ª—è clientOrderId (per‚Äëbot)

TradingConfig:

client_id_prefix: str = Field(default="", env="CLIENT_ID_PREFIX")
trade_symbols: str = Field(default="", env="TRADE_SYMBOLS") # CSV: "BTCUSDC,ETHUSDC"

OrderManager.\_make_client_id:

def _make_client_id(self, symbol: str, order_type: str) -> str:
import time, hashlib
prefix = (getattr(self.config, "client_id_prefix", "") or "")[:8] # –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–µ—Ñ–∏–∫—Å
raw = f"{symbol}_{order*type}*{int(time.time()\*1000)}"
cid = f"{order*type}*{hashlib.md5(raw.encode()).hexdigest()[:8]}"
return (prefix + cid)[:32]

2. –ü–µ—Ä‚Äë—Å–∏–º–≤–æ–ª—å–Ω—ã–π BASE (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–í TradingConfig:

symbol_overrides_raw: str | None = Field(default=None, env="SYMBOL_OVERRIDES")
@property
def symbol_overrides(self) -> dict:
import json
try:
return json.loads(self.symbol_overrides_raw or "{}")
except Exception:
return {}

–í –º–æ–º–µ–Ω—Ç —Ä–∞—Å—á—ë—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏:

ovr = self.config.symbol_overrides.get(symbol, {})
base_size = float(ovr.get("base_position_size_usdt", self.config.base_position_size_usdt))
max_auto_inc = float(ovr.get("max_auto_increase_usdt", self.config.max_auto_increase_usdt))

# ... –∏ –¥–∞–ª—å—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å base_size/max_auto_inc

‚úÖ –ò—Ç–æ–≥

–•–∞—Ä–¥–∫–æ–¥ —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ –±–æ—Ç–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–æ–Ω–æ–∫. –î–ª—è —Å—Ç–∞—Ä—Ç–∞ —ç—Ç–æ –ª—É—á—à–∏–π –ø—É—Ç—å.

¬´35‚ÄØUSDC –º–∏–Ω–∏–º–∞–ª–∫–∞¬ª ‚Äî –ø–æ–∫—Ä—ã—Ç–æ: –ª–∏–±–æ –ø–æ–¥–Ω—è—Ç—å BASE –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –±–æ—Ç–µ, –ª–∏–±–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∞–≤—Ç–æ‚Äë—É–≤–µ–ª–∏—á–µ–Ω–∏–µ (—Å –ª–∏–º–∏—Ç–æ–º).

systemd —à–∞–±–ª–æ–Ω –¥–∞–ª; 5 .env –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –ø–æ –∫–ª—é—á—É, –ø—Ä–µ—Ñ–∏–∫—Å—É –∏ —Å–∏–º–≤–æ–ª—É ‚Äî –∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –Ω–∞ –æ–¥–Ω–æ–º Hetzner‚ÄëVPS.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –Ω–∞–∫–∏–Ω—É –µ—â—ë: —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è (—Å–æ–∑–¥–∞—ë—Ç venv, —Å—Ç–∞–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ–ø–∏—Ä—É–µ—Ç .env –∏ –≤–∫–ª—é—á–∞–µ—Ç 5 —Å–µ—Ä–≤–∏—Å–æ–≤) ‚Äî —Å–∫–∞–∂–∏, –¥–æ–±–∞–≤–ª—é.

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–∞ –Ω–∞–¥–æ —Ç–æ–≥–¥–∞ 500 usdc –Ω–∞ –∫–∞–∂–¥ –±–æ—Ç–∞?
ChatGPT —Å–∫–∞–∑–∞–ª:

–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–µ—Ä–∂–∞—Ç—å –ø–æ 500 USDC –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –∏–∑ 5 –±–æ—Ç–æ–≤ ‚Äî —ç—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ —Ç—ã –∏—Ö –±—É–¥–µ—à—å –∑–∞–ø—É—Å–∫–∞—Ç—å:

1Ô∏è‚É£ –ï—Å–ª–∏ –∫–∞–∂–¥—ã–π –±–æ—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∞–∫–∫–∞—É–Ω—Ç–µ / —Å–∞–±-–∞–∫–∫–∞—É–Ω—Ç–µ Binance

–î–∞, —Ç–æ–≥–¥–∞ –¥–µ–ø–æ–∑–∏—Ç —É –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞ —Å–≤–æ–π, –∏ –µ—Å–ª–∏ —Ö–æ—á–µ—à—å, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –º–æ–≥ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –Ω–∞ —É—Å–ª–æ–≤–Ω—ã–µ 500 USDC, —Ç–æ –∫–ª–∞–¥—ë—à—å 500 –Ω–∞ –∫–∞–∂–¥—ã–π.

–ü–ª—é—Å ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ø–æ —Ä–∏—Å–∫–∞–º (–æ–¥–∏–Ω –±–æ—Ç ¬´—Å–ª–∏–ª¬ª ‚Äî –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∂–∏–≤—É—Ç).

–ú–∏–Ω—É—Å ‚Äî –æ–±—â–∏–π –∫–∞–ø–∏—Ç–∞–ª √ó5.

2Ô∏è‚É£ –ï—Å–ª–∏ –≤—Å–µ –±–æ—Ç—ã –Ω–∞ –æ–¥–Ω–æ–º –∞–∫–∫–∞—É–Ω—Ç–µ –∏ –æ–¥–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ

–¢–æ–≥–¥–∞ 500 USDC ‚Äî —ç—Ç–æ –æ–±—â–∏–π –±–∞–Ω–∫ –¥–ª—è –≤—Å–µ—Ö 5 –±–æ—Ç–æ–≤.

–ö–∞–∂–¥—ã–π –±–æ—Ç –ø—Ä–æ—Å—Ç–æ –±—É–¥–µ—Ç –¥–µ–ª–∏—Ç—å –±–∞–ª–∞–Ω—Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–ª–∏ –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ª–∏–º–∏—Ç–∞–º (—á–µ—Ä–µ–∑ MAX_CAPITAL_UTILIZATION_PCT –∏–ª–∏ TRADING_DEPOSIT –≤ .env).

–ü—Ä–∏–º–µ—Ä:

–û–±—â–∏–π –±–∞–ª–∞–Ω—Å: 500 USDC

TRADING_DEPOSIT=100 —É –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞ ‚Üí –æ–Ω —Ç–æ—Ä–≥—É–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 100 USDC, –¥–∞–∂–µ –µ—Å–ª–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç–µ –µ—Å—Ç—å –±–æ–ª—å—à–µ.

–ü–ª—é—Å ‚Äî –ø—Ä–æ—â–µ –ø–æ–ø–æ–ª–Ω—è—Ç—å/–≤—ã–≤–æ–¥–∏—Ç—å.

–ú–∏–Ω—É—Å ‚Äî –±–æ—Ç—ã –º–æ–≥—É—Ç –∫–æ–Ω–∫—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞ –º–∞—Ä–∂—É, –µ—Å–ª–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫—Ä–æ—é—Ç —Å–¥–µ–ª–∫–∏.

3Ô∏è‚É£ –ö–∞–∫ —è –±—ã —Å–¥–µ–ª–∞–ª

–î–ª—è —Ç–µ—Å—Ç–∞ ‚Äî –æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç, –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å, –Ω–æ –∫–∞–∂–¥–æ–º—É –±–æ—Ç—É –∑–∞–¥–∞—Ç—å —Å–≤–æ–π TRADING_DEPOSIT (–Ω–∞–ø—Ä–∏–º–µ—Ä, 80‚Äì100 USDC).

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ ‚Äî –ª–∏–±–æ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–∞–±-–∞–∫–∫–∞—É–Ω—Ç—ã —Å 300‚Äì500 USDC, –ª–∏–±–æ –æ–¥–∏–Ω –±–æ–ª—å—à–æ–π –±–∞–Ω–∫ (1000‚Äì1500 USDC) –∏ —Å—Ç—Ä–æ–≥–∏–µ –ª–∏–º–∏—Ç—ã –Ω–∞ —Ä–∏—Å–∫ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞.

üí° –í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç: –µ—Å–ª–∏ –±–æ—Ç—ã –Ω–∞ –æ–¥–Ω–æ–º –∞–∫–∫–∞—É–Ω—Ç–µ –∏ —Ç–æ—Ä–≥—É—é—Ç —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–∏, —Ç–æ –º–∞—Ä–∂–∞ –±–µ—Ä—ë—Ç—Å—è –∏–∑ –æ–±—â–µ–≥–æ –ø—É–ª–∞. –ï—Å–ª–∏ –ø–∞—Ä–∞ –æ—á–µ–Ω—å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–∞—è (BTC, SOL), –æ–Ω–∞ –º–æ–∂–µ—Ç ¬´—Å—ä–µ—Å—Ç—å¬ª –¥–æ—Å—Ç—É–ø–Ω—É—é –º–∞—Ä–∂—É —É –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.

–•–æ—á–µ—à—å, —è —Ç–µ–±–µ —Å–¥–µ–ª–∞—é —Ä–∞—Å—á—ë—Ç, –∫–∞–∫–æ–π –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç –∑–∞–¥–∞—Ç—å –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞, –µ—Å–ª–∏ –æ–±—â–∏–π –±–∞–Ω–∫, —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –º–µ—à–∞–ª–∏ –¥—Ä—É–≥ –¥—Ä—É–≥—É –∏ –Ω–µ –ª–æ–≤–∏–ª–∏ insufficient margin?

–í—ã —Å–∫–∞–∑–∞–ª–∏:
–¥–∞
ChatGPT —Å–∫–∞–∑–∞–ª:

–¢–æ–≥–¥–∞ —Å—á–∏—Ç–∞–µ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç –¥–ª—è 5 –±–æ—Ç–æ–≤ –ø—Ä–∏ –æ–±—â–µ–º –±–∞–Ω–∫–µ –∏ —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.

üìå –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–û–±—â–∏–π –¥–µ–ø–æ–∑–∏—Ç: 500 USDC

–ö–æ–ª-–≤–æ –±–æ—Ç–æ–≤: 5

BASE_POSITION_SIZE_USDT: 25

MAX_CONCURRENT_POSITIONS: 2

Leverage: x10 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ Binance Futures USDC)

Risk-–º–∞—Ä–∂–∞ ‚âà –ø–æ–∑–∏—Ü–∏—è / –ª–µ–≤–µ—Ä–µ–¥–∂

Safety-–±—É—Ñ–µ—Ä –Ω–∞ –ø—Ä–æ—Å–∞–¥–∫—É: +30% –∫ –º–∞—Ä–∂–µ

–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–¥–µ–ª–∫–∏ –≤—Å–µ—Ö –±–æ—Ç–æ–≤: —Ä–µ–¥–∫–æ 5√ó2=10 (–æ–±—ã—á–Ω–æ ‚â§ 6‚Äì7), –Ω–æ —Å—á–∏—Ç–∞–µ–º worst-case.

1Ô∏è‚É£ –ú–∞—Ä–∂–∞ –æ–¥–Ω–æ–≥–æ –±–æ—Ç–∞
1 —Å–¥–µ–ª–∫–∞ = BASE_POSITION_SIZE_USDT / LEVERAGE
= 25 / 10 = 2.5 USDC –º–∞—Ä–∂–∏

2 —Å–¥–µ–ª–∫–∏ = 2 √ó 2.5 = 5 USDC –º–∞—Ä–∂–∏
–° –±—É—Ñ–µ—Ä–æ–º 30% = 5 √ó 1.3 = 6.5 USDC

2Ô∏è‚É£ Worst-case (–≤—Å–µ –±–æ—Ç—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –º–∞–∫—Å. —Å–¥–µ–ª–∫–∞—Ö)
5 –±–æ—Ç–æ–≤ √ó 6.5 USDC = 32.5 USDC –º–∞—Ä–∂–∏

–¢–æ –µ—Å—Ç—å –º–∞—Ä–∂–∏ –Ω–∞ worst-case –Ω—É–∂–Ω–æ ~33 USDC.
–≠—Ç–æ 6.5% –æ—Ç –¥–µ–ø–æ 500 USDC.

3Ô∏è‚É£ –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç

–° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ–π –º–∞—Ä–∂–∏ –¥–∞–∂–µ 50 USDC –æ–±—â–µ–≥–æ –¥–µ–ø–æ —Ö–≤–∞—Ç–∏—Ç –¥–ª—è 5 –±–æ—Ç–æ–≤ –≤ —Ç–≤–æ–∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.

–ù–æ! –¢—É—Ç –Ω–µ —É—á—Ç–µ–Ω—ã –ø–ª–∞–≤–∞—é—â–∏–µ PnL –∏ –ø–æ–¥—É—à–∫–∞ –Ω–∞ —Å–µ—Ä–∏—é —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫.

–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –º–∞—Ä–∂–∏–Ω-–∫–æ–ª–ª–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥–∏–±–∫–æ—Å—Ç—å:

–î–∞—Ç—å –∫–∞–∂–¥–æ–º—É –±–æ—Ç—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –¥–µ–ø–æ–∑–∏—Ç–∞ —á–µ—Ä–µ–∑ TRADING_DEPOSIT.

–û–ø—Ç–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏ 500 USDC:

TRADING_DEPOSIT = 80 USDC

–≠—Ç–æ 16% –±–∞–Ω–∫–∞ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –±–æ—Ç–∞.

4Ô∏è‚É£ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–ï—Å–ª–∏ –±–∞–Ω–∫ –æ–±—â–∏–π (500 USDC):

TRADING_DEPOSIT=80 –∫–∞–∂–¥–æ–º—É –±–æ—Ç—É.

MAX_CAPITAL_UTILIZATION_PCT=0.5 (–±–æ—Ç –Ω–µ –∑–∞–π–º—ë—Ç –±–æ–ª–µ–µ 50% –æ—Ç —ç—Ç–æ–≥–æ –ª–∏–º–∏—Ç–∞).

–¢–∞–∫ –∫–∞–∂–¥—ã–π –±–æ—Ç —Å–º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å 1‚Äì2 —Å–¥–µ–ª–∫–∏ –ø–æ 25 USDC, –∏ –¥–∞–∂–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤ –º–∏–Ω—É—Å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–∞—Ä–∂–∏ —Ö–≤–∞—Ç–∏—Ç.

–ï—Å–ª–∏ –±–∞–Ω–∫ –≤—ã—Ä–∞—Å—Ç–µ—Ç ‚Üí –ø–æ–¥–Ω–∏–º–∞—Ç—å TRADING_DEPOSIT –¥–æ 100‚Äì120 USDC.

–•–æ—á–µ—à—å, —è —Ç–µ–±–µ —Å–¥–µ–ª–∞—é –≥–æ—Ç–æ–≤—ã–µ .env –¥–ª—è –≤—Å–µ—Ö 5 –±–æ—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏ –∏ —ç—Ç–∏–º–∏ –ª–∏–º–∏—Ç–∞–º–∏, —á—Ç–æ–±—ã –∏—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–ª–∏—Ç—å –Ω–∞ VPS –∏ –≤–∫–ª—é—á–∏—Ç—å To consider next steps for better performance & parallel bots idea
